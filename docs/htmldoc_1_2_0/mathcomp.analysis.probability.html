
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Module mathcomp.analysis.probability</title>
<meta name="description" content="Documentation of Coq module mathcomp.analysis.probability" />
<link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex/dist/katex.min.css">
<script src="https://cdn.jsdelivr.net/npm/markdown-it/dist/markdown-it.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/katex/dist/katex.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/markdown-it-texmath/texmath.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/darkmode-js@1.5.7/lib/darkmode-js.min.js"></script>
<link href="coq2html.css" rel="stylesheet" type="text/css" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script type="text/javascript" src="coq2html.js"> </script>
</head>

<body onload="init('proofscript')">

  <main>
    <div class="sidebar">
      <h2>Files</h2>
      <li><details id="mathcomp"><summary>mathcomp</summary>
          <ul>
          <li><details id="mathcomp.analysis"><summary>analysis</summary>
          <ul>
          <li><a href="mathcomp.analysis.all_analysis.html">all_analysis</a></li>
<li><a href="mathcomp.analysis.cantor.html">cantor</a></li>
<li><a href="mathcomp.analysis.charge.html">charge</a></li>
<li><a href="mathcomp.analysis.constructive_ereal.html">constructive_ereal</a></li>
<li><a href="mathcomp.analysis.convex.html">convex</a></li>
<li><a href="mathcomp.analysis.derive.html">derive</a></li>
<li><a href="mathcomp.analysis.ereal.html">ereal</a></li>
<li><a href="mathcomp.analysis.esum.html">esum</a></li>
<li><a href="mathcomp.analysis.exp.html">exp</a></li>
<li><a href="mathcomp.analysis.forms.html">forms</a></li>
<li><a href="mathcomp.analysis.ftc.html">ftc</a></li>
<li><a href="mathcomp.analysis.function_spaces.html">function_spaces</a></li>
<li><a href="mathcomp.analysis.hoelder.html">hoelder</a></li>
<li><a href="mathcomp.analysis.itv.html">itv</a></li>
<li><a href="mathcomp.analysis.kernel.html">kernel</a></li>
<li><a href="mathcomp.analysis.landau.html">landau</a></li>
<li><a href="mathcomp.analysis.lebesgue_integral.html">lebesgue_integral</a></li>
<li><a href="mathcomp.analysis.lebesgue_measure.html">lebesgue_measure</a></li>
<li><a href="mathcomp.analysis.lebesgue_stieltjes_measure.html">lebesgue_stieltjes_measure</a></li>
<li><a href="mathcomp.analysis.measure.html">measure</a></li>
<li><a href="mathcomp.analysis.normedtype.html">normedtype</a></li>
<li><a href="mathcomp.analysis.nsatz_realtype.html">nsatz_realtype</a></li>
<li><a href="mathcomp.analysis.numfun.html">numfun</a></li>
<li><a href="mathcomp.analysis.probability.html">probability</a></li>
<li><a href="mathcomp.analysis.prodnormedzmodule.html">prodnormedzmodule</a></li>
<li><a href="mathcomp.analysis.real_interval.html">real_interval</a></li>
<li><a href="mathcomp.analysis.realfun.html">realfun</a></li>
<li><a href="mathcomp.analysis.reals.html">reals</a></li>
<li><a href="mathcomp.analysis.Rstruct.html">Rstruct</a></li>
<li><a href="mathcomp.analysis.sequences.html">sequences</a></li>
<li><a href="mathcomp.analysis.signed.html">signed</a></li>
<li><a href="mathcomp.analysis.summability.html">summability</a></li>
<li><a href="mathcomp.analysis.topology.html">topology</a></li>
<li><a href="mathcomp.analysis.trigo.html">trigo</a></li>
          </ul>
          </details>
          </li>
<li><details id="mathcomp.classical"><summary>classical</summary>
          <ul>
          <li><a href="mathcomp.classical.all_classical.html">all_classical</a></li>
<li><a href="mathcomp.classical.boolp.html">boolp</a></li>
<li><a href="mathcomp.classical.cardinality.html">cardinality</a></li>
<li><a href="mathcomp.classical.classical_sets.html">classical_sets</a></li>
<li><a href="mathcomp.classical.contra.html">contra</a></li>
<li><a href="mathcomp.classical.fsbigop.html">fsbigop</a></li>
<li><a href="mathcomp.classical.functions.html">functions</a></li>
<li><a href="mathcomp.classical.mathcomp_extra.html">mathcomp_extra</a></li>
<li><a href="mathcomp.classical.set_interval.html">set_interval</a></li>
          </ul>
          </details>
          </li>
          </ul>
          </details>
          </li>
    </div>

  <div class="coq">

    <div class="content">
      <p><a href="./index.html">Top</a></p>
      <h1 class="title">Module mathcomp.analysis.probability</h1>
<span class="vernacular">From</span> <span class="id">mathcomp</span> <span class="vernacular">Require</span> <span class="vernacular">Import</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.all_ssreflect.html">all_ssreflect</a></span>.<br/>
<span class="vernacular">From</span> <span class="id">mathcomp</span> <span class="vernacular">Require</span> <span class="vernacular">Import</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html">ssralg</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.poly.html">poly</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssrnum.html">ssrnum</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssrint.html">ssrint</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.interval.html">interval</a></span> <span class="id"><a href="NOTFOUND the module url for mathcomp.finmap.finmap">finmap</a></span>.<br/>
<span class="vernacular">From</span> <span class="id">mathcomp</span> <span class="vernacular">Require</span> <span class="vernacular">Import</span> <span class="id"><a href="mathcomp.classical.mathcomp_extra.html">mathcomp_extra</a></span> <span class="id"><a href="mathcomp.classical.boolp.html">boolp</a></span> <span class="id"><a href="mathcomp.classical.classical_sets.html">classical_sets</a></span> <span class="id"><a href="mathcomp.classical.functions.html">functions</a></span>.<br/>
<span class="vernacular">From</span> <span class="id">mathcomp</span> <span class="vernacular">Require</span> <span class="vernacular">Import</span> <span class="id"><a href="mathcomp.classical.cardinality.html">cardinality</a></span> <span class="id"><a href="mathcomp.classical.fsbigop.html">fsbigop</a></span>.<br/>
<span class="vernacular">From</span> <span class="id">HB</span> <span class="vernacular">Require</span> <span class="vernacular">Import</span> <span class="id"><a href="NOTFOUND the module url for HB.structures">structures</a></span>.<br/>
<span class="vernacular">Require</span> <span class="vernacular">Import</span> <span class="id"><a href="mathcomp.analysis.exp.html">exp</a></span> <span class="id"><a href="mathcomp.analysis.numfun.html">numfun</a></span> <span class="id"><a href="mathcomp.analysis.lebesgue_measure.html">lebesgue_measure</a></span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html">lebesgue_integral</a></span>.<br/>
<span class="vernacular">Require</span> <span class="vernacular">Import</span> <span class="id"><a href="mathcomp.analysis.reals.html">reals</a></span> <span class="id"><a href="mathcomp.analysis.ereal.html">ereal</a></span> <span class="id"><a href="mathcomp.analysis.signed.html">signed</a></span> <span class="id"><a href="mathcomp.analysis.topology.html">topology</a></span> <span class="id"><a href="mathcomp.analysis.normedtype.html">normedtype</a></span> <span class="id"><a href="mathcomp.analysis.sequences.html">sequences</a></span> <span class="id"><a href="mathcomp.analysis.esum.html">esum</a></span> <span class="id"><a href="mathcomp.analysis.measure.html">measure</a></span>.<br/>
<span class="vernacular">Require</span> <span class="vernacular">Import</span> <span class="id"><a href="mathcomp.analysis.exp.html">exp</a></span> <span class="id"><a href="mathcomp.analysis.numfun.html">numfun</a></span> <span class="id"><a href="mathcomp.analysis.lebesgue_measure.html">lebesgue_measure</a></span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html">lebesgue_integral</a></span> <span class="id"><a href="mathcomp.analysis.kernel.html">kernel</a></span>.<br/>
<br/>
<div class="ssrdoc md">
# Probability                                                               
                                                                            
This file provides basic notions of probability theory. See measure.v for   
the type probability T R (a measure that sums to 1).                        
                                                                            
```                                                                         
        {RV P &gt;-&gt; R} == real random variable: a measurable function from    
                        the measurableType of the probability P to R        
    distribution P X == measure image of the probability measure P by the   
                        random variable X : {RV P -&gt; R}                     
                        P as type probability T R with T of type            
                        measurableType.                                     
                        Declared as an instance of probability measure.     
             'E_P[X] == expectation of the real measurable function X       
      covariance X Y == covariance between real random variable X and Y     
             'V_P[X] == variance of the real random variable X              
       mmt_gen_fun X == moment generating function of the random variable   
                        X                                                   
     {dmfun T &gt;-&gt; R} == type of discrete real-valued measurable functions   
       {dRV P &gt;-&gt; R} == real-valued discrete random variable                
           dRV_dom X == domain of the discrete random variable X            
          dRV_enum X == bijection between the domain and the range of X     
            pmf X r := fine (P (X @^-1` [set r]))                           
       enum_prob X k == probability of the kth value in the range of X      
```                                                                         
                                                                            
```                                                                         
     bernoulli_pmf p == Bernoulli pmf                                       
         bernoulli p == Bernoulli probability measure when 0 &lt;= p &lt;= 1      
                        and \d_false otherwise                              
    binomial_pmf n p == binomial pmf                                        
   binomial_prob n p == binomial probability measure when 0 &lt;= p &lt;= 1       
                        and \d_0%N otherwise                                
      bin_prob n k p == $\binom{n}{k}p^k (1-p)^(n-k)$                       
                        Computes a binomial distribution term for           
                        k successes in n trials with success rate p         
     uniform_pdf a b == uniform pdf                                         
 uniform_prob a b ab == uniform probability over the interval [a,b]         
                        with ab0 a proof that 0 &lt; b - a                     
```                                                                         
                                                                            
</div>
<br/>
<span class="vernacular">Reserved</span> <span class="vernacular">Notation</span> <span class="id">&quot;'{' 'RV' P &gt;-&gt; R '}'&quot;</span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">at</span> <span class="id">level</span> <span class="id">0,</span> <span class="id">format</span> <span class="id">&quot;'{' 'RV'  P  '&gt;-&gt;'  R '}'&quot;</span>).<br/>
<span class="vernacular">Reserved</span> <span class="vernacular">Notation</span> <span class="id">&quot;''E_' P [ X ]&quot; (format &quot;''E_' P [ X ]&quot;</span><span class="id">,</span> <span class="gallina-kwd">at</span> <span class="id">level</span> <span class="id">5</span>).<br/>
<span class="vernacular">Reserved</span> <span class="vernacular">Notation</span> <span class="id">&quot;''V_' P [ X ]&quot; (format &quot;''V_' P [ X ]&quot;</span><span class="id">,</span> <span class="gallina-kwd">at</span> <span class="id">level</span> <span class="id">5</span>).<br/>
<span class="vernacular">Reserved</span> <span class="vernacular">Notation</span> <span class="id">&quot;{ 'dmfun' aT &gt;-&gt; T }&quot;</span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">at</span> <span class="id">level</span> <span class="id">0,</span> <span class="id">format</span> <span class="id">&quot;{ 'dmfun'  aT  &gt;-&gt;  T }&quot;</span>).<br/>
<span class="vernacular">Reserved</span> <span class="vernacular">Notation</span> <span class="id">&quot;'{' 'dRV' P &gt;-&gt; R '}'&quot;</span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">at</span> <span class="id">level</span> <span class="id">0,</span> <span class="id">format</span> <span class="id">&quot;'{' 'dRV'  P  '&gt;-&gt;'  R '}'&quot;</span>).<br/>
<br/>
<span class="gallina-kwd">Set</span> <span class="vernacular">Implicit</span> <span class="vernacular">Arguments</span>.<br/>
<span class="vernacular">Unset</span> <span class="vernacular">Strict</span> <span class="vernacular">Implicit</span>.<br/>
<span class="vernacular">Unset</span> <span class="vernacular">Printing</span> <span class="vernacular">Implicit</span> <span class="vernacular">Defensive</span>.<br/>
<br/>
<span class="vernacular">Import</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.order.html#Order.TTheory">Order.TTheory</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#GRing.Theory">GRing.Theory</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssrnum.html#Num.Def">Num.Def</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssrnum.html#Num.Theory">Num.Theory</a></span>.<br/>
<span class="vernacular">Import</span> <span class="id"><a href="mathcomp.analysis.topology.html#numFieldTopology.Exports">numFieldTopology.Exports</a></span>.<br/>
<br/>
<span class="vernacular">Local</span> <span class="vernacular">Open</span> <span class="vernacular">Scope</span> <span class="id">classical_set_scope</span>.<br/>
<span class="vernacular">Local</span> <span class="vernacular">Open</span> <span class="vernacular">Scope</span> <span class="id">ring_scope</span>.<br/>
<br/>
<span class="vernacular">Definition</span> <span id="random_variable" class="id"><a name="random_variable" class="">random_variable</a></span> (<span id="d:1" class="id"><a name="d:1" class="">d</a></span> <span class="id">:</span> <span class="id">_</span>) (<span id="T:2" class="id"><a name="T:2" class="">T</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.measure.html#Measurable.Exports.measurableType">measurableType</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#d:1">d</a></span>) (<span id="R:3" class="id"><a name="R:3" class="">R</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.reals.html#Real.Exports.realType">realType</a></span>)<br/>
&nbsp;&nbsp;(<span id="P:4" class="id"><a name="P:4" class="">P</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.measure.html#Probability.Exports.probability">probability</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#T:2">T</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#R:3">R</a></span>) <span class="id">:=</span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#cfa8195a18578360e4ad0a1e4cde6878">{mfun</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#T:2">T</a></span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#cfa8195a18578360e4ad0a1e4cde6878">&gt;-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#R:3">R}</a></span>.<br/>
<br/>
<span class="vernacular">Notation</span> <span id="31c5002a151d32a5908113f99aedfaa1" class="id"><a name="31c5002a151d32a5908113f99aedfaa1" class="">&quot;{ 'RV' P &gt;-&gt; R }&quot;</a></span> <span class="id">:=</span> (@<span class="id"><a href="mathcomp.analysis.probability.html#random_variable">random_variable</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">R</span> <span class="id">P</span>) <span class="id">:</span> <span class="id">form_scope</span>.<br/>
<br/>
<span class="vernacular">Lemma</span> <span id="notin_range_measure" class="id"><a name="notin_range_measure" class="">notin_range_measure</a></span> <span id="d:5" class="id"><a name="d:5" class="">d</a></span> (<span id="T:6" class="id"><a name="T:6" class="">T</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.measure.html#Measurable.Exports.measurableType">measurableType</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#d:5">d</a></span>) (<span id="R:7" class="id"><a name="R:7" class="">R</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.reals.html#Real.Exports.realType">realType</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span id="P:8" class="id"><a name="P:8" class="">P</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.measure.html#cab9a9776ae9e3a4c36de416efb30851">{measure</a></span> <span class="id">set</span> <span class="id"><a href="mathcomp.analysis.probability.html#T:6">T</a></span> <span class="id"><a href="mathcomp.analysis.measure.html#cab9a9776ae9e3a4c36de416efb30851">-&gt;</a></span> <span class="id">\bar</span> <span class="id"><a href="mathcomp.analysis.probability.html#R:7">R}</a></span>) (<span id="X:9" class="id"><a name="X:9" class="">X</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#T:6">T</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#R:7">R</a></span>) <span id="r:10" class="id"><a name="r:10" class="">r</a></span> <span class="id">:</span><br/>
&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#r:10">r</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#c1ad6bcc76a6221225111f87bc3b0c3d">\notin</a></span> <span class="id"><a href="mathcomp.classical.classical_sets.html#range">range</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:9">X</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#P:8">P</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#X:9">X</a></span> @<span class="id">^-1`</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#29c78c22490f2dae838b1b504eb858a2">[set</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#r:10">r]</a></span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id">0</span>%<span class="id">E</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof1')">Proof.</span></div>
<div class="proofscript" id="proof1">
 <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#notin_setE">notin_setE</a></span> <span class="id">=&gt;</span> <span class="id">hr;</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#preimage10">preimage10</a></span>. Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="probability_range" class="id"><a name="probability_range" class="">probability_range</a></span> <span id="d:11" class="id"><a name="d:11" class="">d</a></span> (<span id="T:12" class="id"><a name="T:12" class="">T</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.measure.html#Measurable.Exports.measurableType">measurableType</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#d:11">d</a></span>) (<span id="R:13" class="id"><a name="R:13" class="">R</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.reals.html#Real.Exports.realType">realType</a></span>)<br/>
&nbsp;&nbsp;(<span id="P:14" class="id"><a name="P:14" class="">P</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.measure.html#Probability.Exports.probability">probability</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#T:12">T</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#R:13">R</a></span>) (<span id="X:15" class="id"><a name="X:15" class="">X</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#31c5002a151d32a5908113f99aedfaa1">{RV</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#P:14">P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#31c5002a151d32a5908113f99aedfaa1">&gt;-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#R:13">R}</a></span>) <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#P:14">P</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#X:15">X</a></span> @<span class="id">^-1`</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#range">range</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:15">X</a></span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id">1</span>%<span class="id">E</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof2')">Proof.</span></div>
<div class="proofscript" id="proof2">
 <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#preimage_range">preimage_range</a></span> <span class="id"><a href="mathcomp.analysis.measure.html#probability_setT">probability_setT</a></span>. Qed.</div>
<br/>
<span class="vernacular">Definition</span> <span id="distribution" class="id"><a name="distribution" class="">distribution</a></span> <span id="d:16" class="id"><a name="d:16" class="">d</a></span> (<span id="T:17" class="id"><a name="T:17" class="">T</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.measure.html#Measurable.Exports.measurableType">measurableType</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#d:16">d</a></span>) (<span id="R:18" class="id"><a name="R:18" class="">R</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.reals.html#Real.Exports.realType">realType</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span id="P:19" class="id"><a name="P:19" class="">P</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.measure.html#Probability.Exports.probability">probability</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#T:17">T</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#R:18">R</a></span>) (<span id="X:20" class="id"><a name="X:20" class="">X</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#cfa8195a18578360e4ad0a1e4cde6878">{mfun</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#T:17">T</a></span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#cfa8195a18578360e4ad0a1e4cde6878">&gt;-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#R:18">R}</a></span>) <span class="id">:=</span><br/>
&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.measure.html#pushforward">pushforward</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#P:19">P</a></span> (@<span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#measurable_funP">measurable_funP</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id"><a href="mathcomp.analysis.probability.html#X:20">X</a></span>).<br/>
<br/>
<span class="vernacular">Section</span> <span id="distribution_is_probability" class="id"><a name="distribution_is_probability" class="">distribution_is_probability</a></span>.<br/>
<span class="vernacular">Context</span> <span id="d:21" class="id"><a name="d:21" class="">d</a></span> (<span id="T:22" class="id"><a name="T:22" class="">T</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.measure.html#Measurable.Exports.measurableType">measurableType</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#d:21">d</a></span>) (<span id="R:23" class="id"><a name="R:23" class="">R</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.reals.html#Real.Exports.realType">realType</a></span>) (<span id="P:24" class="id"><a name="P:24" class="">P</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.measure.html#Probability.Exports.probability">probability</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#T:22">T</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#R:23">R</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span id="X:25" class="id"><a name="X:25" class="">X</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#cfa8195a18578360e4ad0a1e4cde6878">{mfun</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#T:22">T</a></span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#cfa8195a18578360e4ad0a1e4cde6878">&gt;-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#R:23">R}</a></span>).<br/>
<br/>
<span class="vernacular">Let</span> <span id="distribution_is_probability.distribution0" class="id"><a name="distribution_is_probability.distribution0" class="">distribution0</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#distribution">distribution</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#distribution_is_probability.P">P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#distribution_is_probability.X">X</a></span> <span class="id"><a href="mathcomp.classical.classical_sets.html#set0">set0</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id">0</span>%<span class="id">E</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof3')">Proof.</span></div>
<div class="proofscript" id="proof3">
 <span class="id">exact:</span> <span class="id"><a href="mathcomp.analysis.measure.html#measure0">measure0</a></span>. Qed.</div>
<br/>
<span class="vernacular">Let</span> <span id="distribution_is_probability.distribution_ge0" class="id"><a name="distribution_is_probability.distribution_ge0" class="">distribution_ge0</a></span> <span id="A:26" class="id"><a name="A:26" class="">A</a></span> <span class="id">:</span> (<span class="id">0</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#63b01a542aec2e4c61e028256cf5a548">&lt;=</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#distribution">distribution</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#distribution_is_probability.P">P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#distribution_is_probability.X">X</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#A:26">A</a></span>)%<span class="id">E</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof4')">Proof.</span></div>
<div class="proofscript" id="proof4">
 <span class="id">exact:</span> <span class="id"><a href="mathcomp.analysis.measure.html#measure_ge0">measure_ge0</a></span>. Qed.</div>
<br/>
<span class="vernacular">Let</span> <span id="distribution_is_probability.distribution_sigma_additive" class="id"><a name="distribution_is_probability.distribution_sigma_additive" class="">distribution_sigma_additive</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.measure.html#semi_sigma_additive">semi_sigma_additive</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#distribution">distribution</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#distribution_is_probability.P">P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#distribution_is_probability.X">X</a></span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof5')">Proof.</span></div>
<div class="proofscript" id="proof5">
 <span class="id">exact:</span> <span class="id"><a href="mathcomp.analysis.measure.html#measure_semi_sigma_additive">measure_semi_sigma_additive</a></span>. Qed.</div>
<br/>
<span id="probability_distribution__canonical__measure_Measure" class="id"><span id="HB_unnamed_mixin_5" class="id"><span id="probability_distribution__canonical__measure_Content" class="id"><span id="HB_unnamed_mixin_4" class="id"><span id="measure_isMeasure__to__measure_isContent" class="id"><span id="measure_isMeasure__to__measure_Content_isMeasure" class="id"><span id="HB_unnamed_factory_1" class="id"><a name="probability_distribution__canonical__measure_Measure" class="hierarchy-builder">HB.instance</a></span></span></span></span></span></span></span> <span class="vernacular">Definition</span> <span class="id">_</span> <span class="id">:=</span> <span class="id"><a href="mathcomp.analysis.measure.html#isMeasure.Build">isMeasure.Build</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id"><a href="mathcomp.analysis.probability.html#distribution_is_probability.R">R</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#distribution">distribution</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#distribution_is_probability.P">P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#distribution_is_probability.X">X</a></span>)<br/>
&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#distribution_is_probability.distribution0">distribution0</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#distribution_is_probability.distribution_ge0">distribution_ge0</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#distribution_is_probability.distribution_sigma_additive">distribution_sigma_additive</a></span>.<br/>
<br/>
<span class="vernacular">Let</span> <span id="distribution_is_probability.distribution_is_probability" class="id"><a name="distribution_is_probability.distribution_is_probability" class="">distribution_is_probability</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#distribution">distribution</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#distribution_is_probability.P">P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#distribution_is_probability.X">X</a></span> <span class="id"><a href="mathcomp.classical.classical_sets.html#36b9f1631384d2c3b944cb9d5855cd98">[set:</a></span> <span class="id">_]</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id">1</span>%<span class="id">:E</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof6')">Proof.</span></div>
<div class="proofscript" id="proof6">
<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">/distribution</span> <span class="id">/=</span> <span class="id">/pushforward</span> <span class="id">/=</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#preimage_setT">preimage_setT</a></span> <span class="id"><a href="mathcomp.analysis.measure.html#probability_setT">probability_setT</a></span>.<br/>
Qed.</div>
<br/>
<span id="probability_distribution__canonical__measure_Probability" class="id"><span id="HB_unnamed_mixin_16" class="id"><span id="probability_distribution__canonical__measure_SubProbability" class="id"><span id="HB_unnamed_mixin_15" class="id"><span id="probability_distribution__canonical__measure_FiniteMeasure" class="id"><span id="probability_distribution__canonical__measure_FinNumFun" class="id"><span id="HB_unnamed_mixin_14" class="id"><span id="probability_distribution__canonical__measure_SigmaFiniteMeasure" class="id"><span id="probability_distribution__canonical__measure_SFiniteMeasure" class="id"><span id="HB_unnamed_mixin_13" class="id"><span id="probability_distribution__canonical__measure_SigmaFiniteContent" class="id"><span id="HB_unnamed_mixin_12" class="id"><span id="measure_Measure_isProbability__to__measure_isFinite" class="id"><span id="measure_Measure_isProbability__to__measure_isSFinite" class="id"><span id="measure_Measure_isProbability__to__measure_isSubProbability" class="id"><span id="measure_Measure_isProbability__to__measure_isSigmaFinite" class="id"><span id="measure_Measure_isProbability__to__measure_isProbability" class="id"><span id="HB_unnamed_factory_6" class="id"><a name="probability_distribution__canonical__measure_Probability" class="hierarchy-builder">HB.instance</a></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span> <span class="vernacular">Definition</span> <span class="id">_</span> <span class="id">:=</span> <span class="id"><a href="mathcomp.analysis.measure.html#Measure_isProbability.Build">Measure_isProbability.Build</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id"><a href="mathcomp.analysis.probability.html#distribution_is_probability.R">R</a></span><br/>
&nbsp;&nbsp;(<span class="id"><a href="mathcomp.analysis.probability.html#distribution">distribution</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#distribution_is_probability.P">P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#distribution_is_probability.X">X</a></span>) <span class="id"><a href="mathcomp.analysis.probability.html#distribution_is_probability.distribution_is_probability">distribution_is_probability</a></span>.<br/>
<br/>
<span class="vernacular">End</span> <span class="id"><a href="mathcomp.analysis.probability.html#distribution_is_probability">distribution_is_probability</a></span>.<br/>
<br/>
<span class="vernacular">Section</span> <span id="transfer_probability" class="id"><a name="transfer_probability" class="">transfer_probability</a></span>.<br/>
<span class="vernacular">Local</span> <span class="vernacular">Open</span> <span class="vernacular">Scope</span> <span class="id">ereal_scope</span>.<br/>
<span class="vernacular">Context</span> <span id="d:27" class="id"><a name="d:27" class="">d</a></span> (<span id="T:28" class="id"><a name="T:28" class="">T</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.measure.html#Measurable.Exports.measurableType">measurableType</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#d:27">d</a></span>) (<span id="R:29" class="id"><a name="R:29" class="">R</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.reals.html#Real.Exports.realType">realType</a></span>) (<span id="P:30" class="id"><a name="P:30" class="">P</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.measure.html#Probability.Exports.probability">probability</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#T:28">T</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#R:29">R</a></span>).<br/>
<br/>
<span class="vernacular">Lemma</span> <span id="probability_distribution" class="id"><a name="probability_distribution" class="">probability_distribution</a></span> (<span id="X:31" class="id"><a name="X:31" class="">X</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#31c5002a151d32a5908113f99aedfaa1">{RV</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#transfer_probability.P">P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#31c5002a151d32a5908113f99aedfaa1">&gt;-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#transfer_probability.R">R}</a></span>) <span id="r:32" class="id"><a name="r:32" class="">r</a></span> <span class="id">:</span><br/>
&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#transfer_probability.P">P</a></span> <span class="id"><a href="mathcomp.classical.classical_sets.html#075f2dd209aa707f1415a58a026b96d9">[set</a></span> <span id="x:33" class="id"><a name="x:33" class="">x</a></span> <span class="id"><a href="mathcomp.classical.classical_sets.html#075f2dd209aa707f1415a58a026b96d9">|</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:31">X</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#x:33">x</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#r:32">r]</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#distribution">distribution</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#transfer_probability.P">P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:31">X</a></span> <span class="id"><a href="mathcomp.classical.classical_sets.html#29c78c22490f2dae838b1b504eb858a2">[set</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#r:32">r]</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof7')">Proof.</span></div>
<div class="proofscript" id="proof7">
 <span class="gallina-kwd">by</span> <span class="id">[]</span>. Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="integral_distribution" class="id"><a name="integral_distribution" class="">integral_distribution</a></span> (<span id="X:34" class="id"><a name="X:34" class="">X</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#31c5002a151d32a5908113f99aedfaa1">{RV</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#transfer_probability.P">P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#31c5002a151d32a5908113f99aedfaa1">&gt;-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#transfer_probability.R">R}</a></span>) (<span id="f:35" class="id"><a name="f:35" class="">f</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#transfer_probability.R">R</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#4c9ddfb63ff52527d9adecfde4a667c3">\bar</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#transfer_probability.R">R</a></span>) <span class="id">:</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.measure.html#measurable_fun">measurable_fun</a></span> <span class="id"><a href="mathcomp.classical.classical_sets.html#36b9f1631384d2c3b944cb9d5855cd98">[set:</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#transfer_probability.R">R]</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#f:35">f</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> (<span class="gallina-kwd">forall</span> <span id="y:36" class="id"><a name="y:36" class="">y,</a></span> <span class="id">0</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#63b01a542aec2e4c61e028256cf5a548">&lt;=</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#f:35">f</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#y:36">y</a></span>) <span class="id">-&gt;</span><br/>
&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#3e4826d90e3d691004f544dc3de2d121">\int[distribution</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#transfer_probability.P">P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:34">X]_y</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#f:35">f</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#y:37">y</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#3e4826d90e3d691004f544dc3de2d121">\int[P]_x</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#f:35">f</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.ssrfun.html#687e14754dadb7c0b04f27d8f71d2638">\o</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:34">X</a></span>) <span class="id"><a href="mathcomp.analysis.probability.html#x:38">x</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof8')">Proof.</span></div>
<div class="proofscript" id="proof8">
 <span class="gallina-kwd">by</span> <span class="id">move=&gt;</span> <span class="id">mf</span> <span class="id">f0;</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#ge0_integral_pushforward">ge0_integral_pushforward</a></span>. Qed.</div>
<br/>
<span class="vernacular">End</span> <span class="id"><a href="mathcomp.analysis.probability.html#transfer_probability">transfer_probability</a></span>.<br/>
<br/>
<span id="expectation_unlock_subterm" class="id"><span id="expectation.unlock" class="id"><span id="expectation.body" class="id"><span id="expectation" class="id"><span id="expectation_Locked.unlock" class="id"><span id="expectation_Locked.body" class="id"><span id="expectation_Locked" class="id"><a name="expectation_unlock_subterm" class="">HB.lock</a></span></span></span></span></span></span></span> <span class="vernacular">Definition</span> <span class="id">expectation</span> <span class="id">{d}</span> <span class="id">{T</span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.measure.html#Measurable.Exports.measurableType">measurableType</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#d:39">d}</a></span> <span class="id">{R</span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.reals.html#Real.Exports.realType">realType}</a></span><br/>
&nbsp;&nbsp;(<span id="P:48" class="id"><span id="P:42" class="id"><a name="P:48" class="">P</a></span></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.measure.html#Probability.Exports.probability">probability</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#T:40">T</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#R:41">R</a></span>) (<span id="X:49" class="id"><span id="X:43" class="id"><a name="X:49" class="">X</a></span></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#T:40">T</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#R:41">R</a></span>) <span class="id">:=</span> (<span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#3e4826d90e3d691004f544dc3de2d121">\int[P]_w</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#X:43">X</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#w:44">w</a></span>)%<span class="id">:E</span>)%<span class="id">E</span>.<br/>
<span class="vernacular">Canonical</span> <span id="expectation_unlockable" class="id"><a name="expectation_unlockable" class="">expectation_unlockable</a></span> <span class="id">:=</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssreflect.html#Unlockable">Unlockable</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#unlock">expectation.unlock</a></span>.<br/>
<span class="vernacular">Arguments</span> <span class="id"><a href="mathcomp.analysis.probability.html#body">expectation</a></span> <span class="id">{d</span> <span class="id">T</span> <span class="id">R}</span> <span class="id">P</span> <span class="id">_</span>%<span class="id">R</span>.<br/>
<span class="vernacular">Notation</span> <span id="69ec4e730a589c79df0349357bb8311f" class="id"><a name="69ec4e730a589c79df0349357bb8311f" class="">&quot;''E_' P [ X ]&quot;</a></span> <span class="id">:=</span> (@<span class="id"><a href="mathcomp.analysis.probability.html#expectation">expectation</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">P</span> <span class="id">X</span>) <span class="id">:</span> <span class="id">ereal_scope</span>.<br/>
<br/>
<span class="vernacular">Section</span> <span id="expectation_lemmas" class="id"><a name="expectation_lemmas" class="">expectation_lemmas</a></span>.<br/>
<span class="vernacular">Local</span> <span class="vernacular">Open</span> <span class="vernacular">Scope</span> <span class="id">ereal_scope</span>.<br/>
<span class="vernacular">Context</span> <span id="d:50" class="id"><a name="d:50" class="">d</a></span> (<span id="T:51" class="id"><a name="T:51" class="">T</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.measure.html#Measurable.Exports.measurableType">measurableType</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#d:50">d</a></span>) (<span id="R:52" class="id"><a name="R:52" class="">R</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.reals.html#Real.Exports.realType">realType</a></span>) (<span id="P:53" class="id"><a name="P:53" class="">P</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.measure.html#Probability.Exports.probability">probability</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#T:51">T</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#R:52">R</a></span>).<br/>
<br/>
<span class="vernacular">Lemma</span> <span id="expectation_fin_num" class="id"><a name="expectation_fin_num" class="">expectation_fin_num</a></span> (<span id="X:54" class="id"><a name="X:54" class="">X</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#31c5002a151d32a5908113f99aedfaa1">{RV</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#expectation_lemmas.P">P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#31c5002a151d32a5908113f99aedfaa1">&gt;-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#expectation_lemmas.R">R}</a></span>) <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#expectation_lemmas.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.ssrfun.html#687e14754dadb7c0b04f27d8f71d2638">\o</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:54">X</a></span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#69ec4e730a589c79df0349357bb8311f">'E_P[X]</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#f6c65697fefaf4504de1d4d641cd4409">\is</a></span> <span class="id">a</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#fin_num">fin_num</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof9')">Proof.</span></div>
<div class="proofscript" id="proof9">
 <span class="gallina-kwd">by</span> <span class="id">move=&gt;</span> <span class="id">?;</span> <span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssreflect.html#unlock">unlock</a></span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#integral_fune_fin_num">integral_fune_fin_num</a></span>. Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="expectation_cst" class="id"><a name="expectation_cst" class="">expectation_cst</a></span> <span id="r:55" class="id"><a name="r:55" class="">r</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#69ec4e730a589c79df0349357bb8311f">'E_P[cst</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#r:55">r]</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#r:55">r</a></span>%<span class="id">:E</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof10')">Proof.</span></div>
<div class="proofscript" id="proof10">
 <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssreflect.html#unlock">unlock/=</a></span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#integral_cst">integral_cst//=</a></span> <span class="id"><a href="mathcomp.analysis.measure.html#probability_setT">probability_setT</a></span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#mule1">mule1</a></span>. Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="expectation_indic" class="id"><a name="expectation_indic" class="">expectation_indic</a></span> (<span id="A:56" class="id"><a name="A:56" class="">A</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#set">set</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#expectation_lemmas.T">T</a></span>) (<span id="mA:57" class="id"><a name="mA:57" class="">mA</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.measure.html#measurable">measurable</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#A:56">A</a></span>) <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#69ec4e730a589c79df0349357bb8311f">'E_P[\1_A]</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#expectation_lemmas.P">P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#A:56">A</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof11')">Proof.</span></div>
<div class="proofscript" id="proof11">
 <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssreflect.html#unlock">unlock</a></span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#integral_indic">integral_indic//</a></span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setIT">setIT</a></span>. Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="integrable_expectation" class="id"><a name="integrable_expectation" class="">integrable_expectation</a></span> (<span id="X:58" class="id"><a name="X:58" class="">X</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#31c5002a151d32a5908113f99aedfaa1">{RV</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#expectation_lemmas.P">P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#31c5002a151d32a5908113f99aedfaa1">&gt;-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#expectation_lemmas.R">R}</a></span>)<br/>
&nbsp;&nbsp;(<span id="iX:59" class="id"><a name="iX:59" class="">iX</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#expectation_lemmas.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#36b9f1631384d2c3b944cb9d5855cd98">[set:</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#expectation_lemmas.T">T]</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.ssrfun.html#687e14754dadb7c0b04f27d8f71d2638">\o</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:58">X</a></span>)) <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#baaea4d1d2e6cce26f49e2f830fd4e9f">`|</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#69ec4e730a589c79df0349357bb8311f">'E_P[X]</a></span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#baaea4d1d2e6cce26f49e2f830fd4e9f">|</a></span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#::ereal_scope:x_'&lt;'_x">&lt;</a></span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#d5becfdd26043e7de5a21e6270f35a00">+oo</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof12')">Proof.</span></div>
<div class="proofscript" id="proof12">
<span class="id">move:</span> <span class="id">iX</span> <span class="id">=&gt;</span> <span class="id">/integrableP[?</span> <span class="id">Xoo];</span> <span class="id">rewrite</span> (<span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.order.html#Order.POrderTheory.le_lt_trans">le_lt_trans</a></span> <span class="id">_</span> <span class="id">Xoo</span>)<span class="id">//</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssreflect.html#unlock">unlock</a></span>.<br/>
<span class="id">exact:</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.order.html#Order.POrderTheory.le_trans">le_trans</a></span> (<span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#le_abse_integral">le_abse_integral</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>).<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="expectationM" class="id"><a name="expectationM" class="">expectationM</a></span> (<span id="X:60" class="id"><a name="X:60" class="">X</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#31c5002a151d32a5908113f99aedfaa1">{RV</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#expectation_lemmas.P">P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#31c5002a151d32a5908113f99aedfaa1">&gt;-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#expectation_lemmas.R">R}</a></span>) (<span id="iX:61" class="id"><a name="iX:61" class="">iX</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#expectation_lemmas.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#36b9f1631384d2c3b944cb9d5855cd98">[set:</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#expectation_lemmas.T">T]</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.ssrfun.html#687e14754dadb7c0b04f27d8f71d2638">\o</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:60">X</a></span>))<br/>
&nbsp;&nbsp;(<span id="k:62" class="id"><a name="k:62" class="">k</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#expectation_lemmas.R">R</a></span>) <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#69ec4e730a589c79df0349357bb8311f">'E_P[k</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#5e03abe1c4aaadd0b39b8ab0cf62f35b">\o*</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:60">X]</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#k:62">k</a></span>%<span class="id">:E</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#f1c2ddfea282f8f8d7539f61e14c08e4">*</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#69ec4e730a589c79df0349357bb8311f">'E_P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#69ec4e730a589c79df0349357bb8311f">[X]</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof13')">Proof.</span></div>
<div class="proofscript" id="proof13">
<span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssreflect.html#unlock">unlock;</a></span> <span class="id">under</span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#eq_integral">eq_integral</a></span> <span class="id">do</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFinM">EFinM</a></span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">-integralZl//;</span> <span class="id">under</span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#eq_integral">eq_integral</a></span> <span class="id">do</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#muleC">muleC</a></span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="expectation_ge0" class="id"><a name="expectation_ge0" class="">expectation_ge0</a></span> (<span id="X:63" class="id"><a name="X:63" class="">X</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#31c5002a151d32a5908113f99aedfaa1">{RV</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#expectation_lemmas.P">P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#31c5002a151d32a5908113f99aedfaa1">&gt;-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#expectation_lemmas.R">R}</a></span>) <span class="id">:</span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">forall</span> <span id="x:64" class="id"><a name="x:64" class="">x,</a></span> <span class="id">0</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssrnum.html#cb42ec59ad57b25928e1718b4e69e031">&lt;=</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:63">X</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#x:64">x</a></span>)%<span class="id">R</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id">0</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#63b01a542aec2e4c61e028256cf5a548">&lt;=</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#69ec4e730a589c79df0349357bb8311f">'E_P[X]</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof14')">Proof.</span></div>
<div class="proofscript" id="proof14">
<span class="gallina-kwd">by</span> <span class="id">move=&gt;</span> <span class="id">?;</span> <span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssreflect.html#unlock">unlock</a></span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#integral_ge0">integral_ge0//</a></span> <span class="id">=&gt;</span> <span class="id">x</span> <span class="id">_;</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#lee_fin">lee_fin</a></span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="expectation_le" class="id"><a name="expectation_le" class="">expectation_le</a></span> (<span id="X:65" class="id"><a name="X:65" class="">X</a></span> <span id="Y:66" class="id"><a name="Y:66" class="">Y</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#expectation_lemmas.T">T</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#expectation_lemmas.R">R</a></span>) <span class="id">:</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.measure.html#measurable_fun">measurable_fun</a></span> <span class="id"><a href="mathcomp.classical.classical_sets.html#36b9f1631384d2c3b944cb9d5855cd98">[set:</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#expectation_lemmas.T">T]</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:65">X</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.measure.html#measurable_fun">measurable_fun</a></span> <span class="id"><a href="mathcomp.classical.classical_sets.html#36b9f1631384d2c3b944cb9d5855cd98">[set:</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#expectation_lemmas.T">T]</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#Y:66">Y</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="gallina-kwd">forall</span> <span id="x:67" class="id"><a name="x:67" class="">x,</a></span> <span class="id">0</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssrnum.html#cb42ec59ad57b25928e1718b4e69e031">&lt;=</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:65">X</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#x:67">x</a></span>)%<span class="id">R</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> (<span class="gallina-kwd">forall</span> <span id="x:68" class="id"><a name="x:68" class="">x,</a></span> <span class="id">0</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssrnum.html#cb42ec59ad57b25928e1718b4e69e031">&lt;=</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#Y:66">Y</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#x:68">x</a></span>)%<span class="id">R</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.measure.html#bc9b2ba76d94ad575afd74542172654c">{ae</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#expectation_lemmas.P">P,</a></span> (<span class="gallina-kwd">forall</span> <span id="x:69" class="id"><a name="x:69" class="">x,</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:65">X</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#x:69">x</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssrnum.html#cb42ec59ad57b25928e1718b4e69e031">&lt;=</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#Y:66">Y</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#x:69">x</a></span>)%<span class="id">R}</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#69ec4e730a589c79df0349357bb8311f">'E_P[X]</a></span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#63b01a542aec2e4c61e028256cf5a548">&lt;=</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#69ec4e730a589c79df0349357bb8311f">'E_P[Y]</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof15')">Proof.</span></div>
<div class="proofscript" id="proof15">
<span class="id">move=&gt;</span> <span class="id">mX</span> <span class="id">mY</span> <span class="id">X0</span> <span class="id">Y0</span> <span class="id">XY;</span> <span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssreflect.html#unlock">unlock</a></span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#ae_ge0_le_integral">ae_ge0_le_integral</a></span> <span class="id">=&gt;</span> <span class="id">//</span>.<br/>
<span class="id">-</span> <span class="gallina-kwd">by</span> <span class="id">move=&gt;</span> <span class="id">t</span> <span class="id">_;</span> <span class="id">apply:</span> <span class="id">X0</span>.<br/>
<span class="id">-</span> <span class="id">exact/EFin_measurable_fun</span>.<br/>
<span class="id">-</span> <span class="gallina-kwd">by</span> <span class="id">move=&gt;</span> <span class="id">t</span> <span class="id">_;</span> <span class="id">apply:</span> <span class="id">Y0</span>.<br/>
<span class="id">-</span> <span class="id">exact/EFin_measurable_fun</span>.<br/>
<span class="id">-</span> <span class="id">move:</span> <span class="id">XY</span> <span class="id">=&gt;</span> <span class="id">[N</span> <span class="id">[mN</span> <span class="id">PN</span> <span class="id">XYN]];</span> <span class="gallina-kwd">exists</span> <span class="id">N;</span> <span class="id">split</span> <span class="id">=&gt;</span> <span class="id">//</span> <span class="id">t</span> <span class="id">/=</span> <span class="id">h</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">apply:</span> <span class="id">XYN</span> <span class="id">=&gt;</span> <span class="id">/=;</span> <span class="id">apply:</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#contra_not">contra_not</a></span> <span class="id">h;</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#lee_fin">lee_fin</a></span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="expectationD" class="id"><a name="expectationD" class="">expectationD</a></span> (<span id="X:70" class="id"><a name="X:70" class="">X</a></span> <span id="Y:71" class="id"><a name="Y:71" class="">Y</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#31c5002a151d32a5908113f99aedfaa1">{RV</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#expectation_lemmas.P">P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#31c5002a151d32a5908113f99aedfaa1">&gt;-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#expectation_lemmas.R">R}</a></span>) <span class="id">:</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#expectation_lemmas.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#36b9f1631384d2c3b944cb9d5855cd98">[set:</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#expectation_lemmas.T">T]</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.ssrfun.html#687e14754dadb7c0b04f27d8f71d2638">\o</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:70">X</a></span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#expectation_lemmas.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#36b9f1631384d2c3b944cb9d5855cd98">[set:</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#expectation_lemmas.T">T]</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.ssrfun.html#687e14754dadb7c0b04f27d8f71d2638">\o</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#Y:71">Y</a></span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#69ec4e730a589c79df0349357bb8311f">'E_P[X</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#d85e5ec1adc01afcee458717bbaea5e5">\+</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#Y:71">Y]</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#69ec4e730a589c79df0349357bb8311f">'E_P[X]</a></span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#d4965da372b2485934ec33867ee5fbe7">+</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#69ec4e730a589c79df0349357bb8311f">'E_P[Y]</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof16')">Proof.</span></div>
<div class="proofscript" id="proof16">
 <span class="gallina-kwd">by</span> <span class="id">move=&gt;</span> <span class="id">?</span> <span class="id">?;</span> <span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssreflect.html#unlock">unlock</a></span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#integralD_EFin">integralD_EFin</a></span>. Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="expectationB" class="id"><a name="expectationB" class="">expectationB</a></span> (<span id="X:72" class="id"><a name="X:72" class="">X</a></span> <span id="Y:73" class="id"><a name="Y:73" class="">Y</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#31c5002a151d32a5908113f99aedfaa1">{RV</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#expectation_lemmas.P">P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#31c5002a151d32a5908113f99aedfaa1">&gt;-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#expectation_lemmas.R">R}</a></span>) <span class="id">:</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#expectation_lemmas.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#36b9f1631384d2c3b944cb9d5855cd98">[set:</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#expectation_lemmas.T">T]</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.ssrfun.html#687e14754dadb7c0b04f27d8f71d2638">\o</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:72">X</a></span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#expectation_lemmas.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#36b9f1631384d2c3b944cb9d5855cd98">[set:</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#expectation_lemmas.T">T]</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.ssrfun.html#687e14754dadb7c0b04f27d8f71d2638">\o</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#Y:73">Y</a></span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#69ec4e730a589c79df0349357bb8311f">'E_P[X</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#0bb5d11fe8761db1e6494d75cb45a3cb">\-</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#Y:73">Y]</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#69ec4e730a589c79df0349357bb8311f">'E_P[X]</a></span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#::ereal_scope:x_'-'_x">-</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#69ec4e730a589c79df0349357bb8311f">'E_P[Y]</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof17')">Proof.</span></div>
<div class="proofscript" id="proof17">
 <span class="gallina-kwd">by</span> <span class="id">move=&gt;</span> <span class="id">?</span> <span class="id">?;</span> <span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssreflect.html#unlock">unlock</a></span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#integralB_EFin">integralB_EFin</a></span>. Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="expectation_sum" class="id"><a name="expectation_sum" class="">expectation_sum</a></span> (<span id="X:74" class="id"><a name="X:74" class="">X</a></span> <span class="id">:</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.seq.html#seq">seq</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#31c5002a151d32a5908113f99aedfaa1">{RV</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#expectation_lemmas.P">P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#31c5002a151d32a5908113f99aedfaa1">&gt;-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#expectation_lemmas.R">R}</a></span>) <span class="id">:</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="gallina-kwd">forall</span> <span id="Xi:75" class="id"><a name="Xi:75" class="">Xi,</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#Xi:75">Xi</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7">\in</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:74">X</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#expectation_lemmas.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#36b9f1631384d2c3b944cb9d5855cd98">[set:</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#expectation_lemmas.T">T]</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.ssrfun.html#687e14754dadb7c0b04f27d8f71d2638">\o</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#Xi:75">Xi</a></span>)) <span class="id">-&gt;</span><br/>
&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#69ec4e730a589c79df0349357bb8311f">'E_P[\sum_</a></span>(<span id="Xi:78" class="id"><span id="Xi:77" class="id"><span id="Xi:76" class="id"><a name="Xi:78" class="">Xi</a></span></span></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#706f4f0208bba5d79e26d335c76ea034">&lt;-</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:74">X</a></span>) <span class="id"><a href="mathcomp.analysis.probability.html#Xi:76">Xi]</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#2ed228b16343d82e9e410c7fc103f88a">\sum_</a></span>(<span id="Xi:81" class="id"><span id="Xi:80" class="id"><span id="Xi:79" class="id"><a name="Xi:81" class="">Xi</a></span></span></span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#2ed228b16343d82e9e410c7fc103f88a">&lt;-</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:74">X</a></span>) <span class="id"><a href="mathcomp.analysis.probability.html#69ec4e730a589c79df0349357bb8311f">'E_P[Xi]</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof18')">Proof.</span></div>
<div class="proofscript" id="proof18">
<span class="id">elim:</span> <span class="id">X</span> <span class="id">=&gt;</span> <span class="id">[|X0</span> <span class="id">X</span> <span class="id">IHX]</span> <span class="id">intX;</span> <span class="id">first</span> <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">!big_nil</span> <span class="id"><a href="mathcomp.analysis.probability.html#expectation_cst">expectation_cst</a></span>.<br/>
<span class="id">have</span> <span class="id">intX0</span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#expectation_lemmas.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#36b9f1631384d2c3b944cb9d5855cd98">[set:</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#expectation_lemmas.T">T]</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.ssrfun.html#687e14754dadb7c0b04f27d8f71d2638">\o</a></span> <span class="id">X0</span>).<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">apply:</span> <span class="id">intX;</span> <span class="id">rewrite</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.seq.html#in_cons">in_cons</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.eqtype.html#eqxx">eqxx</a></span>.<br/>
<span class="id">have</span> <span class="id">{}intX</span> <span class="id">Xi</span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#Xi:82">Xi</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7">\in</a></span> <span class="id">X</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#expectation_lemmas.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#36b9f1631384d2c3b944cb9d5855cd98">[set:</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#expectation_lemmas.T">T]</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.ssrfun.html#687e14754dadb7c0b04f27d8f71d2638">\o</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#Xi:82">Xi</a></span>).<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">move=&gt;</span> <span class="id">XiX;</span> <span class="id">apply:</span> <span class="id">intX;</span> <span class="id">rewrite</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.seq.html#in_cons">in_cons</a></span> <span class="id">XiX</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#orbT">orbT</a></span>.<br/>
<span class="id">rewrite</span> <span class="id">!big_cons</span> <span class="id"><a href="mathcomp.analysis.probability.html#expectationD">expectationD</a></span> <span class="id">?IHX//</span> (<span class="id">_</span> <span class="id">:</span> <span class="id">_</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.ssrfun.html#687e14754dadb7c0b04f27d8f71d2638">\o</a></span> <span class="id">_</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="gallina-kwd">fun</span> <span id="x:93" class="id"><span id="x:88" class="id"><span id="x:83" class="id"><a name="x:93" class="">x</a></span></span></span> <span class="id">=&gt;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#2ed228b16343d82e9e410c7fc103f88a">\sum_</a></span>(<span id="f:97" class="id"><span id="f:96" class="id"><span id="f:95" class="id"><span id="f:92" class="id"><span id="f:91" class="id"><span id="f:90" class="id"><span id="f:87" class="id"><span id="f:86" class="id"><span id="f:85" class="id"><a name="f:97" class="">f</a></span></span></span></span></span></span></span></span></span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#2ed228b16343d82e9e410c7fc103f88a">&lt;-</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.seq.html#map">map</a></span> (<span class="gallina-kwd">fun</span> <span id="x:94" class="id"><span id="x:89" class="id"><span id="x:84" class="id"><a name="x:94" class="">x</a></span></span></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#31c5002a151d32a5908113f99aedfaa1">{RV</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#expectation_lemmas.P">P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#31c5002a151d32a5908113f99aedfaa1">&gt;-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#expectation_lemmas.R">R}</a></span> <span class="id">=&gt;</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.ssrfun.html#687e14754dadb7c0b04f27d8f71d2638">\o</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#x:84">x</a></span>) <span class="id">X</span>) <span class="id"><a href="mathcomp.analysis.probability.html#f:85">f</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#x:83">x</a></span>).<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">apply:</span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#integrable_sum">integrable_sum</a></span> <span class="id">=&gt;</span> <span class="id">//</span> <span class="id">_</span> <span class="id">/mapP[h</span> <span class="id">hX</span> <span class="id">-&gt;];</span> <span class="id">exact:</span> <span class="id">intX</span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">apply/funext</span> <span class="id">=&gt;</span> <span class="id">t/=;</span> <span class="id">rewrite</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.bigop.html#big_map">big_map</a></span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#sumEFin">sumEFin</a></span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#mfun_sum">mfun_sum</a></span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">End</span> <span class="id"><a href="mathcomp.analysis.probability.html#expectation_lemmas">expectation_lemmas</a></span>.<br/>
<br/>
<span id="covariance_unlock_subterm" class="id"><span id="covariance.unlock" class="id"><span id="covariance.body" class="id"><span id="covariance" class="id"><span id="covariance_Locked.unlock" class="id"><span id="covariance_Locked.body" class="id"><span id="covariance_Locked" class="id"><a name="covariance_unlock_subterm" class="">HB.lock</a></span></span></span></span></span></span></span> <span class="vernacular">Definition</span> <span class="id">covariance</span> <span class="id">{d}</span> <span class="id">{T</span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.measure.html#Measurable.Exports.measurableType">measurableType</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#d:98">d}</a></span> <span class="id">{R</span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.reals.html#Real.Exports.realType">realType}</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span id="P:107" class="id"><span id="P:101" class="id"><a name="P:107" class="">P</a></span></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.measure.html#Probability.Exports.probability">probability</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#T:99">T</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#R:100">R</a></span>) (<span id="X:108" class="id"><span id="X:102" class="id"><a name="X:108" class="">X</a></span></span> <span id="Y:109" class="id"><span id="Y:103" class="id"><a name="Y:109" class="">Y</a></span></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#T:99">T</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#R:100">R</a></span>) <span class="id">:=</span><br/>
&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#69ec4e730a589c79df0349357bb8311f">'E_P[</a></span>(<span class="id"><a href="mathcomp.analysis.probability.html#X:102">X</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#0bb5d11fe8761db1e6494d75cb45a3cb">\-</a></span> <span class="id"><a href="mathcomp.classical.functions.html#cst">cst</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#fine">fine</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#69ec4e730a589c79df0349357bb8311f">'E_P[X]</a></span>)) <span class="id">*</span> (<span class="id"><a href="mathcomp.analysis.probability.html#Y:103">Y</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#0bb5d11fe8761db1e6494d75cb45a3cb">\-</a></span> <span class="id"><a href="mathcomp.classical.functions.html#cst">cst</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#fine">fine</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#69ec4e730a589c79df0349357bb8311f">'E_P[Y]</a></span>))<span class="id"><a href="mathcomp.analysis.probability.html#69ec4e730a589c79df0349357bb8311f">]</a></span>%<span class="id">E</span>.<br/>
<span class="vernacular">Canonical</span> <span id="covariance_unlockable" class="id"><a name="covariance_unlockable" class="">covariance_unlockable</a></span> <span class="id">:=</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssreflect.html#Unlockable">Unlockable</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#unlock">covariance.unlock</a></span>.<br/>
<span class="vernacular">Arguments</span> <span class="id"><a href="mathcomp.analysis.probability.html#body">covariance</a></span> <span class="id">{d</span> <span class="id">T</span> <span class="id">R}</span> <span class="id">P</span> <span class="id">_</span>%<span class="id">R</span> <span class="id">_</span>%<span class="id">R</span>.<br/>
<br/>
<span class="vernacular">Section</span> <span id="covariance_lemmas" class="id"><a name="covariance_lemmas" class="">covariance_lemmas</a></span>.<br/>
<span class="vernacular">Local</span> <span class="vernacular">Open</span> <span class="vernacular">Scope</span> <span class="id">ereal_scope</span>.<br/>
<span class="vernacular">Context</span> <span id="d:110" class="id"><a name="d:110" class="">d</a></span> (<span id="T:111" class="id"><a name="T:111" class="">T</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.measure.html#Measurable.Exports.measurableType">measurableType</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#d:110">d</a></span>) (<span id="R:112" class="id"><a name="R:112" class="">R</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.reals.html#Real.Exports.realType">realType</a></span>) (<span id="P:113" class="id"><a name="P:113" class="">P</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.measure.html#Probability.Exports.probability">probability</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#T:111">T</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#R:112">R</a></span>).<br/>
<br/>
<span class="vernacular">Lemma</span> <span id="covarianceE" class="id"><a name="covarianceE" class="">covarianceE</a></span> (<span id="X:114" class="id"><a name="X:114" class="">X</a></span> <span id="Y:115" class="id"><a name="Y:115" class="">Y</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#31c5002a151d32a5908113f99aedfaa1">{RV</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#31c5002a151d32a5908113f99aedfaa1">&gt;-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.R">R}</a></span>) <span class="id">:</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.ssrfun.html#687e14754dadb7c0b04f27d8f71d2638">\o</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:114">X</a></span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.ssrfun.html#687e14754dadb7c0b04f27d8f71d2638">\o</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#Y:115">Y</a></span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.ssrfun.html#687e14754dadb7c0b04f27d8f71d2638">\o</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#X:114">X</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#2d0cfb150261028f4ebd2ba355623dcc">*</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#Y:115">Y</a></span>)%<span class="id">R</span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#covariance">covariance</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:114">X</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#Y:115">Y</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#69ec4e730a589c79df0349357bb8311f">'E_P[X</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#2d0cfb150261028f4ebd2ba355623dcc">*</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#Y:115">Y]</a></span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#::ereal_scope:x_'-'_x">-</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#69ec4e730a589c79df0349357bb8311f">'E_P[X]</a></span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#f1c2ddfea282f8f8d7539f61e14c08e4">*</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#69ec4e730a589c79df0349357bb8311f">'E_P[Y]</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof19')">Proof.</span></div>
<div class="proofscript" id="proof19">
<span class="id">move=&gt;</span> <span class="id">X1</span> <span class="id">Y1</span> <span class="id">XY1</span>.<br/>
<span class="id">have</span> <span class="id">?</span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#69ec4e730a589c79df0349357bb8311f">'E_P[X]</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#f6c65697fefaf4504de1d4d641cd4409">\is</a></span> <span class="id">a</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#fin_num">fin_num</a></span> <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#fin_num_abs">fin_num_abs//</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#integrable_expectation">integrable_expectation</a></span>.<br/>
<span class="id">have</span> <span class="id">?</span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#69ec4e730a589c79df0349357bb8311f">'E_P[Y]</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#f6c65697fefaf4504de1d4d641cd4409">\is</a></span> <span class="id">a</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#fin_num">fin_num</a></span> <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#fin_num_abs">fin_num_abs//</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#integrable_expectation">integrable_expectation</a></span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssreflect.html#unlock">unlock</a></span> <span class="id">[X</span> <span class="gallina-kwd">in</span> <span class="id"><a href="mathcomp.analysis.probability.html#69ec4e730a589c79df0349357bb8311f">'E_P[X]]</a></span>(<span class="id">_</span> <span class="id">:</span> <span class="id">_</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> (<span class="id">X</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#97c66421897c043c5333ab3c7e831f5b">\*</a></span> <span class="id">Y</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#0bb5d11fe8761db1e6494d75cb45a3cb">\-</a></span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#fine">fine</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#69ec4e730a589c79df0349357bb8311f">'E_P[X]</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#5e03abe1c4aaadd0b39b8ab0cf62f35b">\o*</a></span> <span class="id">Y</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">\-</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#fine">fine</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#69ec4e730a589c79df0349357bb8311f">'E_P[Y]</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#5e03abe1c4aaadd0b39b8ab0cf62f35b">\o*</a></span> <span class="id">X</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#d85e5ec1adc01afcee458717bbaea5e5">\+</a></span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#fine">fine</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#69ec4e730a589c79df0349357bb8311f">'E_P[X]</a></span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#f1c2ddfea282f8f8d7539f61e14c08e4">*</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#69ec4e730a589c79df0349357bb8311f">'E_P[Y]</a></span>) <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#5e03abe1c4aaadd0b39b8ab0cf62f35b">\o*</a></span> <span class="id"><a href="mathcomp.classical.functions.html#cst">cst</a></span> <span class="id">1</span>)%<span class="id">R</span>)<span class="id">;</span> <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;<span class="id">apply/funeqP</span> <span class="id">=&gt;</span> <span class="id">x</span> <span class="id">/=;</span> <span class="id">rewrite</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#GRing.Theory.mulrDr">mulrDr</a></span> <span class="id">!mulrDl/=</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#GRing.Theory.mul1r">mul1r</a></span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#fineM">fineM//</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#GRing.Theory.mulrNN">mulrNN</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#GRing.Theory.addrA">addrA</a></span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#GRing.Theory.mulrN">mulrN</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#GRing.Theory.mulNr">mulNr</a></span> <span class="id">[Z</span> <span class="gallina-kwd">in</span> (<span class="id">X</span> <span class="id">x</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#2d0cfb150261028f4ebd2ba355623dcc">*</a></span> <span class="id">Y</span> <span class="id">x</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#::ring_scope:x_'-'_x">-</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#Z:117">Z</a></span>)%<span class="id">R]mulrC</span>.<br/>
<span class="id">have</span> <span class="id">?</span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#36b9f1631384d2c3b944cb9d5855cd98">[set:</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.T">T]</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.ssrfun.html#687e14754dadb7c0b04f27d8f71d2638">\o</a></span> (<span class="id">X</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#97c66421897c043c5333ab3c7e831f5b">\*</a></span> <span class="id">Y</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#0bb5d11fe8761db1e6494d75cb45a3cb">\-</a></span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#fine">fine</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#69ec4e730a589c79df0349357bb8311f">'E_P[X]</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#5e03abe1c4aaadd0b39b8ab0cf62f35b">\o*</a></span> <span class="id">Y</span>)%<span class="id">R</span>).<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.ereal.html#compreBr">compreBr</a></span> <span class="id">?integrableB//</span> <span class="id"><a href="mathcomp.analysis.ereal.html#compre_scale">compre_scale</a></span> <span class="id">?integrableZl</span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.probability.html#expectationD">expectationD/=;</a></span> <span class="id">last</span> <span class="id">2</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;<span class="id">-</span> <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.ereal.html#compreBr">compreBr//</a></span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#integrableB">integrableB//</a></span> <span class="id"><a href="mathcomp.analysis.ereal.html#compre_scale">compre_scale</a></span> <span class="id">?integrableZl</span>.<br/>
&nbsp;&nbsp;<span class="id">-</span> <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.ereal.html#compre_scale">compre_scale//</a></span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#integrableZl">integrableZl//</a></span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#finite_measure_integrable_cst">finite_measure_integrable_cst</a></span>.<br/>
<span class="id">rewrite</span> <span class="id">2?expectationB//=</span> <span class="id">?compre_scale//</span> <span class="id">?integrableZl//</span>.<br/>
<span class="id">rewrite</span> <span class="id">3?expectationM//=</span> <span class="id">?finite_measure_integrable_cst//</span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.probability.html#expectation_cst">expectation_cst</a></span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#mule1">mule1</a></span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#fineM">fineM//</a></span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFinM">EFinM</a></span> <span class="id">!fineK//</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#muleC">muleC</a></span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#subeK">subeK</a></span> <span class="id">?fin_numM</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="covarianceC" class="id"><a name="covarianceC" class="">covarianceC</a></span> (<span id="X:118" class="id"><a name="X:118" class="">X</a></span> <span id="Y:119" class="id"><a name="Y:119" class="">Y</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.T">T</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.R">R</a></span>) <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance">covariance</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:118">X</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#Y:119">Y</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance">covariance</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#Y:119">Y</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:118">X</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof20')">Proof.</span></div>
<div class="proofscript" id="proof20">
<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssreflect.html#unlock">unlock;</a></span> <span class="id">congr</span> <span class="id"><a href="mathcomp.analysis.probability.html#expectation">expectation;</a></span> <span class="id">apply/funeqP</span> <span class="id">=&gt;</span> <span class="id">x</span> <span class="id">/=;</span> <span class="id">rewrite</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#GRing.Theory.mulrC">mulrC</a></span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="covariance_fin_num" class="id"><a name="covariance_fin_num" class="">covariance_fin_num</a></span> (<span id="X:120" class="id"><a name="X:120" class="">X</a></span> <span id="Y:121" class="id"><a name="Y:121" class="">Y</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#31c5002a151d32a5908113f99aedfaa1">{RV</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#31c5002a151d32a5908113f99aedfaa1">&gt;-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.R">R}</a></span>) <span class="id">:</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.ssrfun.html#687e14754dadb7c0b04f27d8f71d2638">\o</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:120">X</a></span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.ssrfun.html#687e14754dadb7c0b04f27d8f71d2638">\o</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#Y:121">Y</a></span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.ssrfun.html#687e14754dadb7c0b04f27d8f71d2638">\o</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#X:120">X</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#2d0cfb150261028f4ebd2ba355623dcc">*</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#Y:121">Y</a></span>)%<span class="id">R</span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#covariance">covariance</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:120">X</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#Y:121">Y</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#f6c65697fefaf4504de1d4d641cd4409">\is</a></span> <span class="id">a</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#fin_num">fin_num</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof21')">Proof.</span></div>
<div class="proofscript" id="proof21">
<span class="gallina-kwd">by</span> <span class="id">move=&gt;</span> <span class="id">X1</span> <span class="id">Y1</span> <span class="id">XY1;</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.probability.html#covarianceE">covarianceE//</a></span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#fin_numB">fin_numB</a></span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#fin_numM">fin_numM</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#expectation_fin_num">expectation_fin_num</a></span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="covariance_cst_l" class="id"><a name="covariance_cst_l" class="">covariance_cst_l</a></span> <span id="c:122" class="id"><a name="c:122" class="">c</a></span> (<span id="X:123" class="id"><a name="X:123" class="">X</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#31c5002a151d32a5908113f99aedfaa1">{RV</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#31c5002a151d32a5908113f99aedfaa1">&gt;-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.R">R}</a></span>) <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance">covariance</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span> (<span class="id"><a href="mathcomp.classical.functions.html#cst">cst</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#c:122">c</a></span>) <span class="id"><a href="mathcomp.analysis.probability.html#X:123">X</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id">0</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof22')">Proof.</span></div>
<div class="proofscript" id="proof22">
<span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssreflect.html#unlock">unlock</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#expectation_cst">expectation_cst/=</a></span>.<br/>
<span class="id">rewrite</span> <span class="id">[X</span> <span class="gallina-kwd">in</span> <span class="id"><a href="mathcomp.analysis.probability.html#69ec4e730a589c79df0349357bb8311f">'E_P[X]]</a></span>(<span class="id">_</span> <span class="id">:</span> <span class="id">_</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="mathcomp.classical.functions.html#cst">cst</a></span> <span class="id">0</span>%<span class="id">R</span>) <span class="id">?expectation_cst//</span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">apply/funeqP</span> <span class="id">=&gt;</span> <span class="id">x;</span> <span class="id">rewrite</span> <span class="id">/GRing</span>.<span class="id">mul/=</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#GRing.Theory.subrr">subrr</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#GRing.Theory.mul0r">mul0r</a></span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="covariance_cst_r" class="id"><a name="covariance_cst_r" class="">covariance_cst_r</a></span> (<span id="X:125" class="id"><a name="X:125" class="">X</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#31c5002a151d32a5908113f99aedfaa1">{RV</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#31c5002a151d32a5908113f99aedfaa1">&gt;-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.R">R}</a></span>) <span id="c:126" class="id"><a name="c:126" class="">c</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance">covariance</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:125">X</a></span> (<span class="id"><a href="mathcomp.classical.functions.html#cst">cst</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#c:126">c</a></span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id">0</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof23')">Proof.</span></div>
<div class="proofscript" id="proof23">
 <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.probability.html#covarianceC">covarianceC</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance_cst_l">covariance_cst_l</a></span>. Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="covarianceZl" class="id"><a name="covarianceZl" class="">covarianceZl</a></span> <span id="a:127" class="id"><a name="a:127" class="">a</a></span> (<span id="X:128" class="id"><a name="X:128" class="">X</a></span> <span id="Y:129" class="id"><a name="Y:129" class="">Y</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#31c5002a151d32a5908113f99aedfaa1">{RV</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#31c5002a151d32a5908113f99aedfaa1">&gt;-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.R">R}</a></span>) <span class="id">:</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.ssrfun.html#687e14754dadb7c0b04f27d8f71d2638">\o</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:128">X</a></span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.ssrfun.html#687e14754dadb7c0b04f27d8f71d2638">\o</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#Y:129">Y</a></span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.ssrfun.html#687e14754dadb7c0b04f27d8f71d2638">\o</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#X:128">X</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#2d0cfb150261028f4ebd2ba355623dcc">*</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#Y:129">Y</a></span>)%<span class="id">R</span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#covariance">covariance</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#a:127">a</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#5e03abe1c4aaadd0b39b8ab0cf62f35b">\o*</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:128">X</a></span>)%<span class="id">R</span> <span class="id"><a href="mathcomp.analysis.probability.html#Y:129">Y</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#a:127">a</a></span>%<span class="id">:E</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#f1c2ddfea282f8f8d7539f61e14c08e4">*</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance">covariance</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:128">X</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#Y:129">Y</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof24')">Proof.</span></div>
<div class="proofscript" id="proof24">
<span class="id">move=&gt;</span> <span class="id">X1</span> <span class="id">Y1</span> <span class="id">XY1</span>.<br/>
<span class="id">have</span> <span class="id">aXY</span> <span class="id">:</span> (<span class="id">a</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#5e03abe1c4aaadd0b39b8ab0cf62f35b">\o*</a></span> <span class="id">X</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#2d0cfb150261028f4ebd2ba355623dcc">*</a></span> <span class="id">Y</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id">a</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#5e03abe1c4aaadd0b39b8ab0cf62f35b">\o*</a></span> (<span class="id">X</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#2d0cfb150261028f4ebd2ba355623dcc">*</a></span> <span class="id">Y</span>))%<span class="id">R</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">apply/funeqP</span> <span class="id">=&gt;</span> <span class="id">x;</span> <span class="id">rewrite</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#GRing.Theory.mulrAC">mulrAC</a></span>.<br/>
<span class="id">rewrite</span> <span class="id">[LHS]covarianceE</span> <span class="id">=&gt;</span> <span class="id">[||//|]</span> <span class="id">/=;</span> <span class="id">last</span> <span class="id">2</span> <span class="id">first</span>.<br/>
<span class="id">-</span> <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.ereal.html#compre_scale">compre_scale</a></span> <span class="id">?integrableZl</span>.<br/>
<span class="id">-</span> <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">aXY</span> <span class="id"><a href="mathcomp.analysis.ereal.html#compre_scale">compre_scale</a></span> <span class="id">?integrableZl</span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.probability.html#covarianceE">covarianceE//</a></span> <span class="id">aXY</span> <span class="id">!expectationM//</span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">-muleA</span> <span class="id">-muleBr//</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#fin_num_adde_defr">fin_num_adde_defr//</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#expectation_fin_num">expectation_fin_num</a></span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="covarianceZr" class="id"><a name="covarianceZr" class="">covarianceZr</a></span> <span id="a:130" class="id"><a name="a:130" class="">a</a></span> (<span id="X:131" class="id"><a name="X:131" class="">X</a></span> <span id="Y:132" class="id"><a name="Y:132" class="">Y</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#31c5002a151d32a5908113f99aedfaa1">{RV</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#31c5002a151d32a5908113f99aedfaa1">&gt;-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.R">R}</a></span>) <span class="id">:</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.ssrfun.html#687e14754dadb7c0b04f27d8f71d2638">\o</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:131">X</a></span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.ssrfun.html#687e14754dadb7c0b04f27d8f71d2638">\o</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#Y:132">Y</a></span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.ssrfun.html#687e14754dadb7c0b04f27d8f71d2638">\o</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#X:131">X</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#2d0cfb150261028f4ebd2ba355623dcc">*</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#Y:132">Y</a></span>)%<span class="id">R</span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#covariance">covariance</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:131">X</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#a:130">a</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#5e03abe1c4aaadd0b39b8ab0cf62f35b">\o*</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#Y:132">Y</a></span>)%<span class="id">R</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#a:130">a</a></span>%<span class="id">:E</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#f1c2ddfea282f8f8d7539f61e14c08e4">*</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance">covariance</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:131">X</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#Y:132">Y</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof25')">Proof.</span></div>
<div class="proofscript" id="proof25">
<span class="id">move=&gt;</span> <span class="id">X1</span> <span class="id">Y1</span> <span class="id">XY1</span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">[in</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssrmatching.ssrmatching.html#SsrMatchingSyntax.RHS">RHS]covarianceC</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covarianceC">covarianceC</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covarianceZl">covarianceZl;</a></span> <span class="id">last</span> <span class="id">rewrite</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#GRing.Theory.mulrC">mulrC</a></span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="covarianceNl" class="id"><a name="covarianceNl" class="">covarianceNl</a></span> (<span id="X:133" class="id"><a name="X:133" class="">X</a></span> <span id="Y:134" class="id"><a name="Y:134" class="">Y</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#31c5002a151d32a5908113f99aedfaa1">{RV</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#31c5002a151d32a5908113f99aedfaa1">&gt;-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.R">R}</a></span>) <span class="id">:</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.ssrfun.html#687e14754dadb7c0b04f27d8f71d2638">\o</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:133">X</a></span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.ssrfun.html#687e14754dadb7c0b04f27d8f71d2638">\o</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#Y:134">Y</a></span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.ssrfun.html#687e14754dadb7c0b04f27d8f71d2638">\o</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#X:133">X</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#2d0cfb150261028f4ebd2ba355623dcc">*</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#Y:134">Y</a></span>)%<span class="id">R</span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#covariance">covariance</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span> (<span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#565ca4aa0f5062a899cb0ce9091bd2da">\-</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:133">X</a></span>)%<span class="id">R</span> <span class="id"><a href="mathcomp.analysis.probability.html#Y:134">Y</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#::ereal_scope:'-'_x">-</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance">covariance</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:133">X</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#Y:134">Y</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof26')">Proof.</span></div>
<div class="proofscript" id="proof26">
<span class="id">move=&gt;</span> <span class="id">X1</span> <span class="id">Y1</span> <span class="id">XY1</span>.<br/>
<span class="id">have</span> <span class="id">-&gt;</span> <span class="id">:</span> (<span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#565ca4aa0f5062a899cb0ce9091bd2da">\-</a></span> <span class="id">X</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id">-1</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#5e03abe1c4aaadd0b39b8ab0cf62f35b">\o*</a></span> <span class="id">X</span>)%<span class="id">R</span> <span class="gallina-kwd">by</span> <span class="id">apply/funeqP</span> <span class="id">=&gt;</span> <span class="id">x</span> <span class="id">/=;</span> <span class="id">rewrite</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#GRing.Theory.mulrN">mulrN</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#GRing.Theory.mulr1">mulr1</a></span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.probability.html#covarianceZl">covarianceZl//</a></span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFinN">EFinN</a></span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#mulNe">mulNe</a></span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#mul1e">mul1e</a></span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="covarianceNr" class="id"><a name="covarianceNr" class="">covarianceNr</a></span> (<span id="X:135" class="id"><a name="X:135" class="">X</a></span> <span id="Y:136" class="id"><a name="Y:136" class="">Y</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#31c5002a151d32a5908113f99aedfaa1">{RV</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#31c5002a151d32a5908113f99aedfaa1">&gt;-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.R">R}</a></span>) <span class="id">:</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.ssrfun.html#687e14754dadb7c0b04f27d8f71d2638">\o</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:135">X</a></span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.ssrfun.html#687e14754dadb7c0b04f27d8f71d2638">\o</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#Y:136">Y</a></span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.ssrfun.html#687e14754dadb7c0b04f27d8f71d2638">\o</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#X:135">X</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#2d0cfb150261028f4ebd2ba355623dcc">*</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#Y:136">Y</a></span>)%<span class="id">R</span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#covariance">covariance</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:135">X</a></span> (<span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#565ca4aa0f5062a899cb0ce9091bd2da">\-</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#Y:136">Y</a></span>)%<span class="id">R</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#::ereal_scope:'-'_x">-</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance">covariance</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:135">X</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#Y:136">Y</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof27')">Proof.</span></div>
<div class="proofscript" id="proof27">
 <span class="gallina-kwd">by</span> <span class="id">move=&gt;</span> <span class="id">X1</span> <span class="id">Y1</span> <span class="id">XY1;</span> <span class="id">rewrite</span> <span class="id">!</span>(<span class="id"><a href="mathcomp.analysis.probability.html#covarianceC">covarianceC</a></span> <span class="id">X</span>) <span class="id"><a href="mathcomp.analysis.probability.html#covarianceNl">covarianceNl</a></span> <span class="id">1?mulrC</span>. Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="covarianceNN" class="id"><a name="covarianceNN" class="">covarianceNN</a></span> (<span id="X:137" class="id"><a name="X:137" class="">X</a></span> <span id="Y:138" class="id"><a name="Y:138" class="">Y</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#31c5002a151d32a5908113f99aedfaa1">{RV</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#31c5002a151d32a5908113f99aedfaa1">&gt;-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.R">R}</a></span>) <span class="id">:</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.ssrfun.html#687e14754dadb7c0b04f27d8f71d2638">\o</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:137">X</a></span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.ssrfun.html#687e14754dadb7c0b04f27d8f71d2638">\o</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#Y:138">Y</a></span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.ssrfun.html#687e14754dadb7c0b04f27d8f71d2638">\o</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#X:137">X</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#2d0cfb150261028f4ebd2ba355623dcc">*</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#Y:138">Y</a></span>)%<span class="id">R</span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#covariance">covariance</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span> (<span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#565ca4aa0f5062a899cb0ce9091bd2da">\-</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:137">X</a></span>)%<span class="id">R</span> (<span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#565ca4aa0f5062a899cb0ce9091bd2da">\-</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#Y:138">Y</a></span>)%<span class="id">R</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance">covariance</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:137">X</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#Y:138">Y</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof28')">Proof.</span></div>
<div class="proofscript" id="proof28">
<span class="id">move=&gt;</span> <span class="id">X1</span> <span class="id">Y1</span> <span class="id">XY1</span>.<br/>
<span class="id">have</span> <span class="id">NY</span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.ssrfun.html#687e14754dadb7c0b04f27d8f71d2638">\o</a></span> (<span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#565ca4aa0f5062a899cb0ce9091bd2da">\-</a></span> <span class="id">Y</span>)%<span class="id">R</span>) <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.ereal.html#compreN">compreN</a></span> <span class="id">?integrableN</span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.probability.html#covarianceNl">covarianceNl</a></span> <span class="id">?covarianceNr</span> <span class="id">?oppeK//=</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#GRing.Theory.mulrN">mulrN</a></span> <span class="id"><a href="mathcomp.analysis.ereal.html#compreN">compreN</a></span> <span class="id">?integrableN</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="covarianceDl" class="id"><a name="covarianceDl" class="">covarianceDl</a></span> (<span id="X:139" class="id"><a name="X:139" class="">X</a></span> <span id="Y:140" class="id"><a name="Y:140" class="">Y</a></span> <span id="Z:141" class="id"><a name="Z:141" class="">Z</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#31c5002a151d32a5908113f99aedfaa1">{RV</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#31c5002a151d32a5908113f99aedfaa1">&gt;-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.R">R}</a></span>) <span class="id">:</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.ssrfun.html#687e14754dadb7c0b04f27d8f71d2638">\o</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:139">X</a></span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.ssrfun.html#687e14754dadb7c0b04f27d8f71d2638">\o</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#X:139">X</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#663140372ac3b275aae871b74b140513">^+</a></span> <span class="id">2</span>)%<span class="id">R</span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.ssrfun.html#687e14754dadb7c0b04f27d8f71d2638">\o</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#Y:140">Y</a></span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.ssrfun.html#687e14754dadb7c0b04f27d8f71d2638">\o</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#Y:140">Y</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#663140372ac3b275aae871b74b140513">^+</a></span> <span class="id">2</span>)%<span class="id">R</span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.ssrfun.html#687e14754dadb7c0b04f27d8f71d2638">\o</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#Z:141">Z</a></span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.ssrfun.html#687e14754dadb7c0b04f27d8f71d2638">\o</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#Z:141">Z</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#663140372ac3b275aae871b74b140513">^+</a></span> <span class="id">2</span>)%<span class="id">R</span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.ssrfun.html#687e14754dadb7c0b04f27d8f71d2638">\o</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#X:139">X</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#2d0cfb150261028f4ebd2ba355623dcc">*</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#Z:141">Z</a></span>)%<span class="id">R</span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.ssrfun.html#687e14754dadb7c0b04f27d8f71d2638">\o</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#Y:140">Y</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#2d0cfb150261028f4ebd2ba355623dcc">*</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#Z:141">Z</a></span>)%<span class="id">R</span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#covariance">covariance</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#X:139">X</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#d85e5ec1adc01afcee458717bbaea5e5">\+</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#Y:140">Y</a></span>)%<span class="id">R</span> <span class="id"><a href="mathcomp.analysis.probability.html#Z:141">Z</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance">covariance</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:139">X</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#Z:141">Z</a></span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#d4965da372b2485934ec33867ee5fbe7">+</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance">covariance</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#Y:140">Y</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#Z:141">Z</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof29')">Proof.</span></div>
<div class="proofscript" id="proof29">
<span class="id">move=&gt;</span> <span class="id">X1</span> <span class="id">X2</span> <span class="id">Y1</span> <span class="id">Y2</span> <span class="id">Z1</span> <span class="id">Z2</span> <span class="id">XZ1</span> <span class="id">YZ1</span>.<br/>
<span class="id">rewrite</span> <span class="id">[LHS]covarianceE//=</span> <span class="id">?mulrDl</span> <span class="id">?compreDr//</span> <span class="id">?integrableD//</span>.<br/>
<span class="id">rewrite</span> <span class="id">2?expectationD//=</span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#muleDl">muleDl</a></span> <span class="id">?fin_num_adde_defr</span> <span class="id">?expectation_fin_num//</span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#oppeD">oppeD</a></span> <span class="id">?fin_num_adde_defr</span> <span class="id">?fin_numM</span> <span class="id">?expectation_fin_num//</span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#addeACA">addeACA</a></span> <span class="id">2?covarianceE</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="covarianceDr" class="id"><a name="covarianceDr" class="">covarianceDr</a></span> (<span id="X:142" class="id"><a name="X:142" class="">X</a></span> <span id="Y:143" class="id"><a name="Y:143" class="">Y</a></span> <span id="Z:144" class="id"><a name="Z:144" class="">Z</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#31c5002a151d32a5908113f99aedfaa1">{RV</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#31c5002a151d32a5908113f99aedfaa1">&gt;-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.R">R}</a></span>) <span class="id">:</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.ssrfun.html#687e14754dadb7c0b04f27d8f71d2638">\o</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:142">X</a></span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.ssrfun.html#687e14754dadb7c0b04f27d8f71d2638">\o</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#X:142">X</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#663140372ac3b275aae871b74b140513">^+</a></span> <span class="id">2</span>)%<span class="id">R</span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.ssrfun.html#687e14754dadb7c0b04f27d8f71d2638">\o</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#Y:143">Y</a></span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.ssrfun.html#687e14754dadb7c0b04f27d8f71d2638">\o</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#Y:143">Y</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#663140372ac3b275aae871b74b140513">^+</a></span> <span class="id">2</span>)%<span class="id">R</span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.ssrfun.html#687e14754dadb7c0b04f27d8f71d2638">\o</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#Z:144">Z</a></span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.ssrfun.html#687e14754dadb7c0b04f27d8f71d2638">\o</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#Z:144">Z</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#663140372ac3b275aae871b74b140513">^+</a></span> <span class="id">2</span>)%<span class="id">R</span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.ssrfun.html#687e14754dadb7c0b04f27d8f71d2638">\o</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#X:142">X</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#2d0cfb150261028f4ebd2ba355623dcc">*</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#Y:143">Y</a></span>)%<span class="id">R</span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.ssrfun.html#687e14754dadb7c0b04f27d8f71d2638">\o</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#X:142">X</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#2d0cfb150261028f4ebd2ba355623dcc">*</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#Z:144">Z</a></span>)%<span class="id">R</span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#covariance">covariance</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:142">X</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#Y:143">Y</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#d85e5ec1adc01afcee458717bbaea5e5">\+</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#Z:144">Z</a></span>)%<span class="id">R</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance">covariance</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:142">X</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#Y:143">Y</a></span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#d4965da372b2485934ec33867ee5fbe7">+</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance">covariance</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:142">X</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#Z:144">Z</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof30')">Proof.</span></div>
<div class="proofscript" id="proof30">
<span class="id">move=&gt;</span> <span class="id">X1</span> <span class="id">X2</span> <span class="id">Y1</span> <span class="id">Y2</span> <span class="id">Z1</span> <span class="id">Z2</span> <span class="id">XY1</span> <span class="id">XZ1</span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.probability.html#covarianceC">covarianceC</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covarianceDl">covarianceDl</a></span> <span class="id">?</span>(<span class="id"><a href="mathcomp.analysis.probability.html#covarianceC">covarianceC</a></span> <span class="id">X</span>) <span class="id">1?mulrC</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="covarianceBl" class="id"><a name="covarianceBl" class="">covarianceBl</a></span> (<span id="X:145" class="id"><a name="X:145" class="">X</a></span> <span id="Y:146" class="id"><a name="Y:146" class="">Y</a></span> <span id="Z:147" class="id"><a name="Z:147" class="">Z</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#31c5002a151d32a5908113f99aedfaa1">{RV</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#31c5002a151d32a5908113f99aedfaa1">&gt;-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.R">R}</a></span>) <span class="id">:</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.ssrfun.html#687e14754dadb7c0b04f27d8f71d2638">\o</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:145">X</a></span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.ssrfun.html#687e14754dadb7c0b04f27d8f71d2638">\o</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#X:145">X</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#663140372ac3b275aae871b74b140513">^+</a></span> <span class="id">2</span>)%<span class="id">R</span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.ssrfun.html#687e14754dadb7c0b04f27d8f71d2638">\o</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#Y:146">Y</a></span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.ssrfun.html#687e14754dadb7c0b04f27d8f71d2638">\o</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#Y:146">Y</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#663140372ac3b275aae871b74b140513">^+</a></span> <span class="id">2</span>)%<span class="id">R</span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.ssrfun.html#687e14754dadb7c0b04f27d8f71d2638">\o</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#Z:147">Z</a></span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.ssrfun.html#687e14754dadb7c0b04f27d8f71d2638">\o</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#Z:147">Z</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#663140372ac3b275aae871b74b140513">^+</a></span> <span class="id">2</span>)%<span class="id">R</span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.ssrfun.html#687e14754dadb7c0b04f27d8f71d2638">\o</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#X:145">X</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#2d0cfb150261028f4ebd2ba355623dcc">*</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#Z:147">Z</a></span>)%<span class="id">R</span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.ssrfun.html#687e14754dadb7c0b04f27d8f71d2638">\o</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#Y:146">Y</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#2d0cfb150261028f4ebd2ba355623dcc">*</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#Z:147">Z</a></span>)%<span class="id">R</span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#covariance">covariance</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#X:145">X</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#0bb5d11fe8761db1e6494d75cb45a3cb">\-</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#Y:146">Y</a></span>)%<span class="id">R</span> <span class="id"><a href="mathcomp.analysis.probability.html#Z:147">Z</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance">covariance</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:145">X</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#Z:147">Z</a></span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#::ereal_scope:x_'-'_x">-</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance">covariance</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#Y:146">Y</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#Z:147">Z</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof31')">Proof.</span></div>
<div class="proofscript" id="proof31">
<span class="id">move=&gt;</span> <span class="id">X1</span> <span class="id">X2</span> <span class="id">Y1</span> <span class="id">Y2</span> <span class="id">Z1</span> <span class="id">Z2</span> <span class="id">XZ1</span> <span class="id">YZ1</span>.<br/>
<span class="id">rewrite</span> <span class="id">-[</span>(<span class="id">X</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#0bb5d11fe8761db1e6494d75cb45a3cb">\-</a></span> <span class="id">Y</span>)%<span class="id">R]/</span>(<span class="id">X</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#d85e5ec1adc01afcee458717bbaea5e5">\+</a></span> (<span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#565ca4aa0f5062a899cb0ce9091bd2da">\-</a></span> <span class="id">Y</span>))%<span class="id">R</span> <span class="id"><a href="mathcomp.analysis.probability.html#covarianceDl">covarianceDl</a></span> <span class="id">?covarianceNl//=</span>.<br/>
<span class="id">-</span> <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.ereal.html#compreN">compreN//</a></span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#integrableN">integrableN</a></span>.<br/>
<span class="id">-</span> <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#GRing.Theory.mulrNN">mulrNN</a></span>.<br/>
<span class="id">-</span> <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#GRing.Theory.mulNr">mulNr</a></span> <span class="id"><a href="mathcomp.analysis.ereal.html#compreN">compreN//</a></span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#integrableN">integrableN</a></span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="covarianceBr" class="id"><a name="covarianceBr" class="">covarianceBr</a></span> (<span id="X:148" class="id"><a name="X:148" class="">X</a></span> <span id="Y:149" class="id"><a name="Y:149" class="">Y</a></span> <span id="Z:150" class="id"><a name="Z:150" class="">Z</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#31c5002a151d32a5908113f99aedfaa1">{RV</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#31c5002a151d32a5908113f99aedfaa1">&gt;-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.R">R}</a></span>) <span class="id">:</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.ssrfun.html#687e14754dadb7c0b04f27d8f71d2638">\o</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:148">X</a></span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.ssrfun.html#687e14754dadb7c0b04f27d8f71d2638">\o</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#X:148">X</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#663140372ac3b275aae871b74b140513">^+</a></span> <span class="id">2</span>)%<span class="id">R</span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.ssrfun.html#687e14754dadb7c0b04f27d8f71d2638">\o</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#Y:149">Y</a></span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.ssrfun.html#687e14754dadb7c0b04f27d8f71d2638">\o</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#Y:149">Y</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#663140372ac3b275aae871b74b140513">^+</a></span> <span class="id">2</span>)%<span class="id">R</span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.ssrfun.html#687e14754dadb7c0b04f27d8f71d2638">\o</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#Z:150">Z</a></span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.ssrfun.html#687e14754dadb7c0b04f27d8f71d2638">\o</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#Z:150">Z</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#663140372ac3b275aae871b74b140513">^+</a></span> <span class="id">2</span>)%<span class="id">R</span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.ssrfun.html#687e14754dadb7c0b04f27d8f71d2638">\o</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#X:148">X</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#2d0cfb150261028f4ebd2ba355623dcc">*</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#Y:149">Y</a></span>)%<span class="id">R</span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.ssrfun.html#687e14754dadb7c0b04f27d8f71d2638">\o</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#X:148">X</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#2d0cfb150261028f4ebd2ba355623dcc">*</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#Z:150">Z</a></span>)%<span class="id">R</span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#covariance">covariance</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:148">X</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#Y:149">Y</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#0bb5d11fe8761db1e6494d75cb45a3cb">\-</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#Z:150">Z</a></span>)%<span class="id">R</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance">covariance</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:148">X</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#Y:149">Y</a></span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#::ereal_scope:x_'-'_x">-</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance">covariance</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:148">X</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#Z:150">Z</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof32')">Proof.</span></div>
<div class="proofscript" id="proof32">
<span class="id">move=&gt;</span> <span class="id">X1</span> <span class="id">X2</span> <span class="id">Y1</span> <span class="id">Y2</span> <span class="id">Z1</span> <span class="id">Z2</span> <span class="id">XY1</span> <span class="id">XZ1</span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">!</span>(<span class="id"><a href="mathcomp.analysis.probability.html#covarianceC">covarianceC</a></span> <span class="id">X</span>) <span class="id"><a href="mathcomp.analysis.probability.html#covarianceBl">covarianceBl</a></span> <span class="id">1?</span>(<span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#GRing.Theory.mulrC">mulrC</a></span> <span class="id">_</span> <span class="id">X</span>).<br/>
Qed.</div>
<br/>
<span class="vernacular">End</span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas">covariance_lemmas</a></span>.<br/>
<br/>
<span class="vernacular">Section</span> <span id="variance" class="id"><a name="variance" class="">variance</a></span>.<br/>
<span class="vernacular">Local</span> <span class="vernacular">Open</span> <span class="vernacular">Scope</span> <span class="id">ereal_scope</span>.<br/>
<span class="vernacular">Context</span> <span id="d:151" class="id"><a name="d:151" class="">d</a></span> (<span id="T:152" class="id"><a name="T:152" class="">T</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.measure.html#Measurable.Exports.measurableType">measurableType</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#d:151">d</a></span>) (<span id="R:153" class="id"><a name="R:153" class="">R</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.reals.html#Real.Exports.realType">realType</a></span>) (<span id="P:154" class="id"><a name="P:154" class="">P</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.measure.html#Probability.Exports.probability">probability</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#T:152">T</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#R:153">R</a></span>).<br/>
<br/>
<span class="vernacular">Definition</span> <span id="variance" class="id"><a name="variance" class="">variance</a></span> (<span id="X:155" class="id"><a name="X:155" class="">X</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#variance.T">T</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#variance.R">R</a></span>) <span class="id">:=</span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance">covariance</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#variance.P">P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:155">X</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:155">X</a></span>.<br/>
<span class="vernacular">Local</span> <span class="vernacular">Notation</span> <span id="de9eec9fd477bbbff8d31b0d161e82f0" class="id"><a name="de9eec9fd477bbbff8d31b0d161e82f0" class="">&quot;''V_' P [ X ]&quot;</a></span> <span class="id">:=</span> (<span class="id"><a href="mathcomp.analysis.probability.html#variance">variance</a></span> <span class="id">X</span>).<br/>
<br/>
<span class="vernacular">Lemma</span> <span id="varianceE" class="id"><a name="varianceE" class="">varianceE</a></span> (<span id="X:156" class="id"><a name="X:156" class="">X</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#31c5002a151d32a5908113f99aedfaa1">{RV</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#variance.P">P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#31c5002a151d32a5908113f99aedfaa1">&gt;-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#variance.R">R}</a></span>) <span class="id">:</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#variance.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.ssrfun.html#687e14754dadb7c0b04f27d8f71d2638">\o</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:156">X</a></span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#variance.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.ssrfun.html#687e14754dadb7c0b04f27d8f71d2638">\o</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#X:156">X</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#663140372ac3b275aae871b74b140513">^+</a></span> <span class="id">2</span>)%<span class="id">R</span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#de9eec9fd477bbbff8d31b0d161e82f0">'V_P[X]</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#69ec4e730a589c79df0349357bb8311f">'E_P[X</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#663140372ac3b275aae871b74b140513">^+</a></span> <span class="id">2]</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#::ereal_scope:x_'-'_x">-</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#69ec4e730a589c79df0349357bb8311f">'E_P[X]</a></span>) <span class="id">^+</span> <span class="id">2</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof33')">Proof.</span></div>
<div class="proofscript" id="proof33">
 <span class="gallina-kwd">by</span> <span class="id">move=&gt;</span> <span class="id">X1</span> <span class="id">X2;</span> <span class="id">rewrite</span> <span class="id">/variance</span> <span class="id"><a href="mathcomp.analysis.probability.html#covarianceE">covarianceE</a></span>. Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="variance_fin_num" class="id"><a name="variance_fin_num" class="">variance_fin_num</a></span> (<span id="X:157" class="id"><a name="X:157" class="">X</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#31c5002a151d32a5908113f99aedfaa1">{RV</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#variance.P">P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#31c5002a151d32a5908113f99aedfaa1">&gt;-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#variance.R">R}</a></span>) <span class="id">:</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#variance.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.ssrfun.html#687e14754dadb7c0b04f27d8f71d2638">\o</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:157">X</a></span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#variance.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.ssrfun.html#687e14754dadb7c0b04f27d8f71d2638">\o</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:157">X</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#663140372ac3b275aae871b74b140513">^+</a></span> <span class="id">2</span>)%<span class="id">R</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#de9eec9fd477bbbff8d31b0d161e82f0">'V_P[X]</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#f6c65697fefaf4504de1d4d641cd4409">\is</a></span> <span class="id">a</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#fin_num">fin_num</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof34')">Proof.</span></div>
<div class="proofscript" id="proof34">
 <span class="gallina-kwd">by</span> <span class="id">move=&gt;</span> <span class="id">/[dup];</span> <span class="id">apply:</span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance_fin_num">covariance_fin_num</a></span>. Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="variance_ge0" class="id"><a name="variance_ge0" class="">variance_ge0</a></span> (<span id="X:158" class="id"><a name="X:158" class="">X</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#31c5002a151d32a5908113f99aedfaa1">{RV</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#variance.P">P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#31c5002a151d32a5908113f99aedfaa1">&gt;-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#variance.R">R}</a></span>) <span class="id">:</span> (<span class="id">0</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#63b01a542aec2e4c61e028256cf5a548">&lt;=</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#de9eec9fd477bbbff8d31b0d161e82f0">'V_P[X]</a></span>)%<span class="id">E</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof35')">Proof.</span></div>
<div class="proofscript" id="proof35">
<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">/variance</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssreflect.html#unlock">unlock;</a></span> <span class="id">apply:</span> <span class="id"><a href="mathcomp.analysis.probability.html#expectation_ge0">expectation_ge0</a></span> <span class="id">=&gt;</span> <span class="id">x;</span> <span class="id">apply:</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssrnum.html#Num.Theory.sqr_ge0">sqr_ge0</a></span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="variance_cst" class="id"><a name="variance_cst" class="">variance_cst</a></span> <span id="r:159" class="id"><a name="r:159" class="">r</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#de9eec9fd477bbbff8d31b0d161e82f0">'V_P[cst</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#r:159">r]</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id">0</span>%<span class="id">E</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof36')">Proof.</span></div>
<div class="proofscript" id="proof36">
<span class="id">rewrite</span> <span class="id">/variance</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssreflect.html#unlock">unlock</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#expectation_cst">expectation_cst/=</a></span>.<br/>
<span class="id">rewrite</span> <span class="id">[X</span> <span class="gallina-kwd">in</span> <span class="id"><a href="mathcomp.analysis.probability.html#69ec4e730a589c79df0349357bb8311f">'E_P[X]]</a></span>(<span class="id">_</span> <span class="id">:</span> <span class="id">_</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="mathcomp.classical.functions.html#cst">cst</a></span> <span class="id">0</span>%<span class="id">R</span>) <span class="id">?expectation_cst//</span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">apply/funext</span> <span class="id">=&gt;</span> <span class="id">x;</span> <span class="id">rewrite</span> <span class="id">/GRing</span>.<span class="id">exp/GRing</span>.<span class="id">mul/=</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#GRing.Theory.subrr">subrr</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#GRing.Theory.mulr0">mulr0</a></span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="varianceZ" class="id"><a name="varianceZ" class="">varianceZ</a></span> <span id="a:161" class="id"><a name="a:161" class="">a</a></span> (<span id="X:162" class="id"><a name="X:162" class="">X</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#31c5002a151d32a5908113f99aedfaa1">{RV</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#variance.P">P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#31c5002a151d32a5908113f99aedfaa1">&gt;-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#variance.R">R}</a></span>) <span class="id">:</span><br/>
&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#variance.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.ssrfun.html#687e14754dadb7c0b04f27d8f71d2638">\o</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:162">X</a></span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#variance.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.ssrfun.html#687e14754dadb7c0b04f27d8f71d2638">\o</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#X:162">X</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#663140372ac3b275aae871b74b140513">^+</a></span> <span class="id">2</span>)%<span class="id">R</span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#de9eec9fd477bbbff8d31b0d161e82f0">'V_P[</a></span>(<span class="id"><a href="mathcomp.analysis.probability.html#a:161">a</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#5e03abe1c4aaadd0b39b8ab0cf62f35b">\o*</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:162">X</a></span>)%<span class="id">R]</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#a:161">a</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#663140372ac3b275aae871b74b140513">^+</a></span> <span class="id">2</span>)%<span class="id">:E</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#f1c2ddfea282f8f8d7539f61e14c08e4">*</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#de9eec9fd477bbbff8d31b0d161e82f0">'V_P[X]</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof37')">Proof.</span></div>
<div class="proofscript" id="proof37">
<span class="id">move=&gt;</span> <span class="id">X1</span> <span class="id">X2;</span> <span class="id">rewrite</span> <span class="id">/variance</span> <span class="id"><a href="mathcomp.analysis.probability.html#covarianceZl">covarianceZl//=</a></span>.<br/>
<span class="id">-</span> <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.probability.html#covarianceZr">covarianceZr//</a></span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#muleA">muleA</a></span>.<br/>
<span class="id">-</span> <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.ereal.html#compre_scale">compre_scale//</a></span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#integrableZl">integrableZl</a></span>.<br/>
<span class="id">-</span> <span class="id">rewrite</span> <span class="id">[X</span> <span class="gallina-kwd">in</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.ssrfun.html#687e14754dadb7c0b04f27d8f71d2638">\o</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:163">X]</a></span>(<span class="id">_</span> <span class="id">:</span> <span class="id">_</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> (<span class="id">a</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#5e03abe1c4aaadd0b39b8ab0cf62f35b">\o*</a></span> <span class="id">X</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#663140372ac3b275aae871b74b140513">^+</a></span> <span class="id">2</span>)%<span class="id">R</span>)<span class="id">;</span> <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">apply/funeqP</span> <span class="id">=&gt;</span> <span class="id">x;</span> <span class="id">rewrite</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#GRing.Theory.mulrA">mulrA</a></span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.ereal.html#compre_scale">compre_scale//</a></span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#integrableZl">integrableZl</a></span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="varianceN" class="id"><a name="varianceN" class="">varianceN</a></span> (<span id="X:164" class="id"><a name="X:164" class="">X</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#31c5002a151d32a5908113f99aedfaa1">{RV</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#variance.P">P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#31c5002a151d32a5908113f99aedfaa1">&gt;-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#variance.R">R}</a></span>) <span class="id">:</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#variance.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.ssrfun.html#687e14754dadb7c0b04f27d8f71d2638">\o</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:164">X</a></span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#variance.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.ssrfun.html#687e14754dadb7c0b04f27d8f71d2638">\o</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#X:164">X</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#663140372ac3b275aae871b74b140513">^+</a></span> <span class="id">2</span>)%<span class="id">R</span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#de9eec9fd477bbbff8d31b0d161e82f0">'V_P[</a></span>(<span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#565ca4aa0f5062a899cb0ce9091bd2da">\-</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:164">X</a></span>)%<span class="id">R]</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#de9eec9fd477bbbff8d31b0d161e82f0">'V_P[X]</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof38')">Proof.</span></div>
<div class="proofscript" id="proof38">
 <span class="gallina-kwd">by</span> <span class="id">move=&gt;</span> <span class="id">X1</span> <span class="id">X2;</span> <span class="id">rewrite</span> <span class="id">/variance</span> <span class="id"><a href="mathcomp.analysis.probability.html#covarianceNN">covarianceNN</a></span>. Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="varianceD" class="id"><a name="varianceD" class="">varianceD</a></span> (<span id="X:165" class="id"><a name="X:165" class="">X</a></span> <span id="Y:166" class="id"><a name="Y:166" class="">Y</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#31c5002a151d32a5908113f99aedfaa1">{RV</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#variance.P">P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#31c5002a151d32a5908113f99aedfaa1">&gt;-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#variance.R">R}</a></span>) <span class="id">:</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#variance.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.ssrfun.html#687e14754dadb7c0b04f27d8f71d2638">\o</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:165">X</a></span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#variance.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.ssrfun.html#687e14754dadb7c0b04f27d8f71d2638">\o</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#X:165">X</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#663140372ac3b275aae871b74b140513">^+</a></span> <span class="id">2</span>)%<span class="id">R</span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#variance.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.ssrfun.html#687e14754dadb7c0b04f27d8f71d2638">\o</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#Y:166">Y</a></span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#variance.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.ssrfun.html#687e14754dadb7c0b04f27d8f71d2638">\o</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#Y:166">Y</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#663140372ac3b275aae871b74b140513">^+</a></span> <span class="id">2</span>)%<span class="id">R</span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#variance.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.ssrfun.html#687e14754dadb7c0b04f27d8f71d2638">\o</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#X:165">X</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#2d0cfb150261028f4ebd2ba355623dcc">*</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#Y:166">Y</a></span>)%<span class="id">R</span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#de9eec9fd477bbbff8d31b0d161e82f0">'V_P[X</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#d85e5ec1adc01afcee458717bbaea5e5">\+</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#Y:166">Y]</a></span>%<span class="id">R</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#de9eec9fd477bbbff8d31b0d161e82f0">'V_P[X]</a></span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#d4965da372b2485934ec33867ee5fbe7">+</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#de9eec9fd477bbbff8d31b0d161e82f0">'V_P[Y]</a></span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#d4965da372b2485934ec33867ee5fbe7">+</a></span> <span class="id">2</span>%<span class="id">:E</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#f1c2ddfea282f8f8d7539f61e14c08e4">*</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance">covariance</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#variance.P">P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:165">X</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#Y:166">Y</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof39')">Proof.</span></div>
<div class="proofscript" id="proof39">
<span class="id">move=&gt;</span> <span class="id">X1</span> <span class="id">X2</span> <span class="id">Y1</span> <span class="id">Y2</span> <span class="id">XY1</span>.<br/>
<span class="id">rewrite</span> <span class="id">-['V_P[_]]/</span>(<span class="id"><a href="mathcomp.analysis.probability.html#covariance">covariance</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#variance.P">P</a></span> (<span class="id">X</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#d85e5ec1adc01afcee458717bbaea5e5">\+</a></span> <span class="id">Y</span>)%<span class="id">R</span> (<span class="id">X</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#d85e5ec1adc01afcee458717bbaea5e5">\+</a></span> <span class="id">Y</span>)%<span class="id">R</span>).<br/>
<span class="id">have</span> <span class="id">XY</span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#variance.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#36b9f1631384d2c3b944cb9d5855cd98">[set:</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#variance.T">T]</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.ssrfun.html#687e14754dadb7c0b04f27d8f71d2638">\o</a></span> (<span class="id">X</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#d85e5ec1adc01afcee458717bbaea5e5">\+</a></span> <span class="id">Y</span>)%<span class="id">R</span>).<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.ereal.html#compreDr">compreDr//</a></span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#integrableD">integrableD</a></span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.probability.html#covarianceDl">covarianceDl//=;</a></span> <span class="id">last</span> <span class="id">3</span> <span class="id">first</span>.<br/>
<span class="id">-</span> <span class="id">rewrite</span> <span class="id">-expr2</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#GRing.Theory.sqrrD">sqrrD</a></span> <span class="id"><a href="mathcomp.analysis.ereal.html#compreDr">compreDr</a></span> <span class="id">?integrableD//</span> <span class="id"><a href="mathcomp.analysis.ereal.html#compreDr">compreDr//</a></span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#integrableD">integrableD//</a></span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">-mulr_natr</span> <span class="id">-[</span>(<span class="id">_</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#2d0cfb150261028f4ebd2ba355623dcc">*</a></span> <span class="id">2</span>)%<span class="id">R]/</span>(<span class="id">2</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#5e03abe1c4aaadd0b39b8ab0cf62f35b">\o*</a></span> (<span class="id">X</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#2d0cfb150261028f4ebd2ba355623dcc">*</a></span> <span class="id">Y</span>))%<span class="id">R</span> <span class="id"><a href="mathcomp.analysis.ereal.html#compre_scale">compre_scale//</a></span>.<br/>
&nbsp;&nbsp;<span class="id">exact:</span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#integrableZl">integrableZl</a></span>.<br/>
<span class="id">-</span> <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#GRing.Theory.mulrDr">mulrDr</a></span> <span class="id"><a href="mathcomp.analysis.ereal.html#compreDr">compreDr</a></span> <span class="id">?integrableD</span>.<br/>
<span class="id">-</span> <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#GRing.Theory.mulrDr">mulrDr</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#GRing.Theory.mulrC">mulrC</a></span> <span class="id"><a href="mathcomp.analysis.ereal.html#compreDr">compreDr</a></span> <span class="id">?integrableD</span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.probability.html#covarianceDr">covarianceDr//</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covarianceDr">covarianceDr;</a></span> <span class="id">[|by</span> <span class="id">[]</span>..<span class="id">|by</span> <span class="id">rewrite</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#GRing.Theory.mulrC">mulrC</a></span> <span class="id">|exact:</span> <span class="id">Y2]</span>.<br/>
<span class="id">rewrite</span> (<span class="id"><a href="mathcomp.analysis.probability.html#covarianceC">covarianceC</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#variance.P">P</a></span> <span class="id">Y</span> <span class="id">X</span>) <span class="id">[LHS]addeA</span> <span class="id">[LHS]</span>(<span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.ssrAC.html#ACl">ACl</a></span> (<span class="id">1*4*</span>(<span class="id">2*3</span>)))<span class="id">/=</span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">-[2</span>%<span class="id">R]/</span>(<span class="id">1</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#c7f78cf1f6a5e4f664654f7d671ca752">+</a></span> <span class="id">1</span>)%<span class="id">R</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFinD">EFinD</a></span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#muleDl">muleDl</a></span> <span class="id">?mul1e//</span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance_fin_num">covariance_fin_num</a></span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="varianceB" class="id"><a name="varianceB" class="">varianceB</a></span> (<span id="X:167" class="id"><a name="X:167" class="">X</a></span> <span id="Y:168" class="id"><a name="Y:168" class="">Y</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#31c5002a151d32a5908113f99aedfaa1">{RV</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#variance.P">P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#31c5002a151d32a5908113f99aedfaa1">&gt;-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#variance.R">R}</a></span>) <span class="id">:</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#variance.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.ssrfun.html#687e14754dadb7c0b04f27d8f71d2638">\o</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:167">X</a></span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#variance.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.ssrfun.html#687e14754dadb7c0b04f27d8f71d2638">\o</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#X:167">X</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#663140372ac3b275aae871b74b140513">^+</a></span> <span class="id">2</span>)%<span class="id">R</span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#variance.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.ssrfun.html#687e14754dadb7c0b04f27d8f71d2638">\o</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#Y:168">Y</a></span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#variance.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.ssrfun.html#687e14754dadb7c0b04f27d8f71d2638">\o</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#Y:168">Y</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#663140372ac3b275aae871b74b140513">^+</a></span> <span class="id">2</span>)%<span class="id">R</span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#variance.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.ssrfun.html#687e14754dadb7c0b04f27d8f71d2638">\o</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#X:167">X</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#2d0cfb150261028f4ebd2ba355623dcc">*</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#Y:168">Y</a></span>)%<span class="id">R</span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#de9eec9fd477bbbff8d31b0d161e82f0">'V_P[</a></span>(<span class="id"><a href="mathcomp.analysis.probability.html#X:167">X</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#0bb5d11fe8761db1e6494d75cb45a3cb">\-</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#Y:168">Y</a></span>)%<span class="id">R]</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#de9eec9fd477bbbff8d31b0d161e82f0">'V_P[X]</a></span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#d4965da372b2485934ec33867ee5fbe7">+</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#de9eec9fd477bbbff8d31b0d161e82f0">'V_P[Y]</a></span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#::ereal_scope:x_'-'_x">-</a></span> <span class="id">2</span>%<span class="id">:E</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#f1c2ddfea282f8f8d7539f61e14c08e4">*</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance">covariance</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#variance.P">P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:167">X</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#Y:168">Y</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof40')">Proof.</span></div>
<div class="proofscript" id="proof40">
<span class="id">move=&gt;</span> <span class="id">X1</span> <span class="id">X2</span> <span class="id">Y1</span> <span class="id">Y2</span> <span class="id">XY1</span>.<br/>
<span class="id">rewrite</span> <span class="id">-[</span>(<span class="id">X</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#0bb5d11fe8761db1e6494d75cb45a3cb">\-</a></span> <span class="id">Y</span>)%<span class="id">R]/</span>(<span class="id">X</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#d85e5ec1adc01afcee458717bbaea5e5">\+</a></span> (<span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#565ca4aa0f5062a899cb0ce9091bd2da">\-</a></span> <span class="id">Y</span>))%<span class="id">R</span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.probability.html#varianceD">varianceD/=</a></span> <span class="id">?varianceN</span> <span class="id">?covarianceNr</span> <span class="id">?muleN//</span>.<br/>
<span class="id">-</span> <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.ereal.html#compreN">compreN</a></span> <span class="id">?integrableN</span>.<br/>
<span class="id">-</span> <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#GRing.Theory.mulrNN">mulrNN</a></span>.<br/>
<span class="id">-</span> <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#GRing.Theory.mulrN">mulrN</a></span> <span class="id"><a href="mathcomp.analysis.ereal.html#compreN">compreN</a></span> <span class="id">?integrableN</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="varianceD_cst_l" class="id"><a name="varianceD_cst_l" class="">varianceD_cst_l</a></span> <span id="c:169" class="id"><a name="c:169" class="">c</a></span> (<span id="X:170" class="id"><a name="X:170" class="">X</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#31c5002a151d32a5908113f99aedfaa1">{RV</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#variance.P">P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#31c5002a151d32a5908113f99aedfaa1">&gt;-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#variance.R">R}</a></span>) <span class="id">:</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#variance.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.ssrfun.html#687e14754dadb7c0b04f27d8f71d2638">\o</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:170">X</a></span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#variance.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.ssrfun.html#687e14754dadb7c0b04f27d8f71d2638">\o</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#X:170">X</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#663140372ac3b275aae871b74b140513">^+</a></span> <span class="id">2</span>)%<span class="id">R</span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#de9eec9fd477bbbff8d31b0d161e82f0">'V_P[</a></span>(<span class="id"><a href="mathcomp.classical.functions.html#cst">cst</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#c:169">c</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#d85e5ec1adc01afcee458717bbaea5e5">\+</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:170">X</a></span>)%<span class="id">R]</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#de9eec9fd477bbbff8d31b0d161e82f0">'V_P[X]</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof41')">Proof.</span></div>
<div class="proofscript" id="proof41">
<span class="id">move=&gt;</span> <span class="id">X1</span> <span class="id">X2</span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.probability.html#varianceD">varianceD//=;</a></span> <span class="id">last</span> <span class="id">3</span> <span class="id">first</span>.<br/>
<span class="id">-</span> <span class="id">exact:</span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#finite_measure_integrable_cst">finite_measure_integrable_cst</a></span>.<br/>
<span class="id">-</span> <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.ereal.html#compre_scale">compre_scale//</a></span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#integrableZl">integrableZl//</a></span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#finite_measure_integrable_cst">finite_measure_integrable_cst</a></span>.<br/>
<span class="id">-</span> <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#GRing.Theory.mulrC">mulrC</a></span> <span class="id"><a href="mathcomp.analysis.ereal.html#compre_scale">compre_scale</a></span> <span class="id">?integrableZl</span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.probability.html#variance_cst">variance_cst</a></span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#add0e">add0e</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance_cst_l">covariance_cst_l</a></span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#mule0">mule0</a></span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#adde0">adde0</a></span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="varianceD_cst_r" class="id"><a name="varianceD_cst_r" class="">varianceD_cst_r</a></span> (<span id="X:171" class="id"><a name="X:171" class="">X</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#31c5002a151d32a5908113f99aedfaa1">{RV</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#variance.P">P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#31c5002a151d32a5908113f99aedfaa1">&gt;-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#variance.R">R}</a></span>) <span id="c:172" class="id"><a name="c:172" class="">c</a></span> <span class="id">:</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#variance.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.ssrfun.html#687e14754dadb7c0b04f27d8f71d2638">\o</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:171">X</a></span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#variance.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.ssrfun.html#687e14754dadb7c0b04f27d8f71d2638">\o</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#X:171">X</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#663140372ac3b275aae871b74b140513">^+</a></span> <span class="id">2</span>)%<span class="id">R</span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#de9eec9fd477bbbff8d31b0d161e82f0">'V_P[</a></span>(<span class="id"><a href="mathcomp.analysis.probability.html#X:171">X</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#d85e5ec1adc01afcee458717bbaea5e5">\+</a></span> <span class="id"><a href="mathcomp.classical.functions.html#cst">cst</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#c:172">c</a></span>)%<span class="id">R]</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#de9eec9fd477bbbff8d31b0d161e82f0">'V_P[X]</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof42')">Proof.</span></div>
<div class="proofscript" id="proof42">
<span class="id">move=&gt;</span> <span class="id">X1</span> <span class="id">X2</span>.<br/>
<span class="id">have</span> <span class="id">-&gt;</span> <span class="id">:</span> (<span class="id">X</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#d85e5ec1adc01afcee458717bbaea5e5">\+</a></span> <span class="id"><a href="mathcomp.classical.functions.html#cst">cst</a></span> <span class="id">c</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="mathcomp.classical.functions.html#cst">cst</a></span> <span class="id">c</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#d85e5ec1adc01afcee458717bbaea5e5">\+</a></span> <span class="id">X</span>)%<span class="id">R</span> <span class="gallina-kwd">by</span> <span class="id">apply/funeqP</span> <span class="id">=&gt;</span> <span class="id">x</span> <span class="id">/=;</span> <span class="id">rewrite</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#GRing.Theory.addrC">addrC</a></span>.<br/>
<span class="id">exact:</span> <span class="id"><a href="mathcomp.analysis.probability.html#varianceD_cst_l">varianceD_cst_l</a></span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="varianceB_cst_l" class="id"><a name="varianceB_cst_l" class="">varianceB_cst_l</a></span> <span id="c:173" class="id"><a name="c:173" class="">c</a></span> (<span id="X:174" class="id"><a name="X:174" class="">X</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#31c5002a151d32a5908113f99aedfaa1">{RV</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#variance.P">P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#31c5002a151d32a5908113f99aedfaa1">&gt;-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#variance.R">R}</a></span>) <span class="id">:</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#variance.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.ssrfun.html#687e14754dadb7c0b04f27d8f71d2638">\o</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:174">X</a></span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#variance.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.ssrfun.html#687e14754dadb7c0b04f27d8f71d2638">\o</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#X:174">X</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#663140372ac3b275aae871b74b140513">^+</a></span> <span class="id">2</span>)%<span class="id">R</span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#de9eec9fd477bbbff8d31b0d161e82f0">'V_P[</a></span>(<span class="id"><a href="mathcomp.classical.functions.html#cst">cst</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#c:173">c</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#0bb5d11fe8761db1e6494d75cb45a3cb">\-</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:174">X</a></span>)%<span class="id">R]</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#de9eec9fd477bbbff8d31b0d161e82f0">'V_P[X]</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof43')">Proof.</span></div>
<div class="proofscript" id="proof43">
<span class="id">move=&gt;</span> <span class="id">X1</span> <span class="id">X2</span>.<br/>
<span class="id">rewrite</span> <span class="id">-[</span>(<span class="id"><a href="mathcomp.classical.functions.html#cst">cst</a></span> <span class="id">c</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#0bb5d11fe8761db1e6494d75cb45a3cb">\-</a></span> <span class="id">X</span>)%<span class="id">R]/</span>(<span class="id"><a href="mathcomp.classical.functions.html#cst">cst</a></span> <span class="id">c</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#d85e5ec1adc01afcee458717bbaea5e5">\+</a></span> (<span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#565ca4aa0f5062a899cb0ce9091bd2da">\-</a></span> <span class="id">X</span>))%<span class="id">R</span> <span class="id"><a href="mathcomp.analysis.probability.html#varianceD_cst_l">varianceD_cst_l/=;</a></span> <span class="id">last</span> <span class="id">2</span> <span class="id">first</span>.<br/>
<span class="id">-</span> <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.ereal.html#compreN">compreN</a></span> <span class="id">?integrableN</span>.<br/>
<span class="id">-</span> <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#GRing.Theory.mulrNN">mulrNN;</a></span> <span class="id">apply:</span> <span class="id">X2</span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.probability.html#varianceN">varianceN</a></span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="varianceB_cst_r" class="id"><a name="varianceB_cst_r" class="">varianceB_cst_r</a></span> (<span id="X:175" class="id"><a name="X:175" class="">X</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#31c5002a151d32a5908113f99aedfaa1">{RV</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#variance.P">P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#31c5002a151d32a5908113f99aedfaa1">&gt;-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#variance.R">R}</a></span>) <span id="c:176" class="id"><a name="c:176" class="">c</a></span> <span class="id">:</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#variance.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.ssrfun.html#687e14754dadb7c0b04f27d8f71d2638">\o</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:175">X</a></span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#variance.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.ssrfun.html#687e14754dadb7c0b04f27d8f71d2638">\o</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#X:175">X</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#663140372ac3b275aae871b74b140513">^+</a></span> <span class="id">2</span>)%<span class="id">R</span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#de9eec9fd477bbbff8d31b0d161e82f0">'V_P[</a></span>(<span class="id"><a href="mathcomp.analysis.probability.html#X:175">X</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#0bb5d11fe8761db1e6494d75cb45a3cb">\-</a></span> <span class="id"><a href="mathcomp.classical.functions.html#cst">cst</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#c:176">c</a></span>)%<span class="id">R]</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#de9eec9fd477bbbff8d31b0d161e82f0">'V_P[X]</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof44')">Proof.</span></div>
<div class="proofscript" id="proof44">
<span class="gallina-kwd">by</span> <span class="id">move=&gt;</span> <span class="id">X1</span> <span class="id">X2;</span> <span class="id">rewrite</span> <span class="id">-[</span>(<span class="id">X</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#0bb5d11fe8761db1e6494d75cb45a3cb">\-</a></span> <span class="id"><a href="mathcomp.classical.functions.html#cst">cst</a></span> <span class="id">c</span>)%<span class="id">R]/</span>(<span class="id">X</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#d85e5ec1adc01afcee458717bbaea5e5">\+</a></span> (<span class="id"><a href="mathcomp.classical.functions.html#cst">cst</a></span> (<span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#::ring_scope:'-'_x">-</a></span> <span class="id">c</span>)))%<span class="id">R</span> <span class="id"><a href="mathcomp.analysis.probability.html#varianceD_cst_r">varianceD_cst_r</a></span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="covariance_le" class="id"><a name="covariance_le" class="">covariance_le</a></span> (<span id="X:177" class="id"><a name="X:177" class="">X</a></span> <span id="Y:178" class="id"><a name="Y:178" class="">Y</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#31c5002a151d32a5908113f99aedfaa1">{RV</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#variance.P">P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#31c5002a151d32a5908113f99aedfaa1">&gt;-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#variance.R">R}</a></span>) <span class="id">:</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#variance.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.ssrfun.html#687e14754dadb7c0b04f27d8f71d2638">\o</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:177">X</a></span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#variance.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.ssrfun.html#687e14754dadb7c0b04f27d8f71d2638">\o</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#X:177">X</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#663140372ac3b275aae871b74b140513">^+</a></span> <span class="id">2</span>)%<span class="id">R</span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#variance.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.ssrfun.html#687e14754dadb7c0b04f27d8f71d2638">\o</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#Y:178">Y</a></span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#variance.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.ssrfun.html#687e14754dadb7c0b04f27d8f71d2638">\o</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#Y:178">Y</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#663140372ac3b275aae871b74b140513">^+</a></span> <span class="id">2</span>)%<span class="id">R</span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#variance.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.ssrfun.html#687e14754dadb7c0b04f27d8f71d2638">\o</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#X:177">X</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#2d0cfb150261028f4ebd2ba355623dcc">*</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#Y:178">Y</a></span>)%<span class="id">R</span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#covariance">covariance</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#variance.P">P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:177">X</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#Y:178">Y</a></span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#63b01a542aec2e4c61e028256cf5a548">&lt;=</a></span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#sqrte">sqrte</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#de9eec9fd477bbbff8d31b0d161e82f0">'V_P[X]</a></span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#f1c2ddfea282f8f8d7539f61e14c08e4">*</a></span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#sqrte">sqrte</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#de9eec9fd477bbbff8d31b0d161e82f0">'V_P[Y]</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof45')">Proof.</span></div>
<div class="proofscript" id="proof45">
<span class="id">move=&gt;</span> <span class="id">X1</span> <span class="id">X2</span> <span class="id">Y1</span> <span class="id">Y2</span> <span class="id">XY1</span>.<br/>
<span class="id">rewrite</span> <span class="id">-sqrteM</span> <span class="id">?variance_ge0//</span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#lee_sqrE">lee_sqrE</a></span> <span class="id">?sqrte_ge0//</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#sqr_sqrte">sqr_sqrte</a></span> <span class="id">?mule_ge0</span> <span class="id">?variance_ge0//</span>.<br/>
<span class="id">rewrite</span> <span class="id">-</span>(<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#fineK">fineK</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#variance_fin_num">variance_fin_num</a></span> <span class="id">X1</span> <span class="id">X2</span>)) <span class="id">-</span>(<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#fineK">fineK</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#variance_fin_num">variance_fin_num</a></span> <span class="id">Y1</span> <span class="id">Y2</span>)).<br/>
<span class="id">rewrite</span> <span class="id">-</span>(<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#fineK">fineK</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#covariance_fin_num">covariance_fin_num</a></span> <span class="id">X1</span> <span class="id">Y1</span> <span class="id">XY1</span>)).<br/>
<span class="id">rewrite</span> <span class="id">-EFin_expe</span> <span class="id">-EFinM</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#lee_fin">lee_fin</a></span> <span class="id">-</span>(@<span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssrnum.html#Num.Theory.ler_pM2l">ler_pM2l</a></span> <span class="id">_</span> <span class="id">4</span>) <span class="id">?ltr0n//</span> <span class="id">[leRHS]mulrA</span>.<br/>
<span class="id">rewrite</span> <span class="id">[in</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.order.html#Order.POSyntax.leLHS">leLHS]</a></span>(<span class="id">_</span> <span class="id">:</span> <span class="id">4</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id">2</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#2d0cfb150261028f4ebd2ba355623dcc">*</a></span> <span class="id">2</span>)%<span class="id">R</span> <span class="id">-natrM//</span> <span class="id">[in</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.order.html#Order.POSyntax.leLHS">leLHS]natrM</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#GRing.Theory.mulrACA">mulrACA</a></span> <span class="id">-expr2</span>.<br/>
<span class="id">rewrite</span> <span class="id">-subr_le0;</span> <span class="id">apply:</span> <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#deg_le2_ge0">deg_le2_ge0</a></span> <span class="id">=&gt;</span> <span class="id">r;</span> <span class="id">rewrite</span> <span class="id">-lee_fin</span> <span class="id">!EFinD</span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFinM">EFinM</a></span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#fineK">fineK</a></span> <span class="id">?variance_fin_num//</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#muleC">muleC</a></span> <span class="id">-varianceZ//</span>.<br/>
<span class="id">rewrite</span> <span class="id">2!EFinM</span> <span class="id">?fineK</span> <span class="id">?variance_fin_num//</span> <span class="id">?covariance_fin_num//</span>.<br/>
<span class="id">rewrite</span> <span class="id">-muleA</span> <span class="id">[_</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#f1c2ddfea282f8f8d7539f61e14c08e4">*</a></span> <span class="id">r</span>%<span class="id">:E]muleC</span> <span class="id">-covarianceZl//</span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#addeAC">addeAC</a></span> <span class="id">-varianceD</span> <span class="id">?variance_ge0//=</span>.<br/>
<span class="id">-</span> <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.ereal.html#compre_scale">compre_scale</a></span> <span class="id">?integrableZl</span>.<br/>
<span class="id">-</span> <span class="id">rewrite</span> <span class="id">[X</span> <span class="gallina-kwd">in</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.ssrfun.html#687e14754dadb7c0b04f27d8f71d2638">\o</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:179">X]</a></span>(<span class="id">_</span> <span class="id">:</span> <span class="id">_</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id">r</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#663140372ac3b275aae871b74b140513">^+2</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#5e03abe1c4aaadd0b39b8ab0cf62f35b">\o*</a></span> <span class="id">X</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#663140372ac3b275aae871b74b140513">^+</a></span> <span class="id">2</span>)%<span class="id">R</span> <span class="id">1?mulrACA//</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.ereal.html#compre_scale">compre_scale</a></span> <span class="id">?integrableZl</span>.<br/>
<span class="id">-</span> <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">-mulrAC</span> <span class="id"><a href="mathcomp.analysis.ereal.html#compre_scale">compre_scale//</a></span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#integrableZl">integrableZl</a></span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">End</span> <span class="id"><a href="mathcomp.analysis.probability.html#variance">variance</a></span>.<br/>
<span class="vernacular">Notation</span> <span id="9e50536fce9e14b365e2c78395616442" class="id"><a name="9e50536fce9e14b365e2c78395616442" class="">&quot;'V_ P [ X ]&quot;</a></span> <span class="id">:=</span> (<span class="id"><a href="mathcomp.analysis.probability.html#variance">variance</a></span> <span class="id">P</span> <span class="id">X</span>).<br/>
<br/>
<span class="vernacular">Section</span> <span id="markov_chebyshev_cantelli" class="id"><a name="markov_chebyshev_cantelli" class="">markov_chebyshev_cantelli</a></span>.<br/>
<span class="vernacular">Local</span> <span class="vernacular">Open</span> <span class="vernacular">Scope</span> <span class="id">ereal_scope</span>.<br/>
<span class="vernacular">Context</span> <span id="d:180" class="id"><a name="d:180" class="">d</a></span> (<span id="T:181" class="id"><a name="T:181" class="">T</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.measure.html#Measurable.Exports.measurableType">measurableType</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#d:180">d</a></span>) (<span id="R:182" class="id"><a name="R:182" class="">R</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.reals.html#Real.Exports.realType">realType</a></span>) (<span id="P:183" class="id"><a name="P:183" class="">P</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.measure.html#Probability.Exports.probability">probability</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#T:181">T</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#R:182">R</a></span>).<br/>
<br/>
<span class="vernacular">Lemma</span> <span id="markov" class="id"><a name="markov" class="">markov</a></span> (<span id="X:184" class="id"><a name="X:184" class="">X</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#31c5002a151d32a5908113f99aedfaa1">{RV</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#markov_chebyshev_cantelli.P">P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#31c5002a151d32a5908113f99aedfaa1">&gt;-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#markov_chebyshev_cantelli.R">R}</a></span>) (<span id="f:185" class="id"><a name="f:185" class="">f</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#markov_chebyshev_cantelli.R">R</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#markov_chebyshev_cantelli.R">R</a></span>) (<span id="eps:186" class="id"><a name="eps:186" class="">eps</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#markov_chebyshev_cantelli.R">R</a></span>) <span class="id">:</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">0</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssrnum.html#Num.Syntax.::ring_scope:x_'&lt;'_x">&lt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#eps:186">eps</a></span>)%<span class="id">R</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.measure.html#measurable_fun">measurable_fun</a></span> <span class="id"><a href="mathcomp.classical.classical_sets.html#36b9f1631384d2c3b944cb9d5855cd98">[set:</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#markov_chebyshev_cantelli.R">R]</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#f:185">f</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> (<span class="gallina-kwd">forall</span> <span id="r:187" class="id"><a name="r:187" class="">r,</a></span> <span class="id">0</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssrnum.html#cb42ec59ad57b25928e1718b4e69e031">&lt;=</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#r:187">r</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id">0</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssrnum.html#cb42ec59ad57b25928e1718b4e69e031">&lt;=</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#f:185">f</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#r:187">r</a></span>)%<span class="id">R</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#b4f176550f5b849a7fbba2ee164934d3">{in</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssrnum.html#Num.nneg">Num.nneg</a></span> &amp;<span class="id">,</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#a5aeb8c3f096bffee5d65fb0b6810e02">{homo</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#f:185">f</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#a5aeb8c3f096bffee5d65fb0b6810e02">:</a></span> <span id="x:190" class="id"><span id="x:188" class="id"><a name="x:190" class="">x</a></span></span> <span id="y:191" class="id"><span id="y:189" class="id"><a name="y:191" class="">y</a></span></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#a5aeb8c3f096bffee5d65fb0b6810e02">/</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#x:188">x</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssrnum.html#cb42ec59ad57b25928e1718b4e69e031">&lt;=</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#y:189">y}}</a></span>%<span class="id">R</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;(<span class="id"><a href="mathcomp.analysis.probability.html#f:185">f</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#eps:186">eps</a></span>)%<span class="id">:E</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#f1c2ddfea282f8f8d7539f61e14c08e4">*</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#markov_chebyshev_cantelli.P">P</a></span> <span class="id"><a href="mathcomp.classical.classical_sets.html#075f2dd209aa707f1415a58a026b96d9">[set</a></span> <span id="x:192" class="id"><a name="x:192" class="">x</a></span> <span class="id"><a href="mathcomp.classical.classical_sets.html#075f2dd209aa707f1415a58a026b96d9">|</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#eps:186">eps</a></span>%<span class="id">:E</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#63b01a542aec2e4c61e028256cf5a548">&lt;=</a></span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#baaea4d1d2e6cce26f49e2f830fd4e9f">`|</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#X:184">X</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#x:192">x</a></span>)%<span class="id">:E</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#baaea4d1d2e6cce26f49e2f830fd4e9f">|</a></span> <span class="id"><a href="mathcomp.classical.classical_sets.html#075f2dd209aa707f1415a58a026b96d9">]</a></span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#63b01a542aec2e4c61e028256cf5a548">&lt;=</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#69ec4e730a589c79df0349357bb8311f">'E_P[f</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.ssrfun.html#687e14754dadb7c0b04f27d8f71d2638">\o</a></span> (<span class="gallina-kwd">fun</span> <span id="x:193" class="id"><a name="x:193" class="">x</a></span> <span class="id">=&gt;</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssrnum.html#55297ec87c6b3f98c14c99daeafb55d3">`|</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#x:193">x</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssrnum.html#55297ec87c6b3f98c14c99daeafb55d3">|</a></span>%<span class="id">R</span>) <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.ssrfun.html#687e14754dadb7c0b04f27d8f71d2638">\o</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:184">X]</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof46')">Proof.</span></div>
<div class="proofscript" id="proof46">
<span class="id">move=&gt;</span> <span class="id">e0</span> <span class="id">mf</span> <span class="id">f0</span> <span class="id">f_nd;</span> <span class="id">rewrite</span> <span class="id">-</span>(<span class="id"><a href="mathcomp.classical.classical_sets.html#setTI">setTI</a></span> <span class="id"><a href="mathcomp.classical.classical_sets.html#075f2dd209aa707f1415a58a026b96d9">[set</a></span> <span class="id">_</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#075f2dd209aa707f1415a58a026b96d9">|</a></span> <span class="id">_]</span>).<br/>
<span class="id">apply:</span> (<span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.order.html#Order.POrderTheory.le_trans">le_trans</a></span> (@<span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#le_integral_comp_abse">le_integral_comp_abse</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id"><a href="mathcomp.analysis.probability.html#markov_chebyshev_cantelli.P">P</a></span> <span class="id">_</span> <span class="id"><a href="mathcomp.analysis.measure.html#measurableT">measurableT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.ssrfun.html#687e14754dadb7c0b04f27d8f71d2638">\o</a></span> <span class="id">X</span>)<br/>
&nbsp;&nbsp;<span class="id">eps</span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#er_map">er_map</a></span> <span class="id">f</span>) <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">e0</span>)) <span class="id">=&gt;</span> <span class="id">//=</span>.<br/>
<span class="id">-</span> <span class="id">exact:</span> <span class="id"><a href="mathcomp.analysis.lebesgue_measure.html#measurable_er_map">measurable_er_map</a></span>.<br/>
<span class="id">-</span> <span class="gallina-kwd">by</span> <span class="id">case</span> <span class="id">=&gt;</span> <span class="id">//=</span> <span class="id">r</span> <span class="id">_;</span> <span class="id">exact:</span> <span class="id">f0</span>.<br/>
<span class="id">-</span> <span class="id">move=&gt;</span> <span class="id">[x|</span> <span class="id">|]</span> <span class="id">[y|</span> <span class="id">|];</span> <span class="id">rewrite</span> <span class="id">!inE/=</span> <span class="id">!in_itv/=</span> <span class="id">?andbT</span> <span class="id">?lee_fin</span> <span class="id">?leey//</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">move=&gt;</span> <span class="id">?</span> <span class="id">?</span> <span class="id">?;</span> <span class="id">rewrite</span> <span class="id">f_nd</span>.<br/>
<span class="id">-</span> <span class="id">exact/EFin_measurable_fun</span>.<br/>
<span class="id">-</span> <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssreflect.html#unlock">unlock</a></span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Definition</span> <span id="mmt_gen_fun" class="id"><a name="mmt_gen_fun" class="">mmt_gen_fun</a></span> (<span id="X:194" class="id"><a name="X:194" class="">X</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#31c5002a151d32a5908113f99aedfaa1">{RV</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#markov_chebyshev_cantelli.P">P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#31c5002a151d32a5908113f99aedfaa1">&gt;-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#markov_chebyshev_cantelli.R">R}</a></span>) (<span id="t:195" class="id"><a name="t:195" class="">t</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#markov_chebyshev_cantelli.R">R</a></span>) <span class="id">:=</span> <span class="id"><a href="mathcomp.analysis.probability.html#69ec4e730a589c79df0349357bb8311f">'E_P[expR</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.ssrfun.html#687e14754dadb7c0b04f27d8f71d2638">\o</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#t:195">t</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#5e03abe1c4aaadd0b39b8ab0cf62f35b">\o*</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:194">X]</a></span>.<br/>
<br/>
<span class="vernacular">Lemma</span> <span id="chernoff" class="id"><a name="chernoff" class="">chernoff</a></span> (<span id="X:196" class="id"><a name="X:196" class="">X</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#31c5002a151d32a5908113f99aedfaa1">{RV</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#markov_chebyshev_cantelli.P">P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#31c5002a151d32a5908113f99aedfaa1">&gt;-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#markov_chebyshev_cantelli.R">R}</a></span>) (<span id="r:197" class="id"><a name="r:197" class="">r</a></span> <span id="a:198" class="id"><a name="a:198" class="">a</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#markov_chebyshev_cantelli.R">R</a></span>) <span class="id">:</span> (<span class="id">0</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssrnum.html#Num.Syntax.::ring_scope:x_'&lt;'_x">&lt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#r:197">r</a></span>)%<span class="id">R</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#markov_chebyshev_cantelli.P">P</a></span> <span class="id"><a href="mathcomp.classical.classical_sets.html#075f2dd209aa707f1415a58a026b96d9">[set</a></span> <span id="x:199" class="id"><a name="x:199" class="">x</a></span> <span class="id"><a href="mathcomp.classical.classical_sets.html#075f2dd209aa707f1415a58a026b96d9">|</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:196">X</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#x:199">x</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssrnum.html#a3446a989be902579d41cbac1597f4cf">&gt;=</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#a:198">a]</a></span>%<span class="id">R</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#63b01a542aec2e4c61e028256cf5a548">&lt;=</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#mmt_gen_fun">mmt_gen_fun</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:196">X</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#r:197">r</a></span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#f1c2ddfea282f8f8d7539f61e14c08e4">*</a></span> (<span class="id"><a href="mathcomp.analysis.sequences.html#expR">expR</a></span> (<span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#::ring_scope:'-'_x">-</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#r:197">r</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#2d0cfb150261028f4ebd2ba355623dcc">*</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#a:198">a</a></span>)))%<span class="id">:E</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof47')">Proof.</span></div>
<div class="proofscript" id="proof47">
<span class="id">move=&gt;</span> <span class="id">t0</span>.<br/>
<span class="id">rewrite</span> <span class="id">/mmt_gen_fun;</span> <span class="id">have</span> <span class="id">-&gt;</span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.sequences.html#expR">expR</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.ssrfun.html#687e14754dadb7c0b04f27d8f71d2638">\o</a></span> <span class="id">r</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#5e03abe1c4aaadd0b39b8ab0cf62f35b">\o*</a></span> <span class="id">X</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssrnum.html#Num.Def.normr">normr</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.ssrfun.html#687e14754dadb7c0b04f27d8f71d2638">\o</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssrnum.html#Num.Def.normr">normr</a></span>) <span class="id">\o</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssreflect.html#dd4e793ea9d0dbe0a320346aa74c809d">[the</a></span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#cfa8195a18578360e4ad0a1e4cde6878">{mfun</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#markov_chebyshev_cantelli.T">T</a></span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#cfa8195a18578360e4ad0a1e4cde6878">&gt;-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#markov_chebyshev_cantelli.R">R}</a></span> <span class="id">of</span> <span class="id"><a href="mathcomp.analysis.sequences.html#expR">expR</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.ssrfun.html#687e14754dadb7c0b04f27d8f71d2638">\o</a></span> <span class="id">r</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#5e03abe1c4aaadd0b39b8ab0cf62f35b">\o*</a></span> <span class="id">X]</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">apply:</span> <span class="id"><a href="mathcomp.classical.boolp.html#funext">funext</a></span> <span class="id">=&gt;</span> <span class="id">t</span> <span class="id">/=;</span> <span class="id">rewrite</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssrnum.html#Num.Theory.normr_id">normr_id</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssrnum.html#Num.Theory.ger0_norm">ger0_norm</a></span> <span class="id">?expR_ge0</span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.exp.html#expRN">expRN</a></span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#lee_pdivl_mulr">lee_pdivl_mulr</a></span> <span class="id">?expR_gt0//</span>.<br/>
<span class="id">rewrite</span> (<span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.order.html#Order.POrderTheory.le_trans">le_trans</a></span> <span class="id">_</span> (<span class="id"><a href="mathcomp.analysis.probability.html#markov">markov</a></span> <span class="id">_</span> (<span class="id"><a href="mathcomp.analysis.exp.html#expR_gt0">expR_gt0</a></span> (<span class="id">r</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#2d0cfb150261028f4ebd2ba355623dcc">*</a></span> <span class="id">a</span>)) <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>))<span class="id">//;</span> <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;<span class="id">exact:</span> (<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#monoW_in">monoW_in</a></span> (@<span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssrnum.html#Num.Theory.ger0_le_norm">ger0_le_norm</a></span> <span class="id">_</span>)).<br/>
<span class="id">rewrite</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssrnum.html#Num.Theory.ger0_norm">ger0_norm</a></span> <span class="id">?expR_ge0//</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#muleC">muleC</a></span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#lee_pmul2l">lee_pmul2l//</a></span> <span class="id">?lte_fin</span> <span class="id">?expR_gt0//</span>.<br/>
<span class="id">rewrite</span> <span class="id">[X</span> <span class="gallina-kwd">in</span> <span class="id">_</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#63b01a542aec2e4c61e028256cf5a548">&lt;=</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#markov_chebyshev_cantelli.P">P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:202">X]</a></span>(<span class="id">_</span> <span class="id">:</span> <span class="id">_</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="mathcomp.classical.classical_sets.html#075f2dd209aa707f1415a58a026b96d9">[set</a></span> <span id="x:203" class="id"><span id="x:201" class="id"><span id="x:200" class="id"><a name="x:203" class="">x</a></span></span></span> <span class="id"><a href="mathcomp.classical.classical_sets.html#075f2dd209aa707f1415a58a026b96d9">|</a></span> <span class="id">a</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssrnum.html#cb42ec59ad57b25928e1718b4e69e031">&lt;=</a></span> <span class="id">X</span> <span class="id"><a href="mathcomp.analysis.probability.html#x:200">x]</a></span>%<span class="id">R</span>)<span class="id">//;</span> <span class="id">apply:</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#eq_set">eq_set</a></span> <span class="id">=&gt;</span> <span class="id">t/=</span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssrnum.html#Num.Theory.ger0_norm">ger0_norm</a></span> <span class="id">?expR_ge0//</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#lee_fin">lee_fin</a></span> <span class="id"><a href="mathcomp.analysis.exp.html#ler_expR">ler_expR</a></span>  <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#GRing.Theory.mulrC">mulrC</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssrnum.html#Num.Theory.ler_pM2r">ler_pM2r</a></span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="chebyshev" class="id"><a name="chebyshev" class="">chebyshev</a></span> (<span id="X:204" class="id"><a name="X:204" class="">X</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#31c5002a151d32a5908113f99aedfaa1">{RV</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#markov_chebyshev_cantelli.P">P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#31c5002a151d32a5908113f99aedfaa1">&gt;-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#markov_chebyshev_cantelli.R">R}</a></span>) (<span id="eps:205" class="id"><a name="eps:205" class="">eps</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#markov_chebyshev_cantelli.R">R</a></span>) <span class="id">:</span> (<span class="id">0</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssrnum.html#Num.Syntax.::ring_scope:x_'&lt;'_x">&lt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#eps:205">eps</a></span>)%<span class="id">R</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#markov_chebyshev_cantelli.P">P</a></span> <span class="id"><a href="mathcomp.classical.classical_sets.html#075f2dd209aa707f1415a58a026b96d9">[set</a></span> <span id="x:206" class="id"><a name="x:206" class="">x</a></span> <span class="id"><a href="mathcomp.classical.classical_sets.html#075f2dd209aa707f1415a58a026b96d9">|</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#eps:205">eps</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssrnum.html#cb42ec59ad57b25928e1718b4e69e031">&lt;=</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssrnum.html#55297ec87c6b3f98c14c99daeafb55d3">`|</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:204">X</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#x:206">x</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#::ring_scope:x_'-'_x">-</a></span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#fine">fine</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#69ec4e730a589c79df0349357bb8311f">'E_P[X]</a></span>)<span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssrnum.html#55297ec87c6b3f98c14c99daeafb55d3">|</a></span>)%<span class="id">R</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#075f2dd209aa707f1415a58a026b96d9">]</a></span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#63b01a542aec2e4c61e028256cf5a548">&lt;=</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#eps:205">eps</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#2cbbcf28cb71296a00bdaede8cf3ea56">^-</a></span> <span class="id">2</span>)%<span class="id">:E</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#f1c2ddfea282f8f8d7539f61e14c08e4">*</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#9e50536fce9e14b365e2c78395616442">'V_P[X]</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof48')">Proof.</span></div>
<div class="proofscript" id="proof48">
<span class="id">move</span> <span class="id">=&gt;</span> <span class="id">heps;</span> <span class="id">have</span> <span class="id">[-&gt;|hv]</span> <span class="id">:=</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.eqtype.html#eqVneq">eqVneq</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#9e50536fce9e14b365e2c78395616442">'V_P[X]</a></span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#d5becfdd26043e7de5a21e6270f35a00">+oo</a></span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#mulr_infty">mulr_infty</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssrnum.html#Num.Theory.gtr0_sg">gtr0_sg</a></span> <span class="id">?mul1e//</span> <span class="id">?leey//</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssrnum.html#Num.Theory.invr_gt0">invr_gt0//</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssrnum.html#Num.Theory.exprn_gt0">exprn_gt0</a></span>.<br/>
<span class="id">have</span> <span class="id">h</span> (<span id="Y:207" class="id"><a name="Y:207" class="">Y</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#31c5002a151d32a5908113f99aedfaa1">{RV</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#markov_chebyshev_cantelli.P">P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#31c5002a151d32a5908113f99aedfaa1">&gt;-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#markov_chebyshev_cantelli.R">R}</a></span>) <span class="id">:</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#markov_chebyshev_cantelli.P">P</a></span> <span class="id"><a href="mathcomp.classical.classical_sets.html#075f2dd209aa707f1415a58a026b96d9">[set</a></span> <span id="x:208" class="id"><a name="x:208" class="">x</a></span> <span class="id"><a href="mathcomp.classical.classical_sets.html#075f2dd209aa707f1415a58a026b96d9">|</a></span> (<span class="id">eps</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssrnum.html#cb42ec59ad57b25928e1718b4e69e031">&lt;=</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssrnum.html#55297ec87c6b3f98c14c99daeafb55d3">`|Y</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#x:208">x|</a></span>)%<span class="id">R]</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#63b01a542aec2e4c61e028256cf5a548">&lt;=</a></span> (<span class="id">eps</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#2cbbcf28cb71296a00bdaede8cf3ea56">^-</a></span> <span class="id">2</span>)%<span class="id">:E</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#f1c2ddfea282f8f8d7539f61e14c08e4">*</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#69ec4e730a589c79df0349357bb8311f">'E_P[Y</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#663140372ac3b275aae871b74b140513">^+</a></span> <span class="id">2]</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">-lee_pdivr_mull;</span> <span class="id">last</span> <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssrnum.html#Num.Theory.invr_gt0">invr_gt0//</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssrnum.html#Num.Theory.exprn_gt0">exprn_gt0</a></span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssrint.html#exprnN">exprnN</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssrint.html#expfV">expfV</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssrint.html#exprz_inv">exprz_inv</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#GRing.Theory.opprK">opprK</a></span> <span class="id">-exprnP</span>.<br/>
&nbsp;&nbsp;<span class="id">apply:</span> (@<span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.order.html#Order.POrderTheory.le_trans">le_trans</a></span> <span class="id">_</span> <span class="id">_</span> (<span class="id"><a href="mathcomp.analysis.probability.html#69ec4e730a589c79df0349357bb8311f">'E_P[</a></span>(@<span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#GRing.exp">GRing.exp</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#markov_chebyshev_cantelli.R">R</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.ssrfun.html#3dce462f8124648b906d1e347a73bb9f">^~</a></span> <span class="id">2</span>%<span class="id">N</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.ssrfun.html#687e14754dadb7c0b04f27d8f71d2638">\o</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssrnum.html#Num.Def.normr">normr</a></span>) <span class="id">\o</span> <span class="id">Y]</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply:</span> (@<span class="id"><a href="mathcomp.analysis.probability.html#markov">markov</a></span> <span class="id">Y</span> (@<span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#GRing.exp">GRing.exp</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#markov_chebyshev_cantelli.R">R</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.ssrfun.html#3dce462f8124648b906d1e347a73bb9f">^~</a></span> <span class="id">2</span>%<span class="id">N</span>)) <span class="id">=&gt;</span> <span class="id">//</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">-</span> <span class="gallina-kwd">by</span> <span class="id">move=&gt;</span> <span class="id">r</span> <span class="id">_;</span> <span class="id">exact:</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssrnum.html#Num.Theory.sqr_ge0">sqr_ge0</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">-</span> <span class="id">move=&gt;</span> <span class="id">x</span> <span class="id">y;</span> <span class="id">rewrite</span> <span class="id">!nnegrE</span> <span class="id">=&gt;</span> <span class="id">x0</span> <span class="id">y0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssrnum.html#Num.Theory.ler_sqr">ler_sqr</a></span>.<br/>
&nbsp;&nbsp;<span class="id">apply:</span> <span class="id"><a href="mathcomp.analysis.probability.html#expectation_le">expectation_le</a></span> <span class="id">=&gt;</span> <span class="id">//</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">-</span> <span class="gallina-kwd">by</span> <span class="id">apply:</span> <span class="id"><a href="mathcomp.analysis.measure.html#measurableT_comp">measurableT_comp</a></span> <span class="id">=&gt;</span> <span class="id">//;</span> <span class="id">exact:</span> <span class="id"><a href="mathcomp.analysis.measure.html#measurableT_comp">measurableT_comp</a></span>.<br/>
&nbsp;&nbsp;<span class="id">-</span> <span class="gallina-kwd">by</span> <span class="id">move=&gt;</span> <span class="id">x</span> <span class="id">/=;</span> <span class="id">exact:</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssrnum.html#Num.Theory.sqr_ge0">sqr_ge0</a></span>.<br/>
&nbsp;&nbsp;<span class="id">-</span> <span class="gallina-kwd">by</span> <span class="id">move=&gt;</span> <span class="id">x</span> <span class="id">/=;</span> <span class="id">exact:</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssrnum.html#Num.Theory.sqr_ge0">sqr_ge0</a></span>.<br/>
&nbsp;&nbsp;<span class="id">-</span> <span class="gallina-kwd">by</span> <span class="id">apply/aeW</span> <span class="id">=&gt;</span> <span class="id">t</span> <span class="id">/=;</span> <span class="id">rewrite</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssrnum.html#Num.Theory.real_normK">real_normK//</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssrnum.html#Num.Theory.num_real">num_real</a></span>.<br/>
<span class="id">have</span> <span class="id">:=</span> <span class="id">h</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssreflect.html#dd4e793ea9d0dbe0a320346aa74c809d">[the</a></span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#cfa8195a18578360e4ad0a1e4cde6878">{mfun</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#markov_chebyshev_cantelli.T">T</a></span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#cfa8195a18578360e4ad0a1e4cde6878">&gt;-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#markov_chebyshev_cantelli.R">R}</a></span> <span class="id">of</span> (<span class="id">X</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#0bb5d11fe8761db1e6494d75cb45a3cb">\-</a></span> <span class="id"><a href="mathcomp.classical.functions.html#cst">cst</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#fine">fine</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#69ec4e730a589c79df0349357bb8311f">'E_P[X]</a></span>)))%<span class="id">R]</span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">move=&gt;</span> <span class="id">/le_trans;</span> <span class="id">apply;</span> <span class="id">rewrite</span> <span class="id">/variance</span> <span class="id">[in</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.order.html#Order.POSyntax.leRHS">leRHS]unlock</a></span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="cantelli" class="id"><a name="cantelli" class="">cantelli</a></span> (<span id="X:209" class="id"><a name="X:209" class="">X</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#31c5002a151d32a5908113f99aedfaa1">{RV</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#markov_chebyshev_cantelli.P">P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#31c5002a151d32a5908113f99aedfaa1">&gt;-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#markov_chebyshev_cantelli.R">R}</a></span>) (<span id="lambda:210" class="id"><a name="lambda:210" class="">lambda</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#markov_chebyshev_cantelli.R">R</a></span>) <span class="id">:</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#markov_chebyshev_cantelli.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.ssrfun.html#687e14754dadb7c0b04f27d8f71d2638">\o</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:209">X</a></span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#markov_chebyshev_cantelli.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.ssrfun.html#687e14754dadb7c0b04f27d8f71d2638">\o</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#X:209">X</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#663140372ac3b275aae871b74b140513">^+</a></span> <span class="id">2</span>)%<span class="id">R</span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">0</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssrnum.html#Num.Syntax.::ring_scope:x_'&lt;'_x">&lt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#lambda:210">lambda</a></span>)%<span class="id">R</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#markov_chebyshev_cantelli.P">P</a></span> <span class="id"><a href="mathcomp.classical.classical_sets.html#075f2dd209aa707f1415a58a026b96d9">[set</a></span> <span id="x:211" class="id"><a name="x:211" class="">x</a></span> <span class="id"><a href="mathcomp.classical.classical_sets.html#075f2dd209aa707f1415a58a026b96d9">|</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#lambda:210">lambda</a></span>%<span class="id">:E</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#63b01a542aec2e4c61e028256cf5a548">&lt;=</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#X:209">X</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#x:211">x</a></span>)%<span class="id">:E</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#::ereal_scope:x_'-'_x">-</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#69ec4e730a589c79df0349357bb8311f">'E_P[X]]</a></span><br/>
&nbsp;&nbsp;<span class="id">&lt;=</span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#fine">fine</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#9e50536fce9e14b365e2c78395616442">'V_P[X]</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#69c431a9c94f6f30a655bd7ddb59037b">/</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#fine">fine</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#9e50536fce9e14b365e2c78395616442">'V_P[X]</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#c7f78cf1f6a5e4f664654f7d671ca752">+</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#lambda:210">lambda^2</a></span>))%<span class="id">:E</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof49')">Proof.</span></div>
<div class="proofscript" id="proof49">
<span class="id">move=&gt;</span> <span class="id">X1</span> <span class="id">X2</span> <span class="id">lambda_gt0</span>.<br/>
<span class="id">have</span> <span class="id">finEK</span> <span class="id">:</span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#fine">fine</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#69ec4e730a589c79df0349357bb8311f">'E_P[X]</a></span>)%<span class="id">:E</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#69ec4e730a589c79df0349357bb8311f">'E_P[X]</a></span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#fineK">fineK</a></span> <span class="id">?unlock</span> <span class="id">?integral_fune_fin_num</span>.<br/>
<span class="id">have</span> <span class="id">finVK</span> <span class="id">:</span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#fine">fine</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#9e50536fce9e14b365e2c78395616442">'V_P[X]</a></span>)%<span class="id">:E</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#9e50536fce9e14b365e2c78395616442">'V_P[X]</a></span> <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#fineK">fineK</a></span> <span class="id">?variance_fin_num</span>.<br/>
<span class="id">pose</span> <span class="id">Y</span> <span class="id">:=</span> (<span class="id">X</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#0bb5d11fe8761db1e6494d75cb45a3cb">\-</a></span> <span class="id"><a href="mathcomp.classical.functions.html#cst">cst</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#fine">fine</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#69ec4e730a589c79df0349357bb8311f">'E_P[X]</a></span>))%<span class="id">R</span>.<br/>
<span class="id">have</span> <span class="id">Y1</span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#markov_chebyshev_cantelli.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#36b9f1631384d2c3b944cb9d5855cd98">[set:</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#markov_chebyshev_cantelli.T">T]</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.ssrfun.html#687e14754dadb7c0b04f27d8f71d2638">\o</a></span> <span class="id">Y</span>).<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.ereal.html#compreBr">compreBr</a></span> <span class="id">=&gt;</span> <span class="id">[|//];</span> <span class="id">apply:</span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#integrableB">integrableB</a></span> <span class="id">X1</span> <span class="id">_</span> <span class="id">=&gt;</span> <span class="id">[//|]</span>.<br/>
&nbsp;&nbsp;<span class="id">exact:</span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#finite_measure_integrable_cst">finite_measure_integrable_cst</a></span>.<br/>
<span class="id">have</span> <span class="id">Y2</span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#markov_chebyshev_cantelli.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#36b9f1631384d2c3b944cb9d5855cd98">[set:</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#markov_chebyshev_cantelli.T">T]</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.ssrfun.html#687e14754dadb7c0b04f27d8f71d2638">\o</a></span> (<span class="id">Y</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#663140372ac3b275aae871b74b140513">^+</a></span> <span class="id">2</span>)%<span class="id">R</span>).<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#GRing.Theory.sqrrD">sqrrD/=</a></span> <span class="id"><a href="mathcomp.analysis.ereal.html#compreDr">compreDr</a></span> <span class="id">=&gt;</span> <span class="id">[|//]</span>.<br/>
&nbsp;&nbsp;<span class="id">apply:</span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#integrableD">integrableD</a></span> <span class="id">=&gt;</span> <span class="id">[//||];</span> <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">-[</span>(<span class="id">_</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#663140372ac3b275aae871b74b140513">^+</a></span> <span class="id">2</span>)%<span class="id">R]/</span>(<span class="id"><a href="mathcomp.classical.functions.html#cst">cst</a></span> ((<span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#::ring_scope:'-'_x">-</a></span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#fine">fine</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#69ec4e730a589c79df0349357bb8311f">'E_P[X]</a></span>) <span class="id">^+</span> <span class="id">2</span>)%<span class="id">R</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exact:</span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#finite_measure_integrable_cst">finite_measure_integrable_cst</a></span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.ereal.html#compreDr">compreDr</a></span> <span class="id">=&gt;</span> <span class="id">[|//];</span> <span class="id">apply:</span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#integrableD">integrableD</a></span> <span class="id">X2</span> <span class="id">_</span> <span class="id">=&gt;</span> <span class="id">[//|]</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">[X</span> <span class="gallina-kwd">in</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.ssrfun.html#687e14754dadb7c0b04f27d8f71d2638">\o</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:212">X]</a></span>(<span class="id">_</span> <span class="id">:</span> <span class="id">_</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> (<span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#::ring_scope:'-'_x">-</a></span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#fine">fine</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#69ec4e730a589c79df0349357bb8311f">'E_P[X]</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#2d0cfb150261028f4ebd2ba355623dcc">*</a></span> <span class="id">2</span>) <span class="id">\o*</span> <span class="id">X</span>)%<span class="id">R;</span> <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">apply/funeqP</span> <span class="id">=&gt;</span> <span class="id">x</span> <span class="id">/=;</span> <span class="id">rewrite</span> <span class="id">-mulr_natl</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#GRing.Theory.mulrC">mulrC</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#GRing.Theory.mulrA">mulrA</a></span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.ereal.html#compre_scale">compre_scale</a></span> <span class="id">=&gt;</span> <span class="id">[|//];</span> <span class="id">apply:</span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#integrableZl">integrableZl</a></span> <span class="id">X1</span>.<br/>
<span class="id">have</span> <span class="id">EY</span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#69ec4e730a589c79df0349357bb8311f">'E_P[Y]</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id">0</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.probability.html#expectationB">expectationB/=</a></span> <span class="id">?finite_measure_integrable_cst//</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.probability.html#expectation_cst">expectation_cst</a></span> <span class="id">finEK</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#subee">subee//</a></span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssreflect.html#unlock">unlock;</a></span> <span class="id">apply:</span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#integral_fune_fin_num">integral_fune_fin_num</a></span> <span class="id">X1</span>.<br/>
<span class="id">have</span> <span class="id">VY</span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#9e50536fce9e14b365e2c78395616442">'V_P[Y]</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#9e50536fce9e14b365e2c78395616442">'V_P[X]</a></span> <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.probability.html#varianceB_cst_r">varianceB_cst_r</a></span>.<br/>
<span class="id">have</span> <span class="id">le</span> (<span id="u:213" class="id"><a name="u:213" class="">u</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#markov_chebyshev_cantelli.R">R</a></span>) <span class="id">:</span> (<span class="id">0</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssrnum.html#cb42ec59ad57b25928e1718b4e69e031">&lt;=</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#u:213">u</a></span>)%<span class="id">R</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#markov_chebyshev_cantelli.P">P</a></span> <span class="id"><a href="mathcomp.classical.classical_sets.html#075f2dd209aa707f1415a58a026b96d9">[set</a></span> <span id="x:214" class="id"><a name="x:214" class="">x</a></span> <span class="id"><a href="mathcomp.classical.classical_sets.html#075f2dd209aa707f1415a58a026b96d9">|</a></span> <span class="id">lambda</span>%<span class="id">:E</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#63b01a542aec2e4c61e028256cf5a548">&lt;=</a></span> (<span class="id">X</span> <span class="id"><a href="mathcomp.analysis.probability.html#x:214">x</a></span>)%<span class="id">:E</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#::ereal_scope:x_'-'_x">-</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#69ec4e730a589c79df0349357bb8311f">'E_P[X]]</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">&lt;=</span> ((<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#fine">fine</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#9e50536fce9e14b365e2c78395616442">'V_P[X]</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#c7f78cf1f6a5e4f664654f7d671ca752">+</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#u:213">u^2</a></span>) <span class="id">/</span> (<span class="id">lambda</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#c7f78cf1f6a5e4f664654f7d671ca752">+</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#u:213">u</a></span>)<span class="id">^2</span>)%<span class="id">:E</span>.<br/>
&nbsp;&nbsp;<span class="id">move=&gt;</span> <span class="id">uge0;</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFinM">EFinM</a></span>.<br/>
&nbsp;&nbsp;<span class="id">have</span> <span class="id">YU1</span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#markov_chebyshev_cantelli.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#36b9f1631384d2c3b944cb9d5855cd98">[set:</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#markov_chebyshev_cantelli.T">T]</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.ssrfun.html#687e14754dadb7c0b04f27d8f71d2638">\o</a></span> (<span class="id">Y</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#d85e5ec1adc01afcee458717bbaea5e5">\+</a></span> <span class="id"><a href="mathcomp.classical.functions.html#cst">cst</a></span> <span class="id">u</span>)%<span class="id">R</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.ereal.html#compreDr">compreDr</a></span> <span class="id">=&gt;</span> <span class="id">[|//];</span> <span class="id">apply:</span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#integrableD">integrableD</a></span> <span class="id">Y1</span> <span class="id">_</span> <span class="id">=&gt;</span> <span class="id">[//|]</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exact:</span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#finite_measure_integrable_cst">finite_measure_integrable_cst</a></span>.<br/>
&nbsp;&nbsp;<span class="id">have</span> <span class="id">YU2</span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#markov_chebyshev_cantelli.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#36b9f1631384d2c3b944cb9d5855cd98">[set:</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#markov_chebyshev_cantelli.T">T]</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.ssrfun.html#687e14754dadb7c0b04f27d8f71d2638">\o</a></span> ((<span class="id">Y</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#d85e5ec1adc01afcee458717bbaea5e5">\+</a></span> <span class="id"><a href="mathcomp.classical.functions.html#cst">cst</a></span> <span class="id">u</span>) <span class="id">^+</span> <span class="id">2</span>)%<span class="id">R</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#GRing.Theory.sqrrD">sqrrD/=</a></span> <span class="id"><a href="mathcomp.analysis.ereal.html#compreDr">compreDr</a></span> <span class="id">=&gt;</span> <span class="id">[|//]</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply:</span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#integrableD">integrableD</a></span> <span class="id">=&gt;</span> <span class="id">[//||];</span> <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">-[</span>(<span class="id">_</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#663140372ac3b275aae871b74b140513">^+</a></span> <span class="id">2</span>)%<span class="id">R]/</span>(<span class="id"><a href="mathcomp.classical.functions.html#cst">cst</a></span> (<span class="id">u</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#663140372ac3b275aae871b74b140513">^+</a></span> <span class="id">2</span>))%<span class="id">R</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exact:</span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#finite_measure_integrable_cst">finite_measure_integrable_cst</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.ereal.html#compreDr">compreDr</a></span> <span class="id">=&gt;</span> <span class="id">[|//];</span> <span class="id">apply:</span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#integrableD">integrableD</a></span> <span class="id">Y2</span> <span class="id">_</span> <span class="id">=&gt;</span> <span class="id">[//|]</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">[X</span> <span class="gallina-kwd">in</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.ssrfun.html#687e14754dadb7c0b04f27d8f71d2638">\o</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:215">X]</a></span>(<span class="id">_</span> <span class="id">:</span> <span class="id">_</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> (<span class="id">2</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#2d0cfb150261028f4ebd2ba355623dcc">*</a></span> <span class="id">u</span>) <span class="id">\o*</span> <span class="id">Y</span>)%<span class="id">R;</span> <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">apply/funeqP</span> <span class="id">=&gt;</span> <span class="id">x</span> <span class="id">/=;</span> <span class="id">rewrite</span> <span class="id">-mulr_natl</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#GRing.Theory.mulrCA">mulrCA</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.ereal.html#compre_scale">compre_scale</a></span> <span class="id">=&gt;</span> <span class="id">[|//];</span> <span class="id">apply:</span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#integrableZl">integrableZl</a></span> <span class="id">Y1</span>.<br/>
&nbsp;&nbsp;<span class="id">have</span> <span class="id">-&gt;</span> <span class="id">:</span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#fine">fine</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#9e50536fce9e14b365e2c78395616442">'V_P[X]</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#c7f78cf1f6a5e4f664654f7d671ca752">+</a></span> <span class="id">u^2</span>)%<span class="id">:E</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#69ec4e730a589c79df0349357bb8311f">'E_P[</a></span>(<span class="id">Y</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#d85e5ec1adc01afcee458717bbaea5e5">\+</a></span> <span class="id"><a href="mathcomp.classical.functions.html#cst">cst</a></span> <span class="id">u</span>)<span class="id">^+2]</span>%<span class="id">R</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">-VY</span> <span class="id">-[RHS]</span>(@<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#subeK">subeK</a></span> <span class="id">_</span> <span class="id">_</span> ((<span class="id"><a href="mathcomp.analysis.probability.html#69ec4e730a589c79df0349357bb8311f">'E_P[</a></span>(<span class="id">Y</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#d85e5ec1adc01afcee458717bbaea5e5">\+</a></span> <span class="id"><a href="mathcomp.classical.functions.html#cst">cst</a></span> <span class="id">u</span>)%<span class="id">R]</span>)<span class="id">^+2</span>))<span class="id">;</span> <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#fin_numX">fin_numX</a></span> <span class="id">?unlock</span> <span class="id">?integral_fune_fin_num</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">-varianceE/=</span> <span class="id">-/Y</span> <span class="id">-?expe2//</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.probability.html#expectationD">expectationD/=</a></span> <span class="id">?EY</span> <span class="id">?add0e</span> <span class="id">?expectation_cst</span> <span class="id">-?EFinM;</span> <span class="id">last</span> <span class="id">2</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">-</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.ereal.html#compreBr">compreBr</a></span> <span class="id">=&gt;</span> <span class="id">[|//];</span> <span class="id">apply:</span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#integrableB">integrableB</a></span> <span class="id">X1</span> <span class="id">_</span> <span class="id">=&gt;</span> <span class="id">[//|]</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exact:</span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#finite_measure_integrable_cst">finite_measure_integrable_cst</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">-</span> <span class="id">exact:</span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#finite_measure_integrable_cst">finite_measure_integrable_cst</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> (<span class="id"><a href="mathcomp.analysis.probability.html#varianceD_cst_r">varianceD_cst_r</a></span> <span class="id">_</span> <span class="id">Y1</span> <span class="id">Y2</span>) <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFinD">EFinD</a></span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#fineK">fineK</a></span> <span class="id">?</span>(<span class="id"><a href="mathcomp.analysis.probability.html#variance_fin_num">variance_fin_num</a></span> <span class="id">Y1</span> <span class="id">Y2</span>).<br/>
&nbsp;&nbsp;<span class="id">have</span> <span class="id">le</span> <span class="id">:</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#075f2dd209aa707f1415a58a026b96d9">[set</a></span> <span id="x:216" class="id"><a name="x:216" class="">x</a></span> <span class="id"><a href="mathcomp.classical.classical_sets.html#075f2dd209aa707f1415a58a026b96d9">|</a></span> <span class="id">lambda</span>%<span class="id">:E</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#63b01a542aec2e4c61e028256cf5a548">&lt;=</a></span> (<span class="id">X</span> <span class="id"><a href="mathcomp.analysis.probability.html#x:216">x</a></span>)%<span class="id">:E</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#::ereal_scope:x_'-'_x">-</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#69ec4e730a589c79df0349357bb8311f">'E_P[X]]</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">`&lt;=`</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#075f2dd209aa707f1415a58a026b96d9">[set</a></span> <span id="x:217" class="id"><a name="x:217" class="">x</a></span> <span class="id"><a href="mathcomp.classical.classical_sets.html#075f2dd209aa707f1415a58a026b96d9">|</a></span> ((<span class="id">lambda</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#c7f78cf1f6a5e4f664654f7d671ca752">+</a></span> <span class="id">u</span>)<span class="id">^2</span>)%<span class="id">:E</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#63b01a542aec2e4c61e028256cf5a548">&lt;=</a></span> ((<span class="id">Y</span> <span class="id"><a href="mathcomp.analysis.probability.html#x:217">x</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#c7f78cf1f6a5e4f664654f7d671ca752">+</a></span> <span class="id">u</span>)<span class="id">^+2</span>)%<span class="id">:E]</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">move=&gt;</span> <span class="id">x</span> <span class="id">/=</span> <span class="id">le;</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#lee_fin">lee_fin;</a></span> <span class="id">apply:</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssrnum.html#Num.Theory.lerXn2r">lerXn2r</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">-</span> <span class="id">exact:</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssrnum.html#Num.Theory.addr_ge0">addr_ge0</a></span> (<span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.order.html#Order.POrderTheory.ltW">ltW</a></span> <span class="id">lambda_gt0</span>) <span class="id">_</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">-</span> <span class="id">apply/</span>(<span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssrnum.html#Num.Theory.addr_ge0">addr_ge0</a></span> <span class="id">_</span> <span class="id">uge0</span>)<span class="id">/</span>(<span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.order.html#Order.POrderTheory.le_trans">le_trans</a></span> (<span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.order.html#Order.POrderTheory.ltW">ltW</a></span> <span class="id">lambda_gt0</span>) <span class="id">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">-lee_fin</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFinB">EFinB</a></span> <span class="id">finEK</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">-</span> <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssrnum.html#Num.Theory.lerD2r">lerD2r</a></span> <span class="id">-lee_fin</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFinB">EFinB</a></span> <span class="id">finEK</span>.<br/>
&nbsp;&nbsp;<span class="id">apply:</span> (<span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.order.html#Order.POrderTheory.le_trans">le_trans</a></span> (<span class="id"><a href="mathcomp.analysis.measure.html#le_measure">le_measure</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">le</span>)).<br/>
&nbsp;&nbsp;<span class="id">-</span> <span class="id">rewrite</span> <span class="id">-[[set</span> <span class="id">_</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#075f2dd209aa707f1415a58a026b96d9">|</a></span> <span class="id">_]]setTI</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#inE">inE;</a></span> <span class="id">apply:</span> <span class="id"><a href="mathcomp.analysis.lebesgue_measure.html#emeasurable_fun_c_infty">emeasurable_fun_c_infty</a></span> <span class="id">=&gt;</span> <span class="id">[//|]</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">apply:</span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#emeasurable_funB">emeasurable_funB</a></span> <span class="id">=&gt;</span> <span class="id">//;</span> <span class="id">exact:</span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#measurable_int">measurable_int</a></span> <span class="id">X1</span>.<br/>
&nbsp;&nbsp;<span class="id">-</span> <span class="id">rewrite</span> <span class="id">-[[set</span> <span class="id">_</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#075f2dd209aa707f1415a58a026b96d9">|</a></span> <span class="id">_]]setTI</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#inE">inE;</a></span> <span class="id">apply:</span> <span class="id"><a href="mathcomp.analysis.lebesgue_measure.html#emeasurable_fun_c_infty">emeasurable_fun_c_infty</a></span> <span class="id">=&gt;</span> <span class="id">[//|]</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.lebesgue_measure.html#EFin_measurable_fun">EFin_measurable_fun</a></span> <span class="id">[X</span> <span class="gallina-kwd">in</span> <span class="id"><a href="mathcomp.analysis.measure.html#measurable_fun">measurable_fun</a></span> <span class="id">_</span> <span class="id"><a href="mathcomp.analysis.probability.html#X:222">X]</a></span>(<span class="id">_</span> <span class="id">:</span> <span class="id">_</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="gallina-kwd">fun</span> <span id="x:223" class="id"><span id="x:220" class="id"><span id="x:218" class="id"><a name="x:223" class="">x</a></span></span></span> <span class="id">=&gt;</span> <span class="id"><a href="mathcomp.analysis.probability.html#x:218">x</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#663140372ac3b275aae871b74b140513">^+</a></span> <span class="id">2</span>) <span class="id">\o</span> (<span class="gallina-kwd">fun</span> <span id="x:224" class="id"><span id="x:221" class="id"><span id="x:219" class="id"><a name="x:224" class="">x</a></span></span></span> <span class="id">=&gt;</span> <span class="id">Y</span> <span class="id"><a href="mathcomp.analysis.probability.html#x:219">x</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#c7f78cf1f6a5e4f664654f7d671ca752">+</a></span> <span class="id">u</span>))%<span class="id">R//</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">apply/measurableT_comp</span> <span class="id">=&gt;</span> <span class="id">//;</span> <span class="id">apply/measurable_funD</span>.<br/>
&nbsp;&nbsp;<span class="id">set</span> <span class="id">eps</span> <span class="id">:=</span> ((<span class="id">lambda</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#c7f78cf1f6a5e4f664654f7d671ca752">+</a></span> <span class="id">u</span>) <span class="id">^</span> <span class="id">2</span>)%<span class="id">R</span>.<br/>
&nbsp;&nbsp;<span class="id">have</span> <span class="id">peps</span> <span class="id">:</span> (<span class="id">0</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssrnum.html#Num.Syntax.::ring_scope:x_'&lt;'_x">&lt;</a></span> <span class="id">eps</span>)%<span class="id">R</span> <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssrint.html#exprz_gt0">exprz_gt0</a></span> <span class="id">?ltr_wpDr</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#lee_pdivl_mulr">lee_pdivl_mulr</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">peps</span>) <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#muleC">muleC</a></span>.<br/>
&nbsp;&nbsp;<span class="id">under</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#eq_set">eq_set</a></span> <span class="id">=&gt;</span> <span class="id">x</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">-[leRHS]gee0_abs</span> <span class="id">?lee_fin</span> <span class="id">?sqr_ge0</span> <span class="id">-?lee_fin</span> <span class="id">=&gt;</span> <span class="id">[|//]</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">-[</span>(<span class="id">_</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#663140372ac3b275aae871b74b140513">^+</a></span> <span class="id">2</span>)%<span class="id">R]/</span>(((<span class="id">Y</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#d85e5ec1adc01afcee458717bbaea5e5">\+</a></span> <span class="id"><a href="mathcomp.classical.functions.html#cst">cst</a></span> <span class="id">u</span>) <span class="id">^+</span> <span class="id">2</span>) <span class="id">x</span>)%<span class="id">R;</span> <span class="id">over</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">-[X</span> <span class="gallina-kwd">in</span> <span class="id"><a href="mathcomp.analysis.probability.html#X:225">X</a></span>%<span class="id">:E</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#f1c2ddfea282f8f8d7539f61e14c08e4">*</a></span> <span class="id">_]gtr0_norm</span> <span class="id">=&gt;</span> <span class="id">[|//]</span>.<br/>
&nbsp;&nbsp;<span class="id">apply:</span> (<span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.order.html#Order.POrderTheory.le_trans">le_trans</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#markov">markov</a></span> <span class="id">_</span> <span class="id">peps</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>)) <span class="id">=&gt;</span> <span class="id">//=</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">move=&gt;</span> <span class="id">x</span> <span class="id">y</span> <span class="id">/[!nnegrE]</span> <span class="id">/ger0_norm-&gt;</span> <span class="id">/ger0_norm-&gt;</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">-/Y</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.order.html#Order.POrderTheory.le_eqVlt">le_eqVlt;</a></span> <span class="id">apply/orP;</span> <span class="id">left;</span> <span class="id">apply/eqP;</span> <span class="id">congr</span> <span class="id"><a href="mathcomp.analysis.probability.html#expectation">expectation</a></span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">apply/funeqP</span> <span class="id">=&gt;</span> <span class="id">x</span> <span class="id">/=;</span> <span class="id">rewrite</span> <span class="id">-expr2</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssrnum.html#Num.Theory.normr_id">normr_id</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssrnum.html#Num.Theory.ger0_norm">ger0_norm</a></span> <span class="id">?sqr_ge0</span>.<br/>
<span class="id">pose</span> <span class="id">u0</span> <span class="id">:=</span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#fine">fine</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#9e50536fce9e14b365e2c78395616442">'V_P[X]</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#69c431a9c94f6f30a655bd7ddb59037b">/</a></span> <span class="id">lambda</span>)%<span class="id">R</span>.<br/>
<span class="id">have</span> <span class="id">u0ge0</span> <span class="id">:</span> (<span class="id">0</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssrnum.html#cb42ec59ad57b25928e1718b4e69e031">&lt;=</a></span> <span class="id">u0</span>)%<span class="id">R</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">apply:</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssrnum.html#Num.Theory.divr_ge0">divr_ge0</a></span> (<span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.order.html#Order.POrderTheory.ltW">ltW</a></span> <span class="id">lambda_gt0</span>)<span class="id">;</span> <span class="id">rewrite</span> <span class="id">-lee_fin</span> <span class="id">finVK</span> <span class="id"><a href="mathcomp.analysis.probability.html#variance_ge0">variance_ge0</a></span>.<br/>
<span class="id">apply:</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.order.html#Order.POrderTheory.le_trans">le_trans</a></span> (<span class="id">le</span> <span class="id">_</span> <span class="id">u0ge0</span>) <span class="id">_;</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#lee_fin">lee_fin</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.order.html#Order.POrderTheory.le_eqVlt">le_eqVlt;</a></span> <span class="id">apply/orP;</span> <span class="id">left</span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#GRing.Theory.eqr_div">eqr_div;</a></span> <span class="id">[|apply:</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssrnum.html#Num.Theory.lt0r_neq0">lt0r_neq0</a></span>..<span class="id">];</span> <span class="id">last</span> <span class="id">2</span> <span class="id">first</span>.<br/>
<span class="id">-</span> <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssrint.html#exprz_gt0">exprz_gt0</a></span> <span class="id">-1?[ltLHS]addr0</span> <span class="id">?ltr_leD</span>.<br/>
<span class="id">-</span> <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssrnum.html#Num.Theory.ltr_wpDl">ltr_wpDl</a></span> <span class="id">?fine_ge0</span> <span class="id">?variance_ge0</span> <span class="id">?exprz_gt0</span>.<br/>
<span class="id">apply/eqP;</span> <span class="id">have</span> <span class="id">-&gt;</span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#fine">fine</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#9e50536fce9e14b365e2c78395616442">'V_P[X]</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> (<span class="id">u0</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#2d0cfb150261028f4ebd2ba355623dcc">*</a></span> <span class="id">lambda</span>)%<span class="id">R</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">/u0</span> <span class="id">-mulrA</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#GRing.Theory.mulVr">mulVr</a></span> <span class="id">?mulr1</span> <span class="id">?unitfE</span> <span class="id">?gt_eqF</span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">-mulrDl</span> <span class="id">-mulrDr</span> (<span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#GRing.Theory.addrC">addrC</a></span> <span class="id">u0</span>) <span class="id">[in</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssrmatching.ssrmatching.html#SsrMatchingSyntax.RHS">RHS]</a></span>(<span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#GRing.Theory.mulrAC">mulrAC</a></span> <span class="id">u0</span>) <span class="id">-exprnP</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#GRing.Theory.expr2">expr2</a></span> <span class="id">!mulrA</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">End</span> <span class="id"><a href="mathcomp.analysis.probability.html#markov_chebyshev_cantelli">markov_chebyshev_cantelli</a></span>.<br/>
<br/>
<span id="MeasurableFun_isDiscrete.Exports" class="id"><span id="MeasurableFun_isDiscrete.identity_builder" class="id"><span id="MeasurableFun_isDiscrete.phant_axioms" class="id"><span id="MeasurableFun_isDiscrete.phant_Build" class="id"><span id="MeasurableFun_isDiscrete.countable_range" class="id"><span id="MeasurableFun_isDiscrete.axioms_" class="id"><span id="MeasurableFun_isDiscrete.MeasurableFun_isDiscrete_X__canonical__lebesgue_integral_MeasurableFun" class="id"><span id="MeasurableFun_isDiscrete.MeasurableFun_isDiscrete.local_mixin_lebesgue_integral_isMeasurableFun" class="id"><span id="MeasurableFun_isDiscrete.MeasurableFun_isDiscrete.X" class="id"><span id="MeasurableFun_isDiscrete.MeasurableFun_isDiscrete.R" class="id"><span id="MeasurableFun_isDiscrete.MeasurableFun_isDiscrete.T" class="id"><span id="MeasurableFun_isDiscrete.MeasurableFun_isDiscrete.d" class="id"><span id="MeasurableFun_isDiscrete.MeasurableFun_isDiscrete.MeasurableFun_isDiscrete" class="id"><span id="MeasurableFun_isDiscrete" class="id"><a name="MeasurableFun_isDiscrete.Exports" class="hierarchy-builder">HB.mixin</a></span></span></span></span></span></span></span></span></span></span></span></span></span></span> <span class="vernacular">Record</span> <span class="id">MeasurableFun_isDiscrete</span> <span id="d:226" class="id"><a name="d:226" class="">d</a></span> (<span id="T:227" class="id"><a name="T:227" class="">T</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.measure.html#Measurable.Exports.measurableType">measurableType</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#d:226">d</a></span>) (<span id="R:228" class="id"><a name="R:228" class="">R</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.reals.html#Real.Exports.realType">realType</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span id="X:229" class="id"><a name="X:229" class="">X</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#T:227">T</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#R:228">R</a></span>) <span class="id">of</span> @<span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#MeasurableFun">MeasurableFun</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#d:226">d</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#T:227">T</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#R:228">R</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:229">X</a></span> <span class="id">:=</span> <span class="id">{</span><br/>
&nbsp;&nbsp;<span id="countable_range:230" class="id"><a name="countable_range:230" class="">countable_range</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.classical.cardinality.html#countable">countable</a></span> (<span class="id"><a href="mathcomp.classical.classical_sets.html#range">range</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:229">X</a></span>)<br/>
<span class="id">}</span>.<br/>
<br/>
<span id="discreteMeasurableFunElpiOperations" class="id"><span id="countable_range" class="id"><span id="discreteMeasurableFun.phant_on_" class="id"><span id="discreteMeasurableFun.Exports.probability_discreteMeasurableFun__to__lebesgue_integral_MeasurableFun" class="id"><span id="discreteMeasurableFun.Exports.probability_discreteMeasurableFun_class__to__lebesgue_integral_MeasurableFun_class" class="id"><span id="discreteMeasurableFun.Exports" class="id"><span id="discreteMeasurableFun.pack_" class="id"><span id="discreteMeasurableFun.phant_clone" class="id"><span id="discreteMeasurableFun.class" class="id"><span id="discreteMeasurableFun.sort" class="id"><span id="discreteMeasurableFun.type" class="id"><span id="discreteMeasurableFun.probability_MeasurableFun_isDiscrete_mixin" class="id"><span id="discreteMeasurableFun.lebesgue_integral_isMeasurableFun_mixin" class="id"><span id="discreteMeasurableFun.axioms_" class="id"><span id="discreteMeasurableFun" class="id"><a name="discreteMeasurableFunElpiOperations" class="hierarchy-builder">HB.structure</a></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span> <span class="vernacular">Definition</span> <span class="id">discreteMeasurableFun</span> <span id="d:235" class="id"><a name="d:235" class="">d</a></span> (<span id="T:236" class="id"><a name="T:236" class="">T</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.measure.html#Measurable.Exports.measurableType">measurableType</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#d:235">d</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span id="R:237" class="id"><a name="R:237" class="">R</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.reals.html#Real.Exports.realType">realType</a></span>) <span class="id">:=</span> <span class="id"><a href="NOTFOUND the module url for HB.structures#07a2fe97f630e8e0c2d8d753544c8c8c">{</a></span><br/>
&nbsp;&nbsp;<span id="X:238" class="id"><a name="X:238" class="">X</a></span> <span class="id">of</span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#isMeasurableFun">isMeasurableFun</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#d:235">d</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#T:236">T</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#R:237">R</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:238">X</a></span> &amp; <span class="id"><a href="mathcomp.analysis.probability.html#MeasurableFun_isDiscrete">MeasurableFun_isDiscrete</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#d:235">d</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#T:236">T</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#R:237">R</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:238">X</a></span><br/>
<span class="id">}</span>.<br/>
<br/>
<span class="vernacular">Notation</span> <span id="b17f6ab1cd771e519085733c5b2ec6bc" class="id"><a name="b17f6ab1cd771e519085733c5b2ec6bc" class="">&quot;{ 'dmfun' aT &gt;-&gt; T }&quot;</a></span> <span class="id">:=</span><br/>
&nbsp;&nbsp;(@<span class="id"><a href="mathcomp.analysis.probability.html#type">discreteMeasurableFun.type</a></span> <span class="id">_</span> <span class="id">aT</span> <span class="id">T</span>) <span class="id">:</span> <span class="id">form_scope</span>.<br/>
<br/>
<span class="vernacular">Definition</span> <span id="discrete_random_variable" class="id"><a name="discrete_random_variable" class="">discrete_random_variable</a></span> (<span id="d:240" class="id"><a name="d:240" class="">d</a></span> <span class="id">:</span> <span class="id">_</span>) (<span id="T:241" class="id"><a name="T:241" class="">T</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.measure.html#Measurable.Exports.measurableType">measurableType</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#d:240">d</a></span>)<br/>
&nbsp;&nbsp;(<span id="R:242" class="id"><a name="R:242" class="">R</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.reals.html#Real.Exports.realType">realType</a></span>) (<span id="P:243" class="id"><a name="P:243" class="">P</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.measure.html#Probability.Exports.probability">probability</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#T:241">T</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#R:242">R</a></span>) <span class="id">:=</span> <span class="id"><a href="mathcomp.analysis.probability.html#b17f6ab1cd771e519085733c5b2ec6bc">{dmfun</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#T:241">T</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#b17f6ab1cd771e519085733c5b2ec6bc">&gt;-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#R:242">R}</a></span>.<br/>
<br/>
<span class="vernacular">Notation</span> <span id="b5a1ea6c8f3277fde90807f8c5935ab3" class="id"><a name="b5a1ea6c8f3277fde90807f8c5935ab3" class="">&quot;{ 'dRV' P &gt;-&gt; R }&quot;</a></span> <span class="id">:=</span><br/>
&nbsp;&nbsp;(@<span class="id"><a href="mathcomp.analysis.probability.html#discrete_random_variable">discrete_random_variable</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">R</span> <span class="id">P</span>) <span class="id">:</span> <span class="id">form_scope</span>.<br/>
<br/>
<span class="vernacular">Section</span> <span id="dRV_definitions" class="id"><a name="dRV_definitions" class="">dRV_definitions</a></span>.<br/>
<span class="vernacular">Context</span> <span id="d:244" class="id"><a name="d:244" class="">d</a></span> (<span id="T:245" class="id"><a name="T:245" class="">T</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.measure.html#Measurable.Exports.measurableType">measurableType</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#d:244">d</a></span>) (<span id="R:246" class="id"><a name="R:246" class="">R</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.reals.html#Real.Exports.realType">realType</a></span>) (<span id="P:247" class="id"><a name="P:247" class="">P</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.measure.html#Probability.Exports.probability">probability</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#T:245">T</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#R:246">R</a></span>).<br/>
<br/>
<span class="vernacular">Definition</span> <span id="dRV_dom_enum" class="id"><a name="dRV_dom_enum" class="">dRV_dom_enum</a></span> (<span id="X:248" class="id"><a name="X:248" class="">X</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#b5a1ea6c8f3277fde90807f8c5935ab3">{dRV</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#dRV_definitions.P">P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#b5a1ea6c8f3277fde90807f8c5935ab3">&gt;-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#dRV_definitions.R">R}</a></span>) <span class="id">:</span><br/>
&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Specif.html#cc5e56ba3765e2d6b17e66d19b966f1d">{</a></span> <span id="B:249" class="id"><a name="B:249" class="">B</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Specif.html#cc5e56ba3765e2d6b17e66d19b966f1d">:</a></span> <span class="id"><a href="mathcomp.classical.classical_sets.html#set">set</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#nat">nat</a></span> &amp; <span class="id"><a href="mathcomp.classical.functions.html#1cc9a099865f2e7454cc48caa63109e9">{splitbij</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#B:249">B</a></span> <span class="id"><a href="mathcomp.classical.functions.html#1cc9a099865f2e7454cc48caa63109e9">&gt;-&gt;</a></span> <span class="id"><a href="mathcomp.classical.classical_sets.html#range">range</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:248">X}}</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof50')">Proof.</span></div>
<div class="proofscript" id="proof50">
<span class="id">have</span> <span class="id">/countable_bijP/cid[B]</span> <span class="id">:=</span> @<span class="id"><a href="mathcomp.analysis.probability.html#countable_range">countable_range</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">X</span>.<br/>
<span class="id">move/card_esym/ppcard_eqP/unsquash</span> <span class="id">=&gt;</span> <span class="id">f</span>.<br/>
<span class="gallina-kwd">exists</span> <span class="id">B;</span> <span class="id">exact:</span> <span class="id">f</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Definition</span> <span id="dRV_dom" class="id"><a name="dRV_dom" class="">dRV_dom</a></span> (<span id="X:250" class="id"><a name="X:250" class="">X</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#b5a1ea6c8f3277fde90807f8c5935ab3">{dRV</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#dRV_definitions.P">P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#b5a1ea6c8f3277fde90807f8c5935ab3">&gt;-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#dRV_definitions.R">R}</a></span>) <span class="id">:</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#set">set</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#nat">nat</a></span> <span class="id">:=</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Specif.html#projT1">projT1</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#dRV_dom_enum">dRV_dom_enum</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:250">X</a></span>).<br/>
<br/>
<span class="vernacular">Definition</span> <span id="dRV_enum" class="id"><a name="dRV_enum" class="">dRV_enum</a></span> (<span id="X:251" class="id"><a name="X:251" class="">X</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#b5a1ea6c8f3277fde90807f8c5935ab3">{dRV</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#dRV_definitions.P">P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#b5a1ea6c8f3277fde90807f8c5935ab3">&gt;-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#dRV_definitions.R">R}</a></span>) <span class="id">:</span> <span class="id"><a href="mathcomp.classical.functions.html#1cc9a099865f2e7454cc48caa63109e9">{splitbij</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#dRV_dom">dRV_dom</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:251">X</a></span>) <span class="id">&gt;-&gt;</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#range">range</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:251">X}</a></span> <span class="id">:=</span><br/>
&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Specif.html#projT2">projT2</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#dRV_dom_enum">dRV_dom_enum</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:251">X</a></span>).<br/>
<br/>
<span class="vernacular">Definition</span> <span id="enum_prob" class="id"><a name="enum_prob" class="">enum_prob</a></span> (<span id="X:252" class="id"><a name="X:252" class="">X</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#b5a1ea6c8f3277fde90807f8c5935ab3">{dRV</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#dRV_definitions.P">P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#b5a1ea6c8f3277fde90807f8c5935ab3">&gt;-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#dRV_definitions.R">R}</a></span>) <span class="id">:=</span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">fun</span> <span id="k:253" class="id"><a name="k:253" class="">k</a></span> <span class="id">=&gt;</span> <span class="id"><a href="mathcomp.analysis.probability.html#dRV_definitions.P">P</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#X:252">X</a></span> @<span class="id">^-1`</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#29c78c22490f2dae838b1b504eb858a2">[set</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#dRV_enum">dRV_enum</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:252">X</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#k:253">k]</a></span>)) <span class="id">\_</span> (<span class="id"><a href="mathcomp.analysis.probability.html#dRV_dom">dRV_dom</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:252">X</a></span>).<br/>
<br/>
<span class="vernacular">End</span> <span class="id"><a href="mathcomp.analysis.probability.html#dRV_definitions">dRV_definitions</a></span>.<br/>
<br/>
<span class="vernacular">Section</span> <span id="distribution_dRV" class="id"><a name="distribution_dRV" class="">distribution_dRV</a></span>.<br/>
<span class="vernacular">Local</span> <span class="vernacular">Open</span> <span class="vernacular">Scope</span> <span class="id">ereal_scope</span>.<br/>
<span class="vernacular">Context</span> <span id="d:254" class="id"><a name="d:254" class="">d</a></span> (<span id="T:255" class="id"><a name="T:255" class="">T</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.measure.html#Measurable.Exports.measurableType">measurableType</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#d:254">d</a></span>) (<span id="R:256" class="id"><a name="R:256" class="">R</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.reals.html#Real.Exports.realType">realType</a></span>) (<span id="P:257" class="id"><a name="P:257" class="">P</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.measure.html#Probability.Exports.probability">probability</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#T:255">T</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#R:256">R</a></span>).<br/>
<span class="vernacular">Variable</span> <span id="distribution_dRV.X" class="id"><a name="distribution_dRV.X" class="">X</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#b5a1ea6c8f3277fde90807f8c5935ab3">{dRV</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#distribution_dRV.P">P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#b5a1ea6c8f3277fde90807f8c5935ab3">&gt;-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#distribution_dRV.R">R}</a></span>.<br/>
<br/>
<span class="vernacular">Lemma</span> <span id="distribution_dRV_enum" class="id"><a name="distribution_dRV_enum" class="">distribution_dRV_enum</a></span> (<span id="n:259" class="id"><a name="n:259" class="">n</a></span> <span class="id">:</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#nat">nat</a></span>) <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#n:259">n</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7">\in</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#dRV_dom">dRV_dom</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#distribution_dRV.X">X</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#distribution">distribution</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#distribution_dRV.P">P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#distribution_dRV.X">X</a></span> <span class="id"><a href="mathcomp.classical.classical_sets.html#29c78c22490f2dae838b1b504eb858a2">[set</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#dRV_enum">dRV_enum</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#distribution_dRV.X">X</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#n:259">n]</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#enum_prob">enum_prob</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#distribution_dRV.X">X</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#n:259">n</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof51')">Proof.</span></div>
<div class="proofscript" id="proof51">
<span class="gallina-kwd">by</span> <span class="id">move=&gt;</span> <span class="id">nX;</span> <span class="id">rewrite</span> <span class="id">/distribution/=</span> <span class="id">/enum_prob/=</span> <span class="id"><a href="mathcomp.classical.functions.html#patchE">patchE</a></span> <span class="id">nX</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="distribution_dRV" class="id"><a name="distribution_dRV" class="">distribution_dRV</a></span> <span id="A:260" class="id"><a name="A:260" class="">A</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.measure.html#measurable">measurable</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#A:260">A</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#distribution">distribution</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#distribution_dRV.P">P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#distribution_dRV.X">X</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#A:260">A</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="mathcomp.analysis.sequences.html#acaaf5f54a6a8a222320424b6e0ccad5">\sum_</a></span>(<span id="k:263" class="id"><span id="k:262" class="id"><span id="k:261" class="id"><a name="k:263" class="">k</a></span></span></span> <span class="id"><a href="mathcomp.analysis.sequences.html#acaaf5f54a6a8a222320424b6e0ccad5">&lt;oo</a></span>) <span class="id"><a href="mathcomp.analysis.probability.html#enum_prob">enum_prob</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#distribution_dRV.X">X</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#k:261">k</a></span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#f1c2ddfea282f8f8d7539f61e14c08e4">*</a></span> <span class="id"><a href="mathcomp.analysis.measure.html#beb404b4c6e52afbdfec2979598a2318">\d_</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#dRV_enum">dRV_enum</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#distribution_dRV.X">X</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#k:261">k</a></span>) <span class="id"><a href="mathcomp.analysis.probability.html#A:260">A</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof52')">Proof.</span></div>
<div class="proofscript" id="proof52">
<span class="id">move=&gt;</span> <span class="id">mA;</span> <span class="id">rewrite</span> <span class="id">/distribution</span> <span class="id">/pushforward</span>.<br/>
<span class="id">have</span> <span class="id">mAX</span> <span class="id">i</span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#dRV_dom">dRV_dom</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#distribution_dRV.X">X</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#i:264">i</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.measure.html#measurable">measurable</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#distribution_dRV.X">X</a></span> @<span class="id">^-1`</span> (<span class="id">A</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#c7636f45aa1745dbf533da3d408cece1">`</a></span>&amp;<span class="id">`</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#29c78c22490f2dae838b1b504eb858a2">[set</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#dRV_enum">dRV_enum</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#distribution_dRV.X">X</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#i:264">i]</a></span>)).<br/>
&nbsp;&nbsp;<span class="id">move=&gt;</span> <span class="id">_;</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#preimage_setI">preimage_setI;</a></span> <span class="id">apply:</span> <span class="id"><a href="mathcomp.analysis.measure.html#measurableI">measurableI</a></span> <span class="id">=&gt;</span> <span class="id">//</span>.<br/>
&nbsp;&nbsp;<span class="id">exact/measurable_sfunP</span>.<br/>
<span class="id">have</span> <span class="id">tAX</span> <span class="id">:</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#trivIset">trivIset</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#dRV_dom">dRV_dom</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#distribution_dRV.X">X</a></span>) (<span class="gallina-kwd">fun</span> <span id="k:265" class="id"><a name="k:265" class="">k</a></span> <span class="id">=&gt;</span> <span class="id"><a href="mathcomp.analysis.probability.html#distribution_dRV.X">X</a></span> @<span class="id">^-1`</span> (<span class="id">A</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#c7636f45aa1745dbf533da3d408cece1">`</a></span>&amp;<span class="id">`</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#29c78c22490f2dae838b1b504eb858a2">[set</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#dRV_enum">dRV_enum</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#distribution_dRV.X">X</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#k:265">k]</a></span>)).<br/>
&nbsp;&nbsp;<span class="id">under</span> <span class="id"><a href="mathcomp.classical.boolp.html#eq_fun">eq_fun</a></span> <span class="id">do</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#preimage_setI">preimage_setI;</a></span> <span class="id">rewrite</span> <span class="id">-/</span>(<span class="id"><a href="mathcomp.classical.classical_sets.html#trivIset">trivIset</a></span> <span class="id">_</span> <span class="id">_</span>).<br/>
&nbsp;&nbsp;<span class="id">apply:</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#trivIset_setIl">trivIset_setIl;</a></span> <span class="id">apply/trivIsetP</span> <span class="id">=&gt;</span> <span class="id">i</span> <span class="id">j</span> <span class="id">iX</span> <span class="id">jX</span> <span class="id">/eqP</span> <span class="id">ij</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">-preimage_setI</span> (<span class="id">_</span> <span class="id">:</span> <span class="id">_</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#c7636f45aa1745dbf533da3d408cece1">`</a></span>&amp;<span class="id">`</span> <span class="id">_</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="mathcomp.classical.classical_sets.html#set0">set0</a></span>)<span class="id">//</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">apply/seteqP;</span> <span class="id">split</span> <span class="id">=&gt;</span> <span class="id">//=</span> <span class="id">x</span> <span class="id">[]</span> <span class="id">-&gt;</span> <span class="id">{x}</span> <span class="id">/inj;</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#inE">inE</a></span> <span class="id"><a href="mathcomp.classical.classical_sets.html#inE">inE</a></span> <span class="id">=&gt;</span> <span class="id">/</span>(<span class="id">_</span> <span class="id">iX</span> <span class="id">jX</span>).<br/>
<span class="id">have</span> <span class="id">:=</span> <span class="id"><a href="mathcomp.analysis.measure.html#measure_bigcup">measure_bigcup</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#distribution_dRV.P">P</a></span> <span class="id">_</span> (<span class="gallina-kwd">fun</span> <span id="k:266" class="id"><a name="k:266" class="">k</a></span> <span class="id">=&gt;</span> <span class="id"><a href="mathcomp.analysis.probability.html#distribution_dRV.X">X</a></span> @<span class="id">^-1`</span> (<span class="id">A</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#c7636f45aa1745dbf533da3d408cece1">`</a></span>&amp;<span class="id">`</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#29c78c22490f2dae838b1b504eb858a2">[set</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#dRV_enum">dRV_enum</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#distribution_dRV.X">X</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#k:266">k]</a></span>)) <span class="id">mAX</span> <span class="id">tAX</span>.<br/>
<span class="id">rewrite</span> <span class="id">-preimage_bigcup</span> <span class="id">=&gt;</span> <span class="id">{mAX</span> <span class="id">tAX}PXU</span>.<br/>
<span class="id">rewrite</span> <span class="id">-{1}</span>(<span class="id"><a href="mathcomp.classical.classical_sets.html#setIT">setIT</a></span> <span class="id">A</span>) <span class="id">-</span>(<span class="id"><a href="mathcomp.classical.classical_sets.html#setUv">setUv</a></span> (<span class="id"><a href="mathcomp.classical.classical_sets.html#6c1866a3b78974b64276da9cd4d63a55">\bigcup_</a></span>(<span id="i:269" class="id"><span id="i:268" class="id"><span id="i:267" class="id"><a name="i:269" class="">i</a></span></span></span> <span class="gallina-kwd">in</span> <span class="id"><a href="mathcomp.analysis.probability.html#dRV_dom">dRV_dom</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#distribution_dRV.X">X</a></span>) <span class="id"><a href="mathcomp.classical.classical_sets.html#29c78c22490f2dae838b1b504eb858a2">[set</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#dRV_enum">dRV_enum</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#distribution_dRV.X">X</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#i:267">i]</a></span>)).<br/>
<span class="id">rewrite</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setIUr">setIUr</a></span> <span class="id"><a href="mathcomp.classical.classical_sets.html#preimage_setU">preimage_setU</a></span> <span class="id"><a href="mathcomp.analysis.measure.html#measureU">measureU;</a></span> <span class="id">last</span> <span class="id">3</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;<span class="id">-</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#preimage_setI">preimage_setI;</a></span> <span class="id">apply:</span> <span class="id"><a href="mathcomp.analysis.measure.html#measurableI">measurableI</a></span> <span class="id">=&gt;</span> <span class="id">//</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exact:</span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#measurable_sfunP">measurable_sfunP</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">apply:</span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#measurable_sfunP">measurable_sfunP;</a></span> <span class="id">exact:</span> <span class="id"><a href="mathcomp.analysis.measure.html#bigcup_measurable">bigcup_measurable</a></span>.<br/>
&nbsp;&nbsp;<span class="id">-</span> <span class="id">apply:</span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#measurable_sfunP">measurable_sfunP;</a></span> <span class="id">apply:</span> <span class="id"><a href="mathcomp.analysis.measure.html#measurableI">measurableI</a></span> <span class="id">=&gt;</span> <span class="id">//</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">apply:</span> <span class="id"><a href="mathcomp.analysis.measure.html#measurableC">measurableC;</a></span> <span class="id">exact:</span> <span class="id"><a href="mathcomp.analysis.measure.html#bigcup_measurable">bigcup_measurable</a></span>.<br/>
&nbsp;&nbsp;<span class="id">-</span> <span class="id">rewrite</span> <span class="id">2!preimage_setI</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setIACA">setIACA</a></span> <span class="id">-!setIA</span> <span class="id">-preimage_setI</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setICr">setICr</a></span> <span class="id"><a href="mathcomp.classical.classical_sets.html#preimage_set0">preimage_set0</a></span> <span class="id">2!setI0</span>.<br/>
<span class="id">rewrite</span> <span class="id">[X</span> <span class="gallina-kwd">in</span> <span class="id">_</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#d4965da372b2485934ec33867ee5fbe7">+</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#distribution_dRV.X">X</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id">_]</span>(<span class="id">_</span> <span class="id">:</span> <span class="id">_</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id">0</span>) <span class="id">?adde0;</span> <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> (<span class="id">_</span> <span class="id">:</span> <span class="id">_</span> @<span class="id">^-1`</span> <span class="id">_</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="mathcomp.classical.classical_sets.html#set0">set0</a></span>) <span class="id">?measure0//;</span> <span class="id">apply/disjoints_subset</span> <span class="id">=&gt;</span> <span class="id">x</span> <span class="id">AXx</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setCK">setCK</a></span> <span class="id">/bigcup</span> <span class="id">/=;</span> <span class="gallina-kwd">exists</span> ((<span class="id"><a href="mathcomp.analysis.probability.html#dRV_enum">dRV_enum</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#distribution_dRV.X">X</a></span>)<span class="id">^-1</span> (<span class="id"><a href="mathcomp.analysis.probability.html#distribution_dRV.X">X</a></span> <span class="id">x</span>))%<span class="id">function</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exact:</span> <span class="id"><a href="mathcomp.classical.functions.html#funS">funS</a></span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.classical.functions.html#invK">invK//</a></span> <span class="id"><a href="mathcomp.classical.classical_sets.html#inE">inE</a></span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setI_bigcupr">setI_bigcupr;</a></span> <span class="id">etransitivity;</span> <span class="id">first</span> <span class="id">exact:</span> <span class="id">PXU</span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.sequences.html#eseries_mkcond">eseries_mkcond;</a></span> <span class="id">apply:</span> <span class="id"><a href="mathcomp.analysis.sequences.html#eq_eseriesr">eq_eseriesr</a></span> <span class="id">=&gt;</span> <span class="id">k</span> <span class="id">_</span>.<br/>
<span class="id">rewrite</span> <span class="id">/enum_prob</span> <span class="id"><a href="mathcomp.classical.functions.html#patchE">patchE;</a></span> <span class="id">case:</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#ifPn">ifPn</a></span> <span class="id">=&gt;</span> <span class="id">nX;</span> <span class="id">rewrite</span> <span class="id">?mul0e//</span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.measure.html#diracE">diracE;</a></span> <span class="id">have</span> <span class="id">[kA|]</span> <span class="id">:=</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#boolP">boolP</a></span> (<span class="id">_</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7">\in</a></span> <span class="id">A</span>).<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#mule1">mule1</a></span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setIidr">setIidr//</a></span> <span class="id">=&gt;</span> <span class="id">_</span> <span class="id">/=</span> <span class="id">-&gt;;</span> <span class="id">exact:</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#set_mem">set_mem</a></span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#notin_setE">notin_setE</a></span> <span class="id">=&gt;</span> <span class="id">kA</span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#mule0">mule0</a></span> (<span class="id"><a href="mathcomp.classical.classical_sets.html#disjoints_subset">disjoints_subset</a></span> <span class="id">_</span> <span class="id">_</span>).<span class="id">2</span> <span class="id">?preimage_set0</span> <span class="id">?measure0//</span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">apply:</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#subsetCr">subsetCr;</a></span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#sub1set">sub1set</a></span> <span class="id"><a href="mathcomp.classical.classical_sets.html#inE">inE</a></span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="sum_enum_prob" class="id"><a name="sum_enum_prob" class="">sum_enum_prob</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.sequences.html#acaaf5f54a6a8a222320424b6e0ccad5">\sum_</a></span>(<span id="n:273" class="id"><span id="n:272" class="id"><span id="n:271" class="id"><a name="n:273" class="">n</a></span></span></span> <span class="id"><a href="mathcomp.analysis.sequences.html#acaaf5f54a6a8a222320424b6e0ccad5">&lt;oo</a></span>) (<span class="id"><a href="mathcomp.analysis.probability.html#enum_prob">enum_prob</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#distribution_dRV.X">X</a></span>) <span class="id"><a href="mathcomp.analysis.probability.html#n:271">n</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id">1</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof53')">Proof.</span></div>
<div class="proofscript" id="proof53">
<span class="id">have</span> <span class="id">:=</span> <span class="id"><a href="mathcomp.analysis.probability.html#distribution_dRV">distribution_dRV</a></span> <span class="id"><a href="mathcomp.analysis.measure.html#measurableT">measurableT</a></span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.measure.html#probability_setT">probability_setT/=</a></span> <span class="id">=&gt;</span> <span class="id">/esym;</span> <span class="id">apply:</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#eq_trans">eq_trans</a></span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">[RHS]eseries_mkcond;</span> <span class="id">apply:</span> <span class="id"><a href="mathcomp.analysis.sequences.html#eq_eseriesr">eq_eseriesr</a></span> <span class="id">=&gt;</span> <span class="id">k</span> <span class="id">_;</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.measure.html#diracT">diracT</a></span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#mule1">mule1</a></span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">End</span> <span class="id"><a href="mathcomp.analysis.probability.html#distribution_dRV">distribution_dRV</a></span>.<br/>
<br/>
<span class="vernacular">Section</span> <span id="discrete_distribution" class="id"><a name="discrete_distribution" class="">discrete_distribution</a></span>.<br/>
<span class="vernacular">Local</span> <span class="vernacular">Open</span> <span class="vernacular">Scope</span> <span class="id">ereal_scope</span>.<br/>
<span class="vernacular">Context</span> <span id="d:274" class="id"><a name="d:274" class="">d</a></span> (<span id="T:275" class="id"><a name="T:275" class="">T</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.measure.html#Measurable.Exports.measurableType">measurableType</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#d:274">d</a></span>) (<span id="R:276" class="id"><a name="R:276" class="">R</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.reals.html#Real.Exports.realType">realType</a></span>) (<span id="P:277" class="id"><a name="P:277" class="">P</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.measure.html#Probability.Exports.probability">probability</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#T:275">T</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#R:276">R</a></span>).<br/>
<br/>
<span class="vernacular">Lemma</span> <span id="dRV_expectation" class="id"><a name="dRV_expectation" class="">dRV_expectation</a></span> (<span id="X:278" class="id"><a name="X:278" class="">X</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#b5a1ea6c8f3277fde90807f8c5935ab3">{dRV</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#discrete_distribution.P">P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#b5a1ea6c8f3277fde90807f8c5935ab3">&gt;-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#discrete_distribution.R">R}</a></span>) <span class="id">:</span><br/>
&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#discrete_distribution.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#36b9f1631384d2c3b944cb9d5855cd98">[set:</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#discrete_distribution.T">T]</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.ssrfun.html#687e14754dadb7c0b04f27d8f71d2638">\o</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:278">X</a></span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#69ec4e730a589c79df0349357bb8311f">'E_P[X]</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="mathcomp.analysis.sequences.html#acaaf5f54a6a8a222320424b6e0ccad5">\sum_</a></span>(<span id="n:281" class="id"><span id="n:280" class="id"><span id="n:279" class="id"><a name="n:281" class="">n</a></span></span></span> <span class="id"><a href="mathcomp.analysis.sequences.html#acaaf5f54a6a8a222320424b6e0ccad5">&lt;oo</a></span>) <span class="id"><a href="mathcomp.analysis.probability.html#enum_prob">enum_prob</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:278">X</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#n:279">n</a></span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#f1c2ddfea282f8f8d7539f61e14c08e4">*</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#dRV_enum">dRV_enum</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:278">X</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#n:279">n</a></span>)%<span class="id">:E</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof54')">Proof.</span></div>
<div class="proofscript" id="proof54">
<span class="id">move=&gt;</span> <span class="id">ix;</span> <span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssreflect.html#unlock">unlock</a></span>.<br/>
<span class="id">rewrite</span> <span class="id">-[in</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssrmatching.ssrmatching.html#SsrMatchingSyntax.LHS">LHS]</a></span>(<span class="id">_</span> <span class="id">:</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#4652af423267d4923a164c1104e1273f">\bigcup_k</a></span> (<span class="gallina-kwd">if</span> <span class="id"><a href="mathcomp.analysis.probability.html#k:282">k</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7">\in</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#dRV_dom">dRV_dom</a></span> <span class="id">X</span> <span class="gallina-kwd">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">X</span> @<span class="id">^-1`</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#29c78c22490f2dae838b1b504eb858a2">[set</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#dRV_enum">dRV_enum</a></span> <span class="id">X</span> <span class="id"><a href="mathcomp.analysis.probability.html#k:282">k]</a></span> <span class="gallina-kwd">else</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#set0">set0</a></span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span>)<span class="id">;</span> <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;<span class="id">apply/seteqP;</span> <span class="id">split</span> <span class="id">=&gt;</span> <span class="id">//</span> <span class="id">t</span> <span class="id">_</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">exists</span> ((<span class="id"><a href="mathcomp.analysis.probability.html#dRV_enum">dRV_enum</a></span> <span class="id">X</span>)<span class="id">^-1</span>%<span class="id">function</span> (<span class="id">X</span> <span class="id">t</span>)) <span class="id">=&gt;</span> <span class="id">//</span>.<br/>
&nbsp;&nbsp;<span class="id">case:</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#ifPn">ifPn=&gt;</a></span> <span class="id">[_|]</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.classical.functions.html#invK">invK//</a></span> <span class="id"><a href="mathcomp.classical.classical_sets.html#inE">inE</a></span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#notin_setE">notin_setE/=;</a></span> <span class="id">apply;</span> <span class="id">apply:</span> <span class="id"><a href="mathcomp.classical.functions.html#funS">funS</a></span>.<br/>
<span class="id">have</span> <span class="id">tA</span> <span class="id">:</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#trivIset">trivIset</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#dRV_dom">dRV_dom</a></span> <span class="id">X</span>) (<span class="gallina-kwd">fun</span> <span id="k:285" class="id"><a name="k:285" class="">k</a></span> <span class="id">=&gt;</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#29c78c22490f2dae838b1b504eb858a2">[set</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#dRV_enum">dRV_enum</a></span> <span class="id">X</span> <span class="id"><a href="mathcomp.analysis.probability.html#k:285">k]</a></span>).<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">move=&gt;</span> <span class="id">i</span> <span class="id">j</span> <span class="id">iX</span> <span class="id">jX</span> <span class="id">[r</span> <span class="id">[/=</span> <span class="id">-&gt;{r}]]</span> <span class="id">/inj;</span> <span class="id">rewrite</span> <span class="id">!inE;</span> <span class="id">exact</span>.<br/>
<span class="id">have</span> <span class="id">{tA}/trivIset_mkcond</span> <span class="id">tXA</span> <span class="id">:</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="mathcomp.classical.classical_sets.html#trivIset">trivIset</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#dRV_dom">dRV_dom</a></span> <span class="id">X</span>) (<span class="gallina-kwd">fun</span> <span id="k:286" class="id"><a name="k:286" class="">k</a></span> <span class="id">=&gt;</span> <span class="id">X</span> @<span class="id">^-1`</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#29c78c22490f2dae838b1b504eb858a2">[set</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#dRV_enum">dRV_enum</a></span> <span class="id">X</span> <span class="id"><a href="mathcomp.analysis.probability.html#k:286">k]</a></span>).<br/>
&nbsp;&nbsp;<span class="id">apply/trivIsetP</span> <span class="id">=&gt;</span> <span class="id">/=</span> <span class="id">i</span> <span class="id">j</span> <span class="id">iX</span> <span class="id">jX</span> <span class="id">ij</span>.<br/>
&nbsp;&nbsp;<span class="id">move/trivIsetP</span> <span class="id">:</span> <span class="id">tA</span> <span class="id">=&gt;</span> <span class="id">/</span>(<span class="id">_</span> <span class="id">i</span> <span class="id">j</span> <span class="id">iX</span> <span class="id">jX</span>) <span class="id">Aij</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">-preimage_setI</span> <span class="id">Aij</span> <span class="id">?preimage_set0</span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#integral_bigcup">integral_bigcup</a></span> <span class="id">//;</span> <span class="id">last</span> <span class="id">2</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;<span class="id">-</span> <span class="gallina-kwd">by</span> <span class="id">move=&gt;</span> <span class="id">k;</span> <span class="id">case:</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#ifPn">ifPn</a></span>.<br/>
&nbsp;&nbsp;<span class="id">-</span> <span class="id">apply:</span> (<span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#integrableS">integrableS</a></span> <span class="id"><a href="mathcomp.analysis.measure.html#measurableT">measurableT</a></span>) <span class="id">=&gt;</span> <span class="id">//</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">-bigcup_mkcond;</span> <span class="id">exact:</span> <span class="id"><a href="mathcomp.analysis.measure.html#bigcup_measurable">bigcup_measurable</a></span>.<br/>
<span class="id">transitivity</span> (<span class="id"><a href="mathcomp.analysis.sequences.html#acaaf5f54a6a8a222320424b6e0ccad5">\sum_</a></span>(<span id="i:293" class="id"><span id="i:292" class="id"><span id="i:291" class="id"><span id="i:289" class="id"><span id="i:288" class="id"><span id="i:287" class="id"><a name="i:293" class="">i</a></span></span></span></span></span></span> <span class="id"><a href="mathcomp.analysis.sequences.html#acaaf5f54a6a8a222320424b6e0ccad5">&lt;oo</a></span>)<br/>
&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#871f2882c0e95b3d1e1d20f0a4fbdef3">\int[P]_</a></span>(<span id="x:294" class="id"><span id="x:290" class="id"><a name="x:294" class="">x</a></span></span> <span class="gallina-kwd">in</span> (<span class="gallina-kwd">if</span> <span class="id"><a href="mathcomp.analysis.probability.html#i:287">i</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7">\in</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#dRV_dom">dRV_dom</a></span> <span class="id">X</span> <span class="gallina-kwd">then</span> <span class="id">X</span> @<span class="id">^-1`</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#29c78c22490f2dae838b1b504eb858a2">[set</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#dRV_enum">dRV_enum</a></span> <span class="id">X</span> <span class="id"><a href="mathcomp.analysis.probability.html#i:287">i]</a></span> <span class="gallina-kwd">else</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#set0">set0</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="mathcomp.analysis.probability.html#dRV_enum">dRV_enum</a></span> <span class="id">X</span> <span class="id"><a href="mathcomp.analysis.probability.html#i:287">i</a></span>)%<span class="id">:E</span>).<br/>
&nbsp;&nbsp;<span class="id">apply:</span> <span class="id"><a href="mathcomp.analysis.sequences.html#eq_eseriesr">eq_eseriesr</a></span> <span class="id">=&gt;</span> <span class="id">i</span> <span class="id">_;</span> <span class="id">case:</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#ifPn">ifPn</a></span> <span class="id">=&gt;</span> <span class="id">iX</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">apply:</span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#eq_integral">eq_integral</a></span> <span class="id">=&gt;</span> <span class="id">t;</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#in_setE">in_setE/=</a></span> <span class="id">=&gt;</span> <span class="id">-&gt;</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">!integral_set0</span>.<br/>
<span class="id">transitivity</span> (<span class="id"><a href="mathcomp.analysis.sequences.html#acaaf5f54a6a8a222320424b6e0ccad5">\sum_</a></span>(<span id="i:301" class="id"><span id="i:300" class="id"><span id="i:299" class="id"><span id="i:297" class="id"><span id="i:296" class="id"><span id="i:295" class="id"><a name="i:301" class="">i</a></span></span></span></span></span></span> <span class="id"><a href="mathcomp.analysis.sequences.html#acaaf5f54a6a8a222320424b6e0ccad5">&lt;oo</a></span>) (<span class="id"><a href="mathcomp.analysis.probability.html#dRV_enum">dRV_enum</a></span> <span class="id">X</span> <span class="id"><a href="mathcomp.analysis.probability.html#i:295">i</a></span>)%<span class="id">:E</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#f1c2ddfea282f8f8d7539f61e14c08e4">*</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#871f2882c0e95b3d1e1d20f0a4fbdef3">\int[P]_</a></span>(<span id="x:302" class="id"><span id="x:298" class="id"><a name="x:302" class="">x</a></span></span> <span class="gallina-kwd">in</span> (<span class="gallina-kwd">if</span> <span class="id"><a href="mathcomp.analysis.probability.html#i:295">i</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7">\in</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#dRV_dom">dRV_dom</a></span> <span class="id">X</span> <span class="gallina-kwd">then</span> <span class="id">X</span> @<span class="id">^-1`</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#29c78c22490f2dae838b1b504eb858a2">[set</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#dRV_enum">dRV_enum</a></span> <span class="id">X</span> <span class="id"><a href="mathcomp.analysis.probability.html#i:295">i]</a></span> <span class="gallina-kwd">else</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#set0">set0</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">1</span>).<br/>
&nbsp;&nbsp;<span class="id">apply:</span> <span class="id"><a href="mathcomp.analysis.sequences.html#eq_eseriesr">eq_eseriesr</a></span> <span class="id">=&gt;</span> <span class="id">i</span> <span class="id">_;</span> <span class="id">rewrite</span> <span class="id">-integralZl//;</span> <span class="id">last</span> <span class="id">2</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">-</span> <span class="gallina-kwd">by</span> <span class="id">case:</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#ifPn">ifPn</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">-</span> <span class="id">apply/integrableP;</span> <span class="id">split</span> <span class="id">=&gt;</span> <span class="id">//</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> (<span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#eq_integral">eq_integral</a></span> (<span class="id"><a href="mathcomp.classical.functions.html#cst">cst</a></span> <span class="id">1</span>%<span class="id">E</span>))<span class="id">;</span> <span class="id">last</span> <span class="gallina-kwd">by</span> <span class="id">move=&gt;</span> <span class="id">x</span> <span class="id">_;</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#abse1">abse1</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#integral_cst">integral_cst//;</a></span> <span class="id">last</span> <span class="gallina-kwd">by</span> <span class="id">case:</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#ifPn">ifPn</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#mul1e">mul1e</a></span> (@<span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.order.html#Order.POrderTheory.le_lt_trans">le_lt_trans</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">1</span>%<span class="id">E</span>) <span class="id">?ltey//</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">case:</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#ifPn">ifPn</a></span> <span class="id">=&gt;</span> <span class="id">//</span> <span class="id">_;</span> <span class="id">exact:</span> <span class="id"><a href="mathcomp.analysis.measure.html#probability_le1">probability_le1</a></span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">apply:</span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#eq_integral">eq_integral</a></span> <span class="id">=&gt;</span> <span class="id">y</span> <span class="id">_;</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#mule1">mule1</a></span>.<br/>
<span class="id">apply:</span> <span class="id"><a href="mathcomp.analysis.sequences.html#eq_eseriesr">eq_eseriesr</a></span> <span class="id">=&gt;</span> <span class="id">k</span> <span class="id">_;</span> <span class="id">case:</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#ifPn">ifPn</a></span> <span class="id">=&gt;</span> <span class="id">kX</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">/=</span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#integral_cst">integral_cst//=</a></span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#mul1e">mul1e</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#probability_distribution">probability_distribution</a></span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#muleC">muleC</a></span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.probability.html#distribution_dRV_enum">distribution_dRV_enum</a></span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#integral_set0">integral_set0</a></span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#mule0">mule0</a></span> <span class="id">/enum_prob</span> <span class="id"><a href="mathcomp.classical.functions.html#patchE">patchE</a></span> (<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#negbTE">negbTE</a></span> <span class="id">kX</span>) <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#mul0e">mul0e</a></span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Definition</span> <span id="pmf" class="id"><a name="pmf" class="">pmf</a></span> (<span id="X:303" class="id"><a name="X:303" class="">X</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#31c5002a151d32a5908113f99aedfaa1">{RV</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#discrete_distribution.P">P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#31c5002a151d32a5908113f99aedfaa1">&gt;-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#discrete_distribution.R">R}</a></span>) (<span id="r:304" class="id"><a name="r:304" class="">r</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#discrete_distribution.R">R</a></span>) <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#discrete_distribution.R">R</a></span> <span class="id">:=</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#fine">fine</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#discrete_distribution.P">P</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#X:303">X</a></span> @<span class="id">^-1`</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#29c78c22490f2dae838b1b504eb858a2">[set</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#r:304">r]</a></span>)).<br/>
<br/>
<span class="vernacular">Lemma</span> <span id="expectation_pmf" class="id"><a name="expectation_pmf" class="">expectation_pmf</a></span> (<span id="X:305" class="id"><a name="X:305" class="">X</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#b5a1ea6c8f3277fde90807f8c5935ab3">{dRV</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#discrete_distribution.P">P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#b5a1ea6c8f3277fde90807f8c5935ab3">&gt;-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#discrete_distribution.R">R}</a></span>) <span class="id">:</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#discrete_distribution.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#36b9f1631384d2c3b944cb9d5855cd98">[set:</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#discrete_distribution.T">T]</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.ssrfun.html#687e14754dadb7c0b04f27d8f71d2638">\o</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:305">X</a></span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#69ec4e730a589c79df0349357bb8311f">'E_P[X]</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.sequences.html#ffadba069702e9e7be8bc2674b4cdf45">\sum_</a></span>(<span id="n:308" class="id"><span id="n:307" class="id"><span id="n:306" class="id"><a name="n:308" class="">n</a></span></span></span> <span class="id"><a href="mathcomp.analysis.sequences.html#ffadba069702e9e7be8bc2674b4cdf45">&lt;oo</a></span> <span class="id">|</span> <span class="id"><a href="mathcomp.analysis.probability.html#n:306">n</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7">\in</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#dRV_dom">dRV_dom</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:305">X</a></span>) (<span class="id"><a href="mathcomp.analysis.probability.html#pmf">pmf</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:305">X</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#dRV_enum">dRV_enum</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:305">X</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#n:306">n</a></span>))%<span class="id">:E</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#f1c2ddfea282f8f8d7539f61e14c08e4">*</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#dRV_enum">dRV_enum</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:305">X</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#n:306">n</a></span>)%<span class="id">:E</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof55')">Proof.</span></div>
<div class="proofscript" id="proof55">
<span class="id">move=&gt;</span> <span class="id">iX;</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.probability.html#dRV_expectation">dRV_expectation//</a></span> <span class="id">[in</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssrmatching.ssrmatching.html#SsrMatchingSyntax.RHS">RHS]eseries_mkcond</a></span>.<br/>
<span class="id">apply:</span> <span class="id"><a href="mathcomp.analysis.sequences.html#eq_eseriesr">eq_eseriesr</a></span> <span class="id">=&gt;</span> <span class="id">k</span> <span class="id">_</span>.<br/>
<span class="id">rewrite</span> <span class="id">/enum_prob</span> <span class="id"><a href="mathcomp.classical.functions.html#patchE">patchE;</a></span> <span class="id">case:</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#ifPn">ifPn</a></span> <span class="id">=&gt;</span> <span class="id">kX;</span> <span class="id">last</span> <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#mul0e">mul0e</a></span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">/pmf</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#fineK">fineK//</a></span> <span class="id"><a href="mathcomp.analysis.measure.html#fin_num_measure">fin_num_measure</a></span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">End</span> <span class="id"><a href="mathcomp.analysis.probability.html#discrete_distribution">discrete_distribution</a></span>.<br/>
<br/>
<span class="vernacular">Section</span> <span id="bernoulli_pmf" class="id"><a name="bernoulli_pmf" class="">bernoulli_pmf</a></span>.<br/>
<span class="vernacular">Context</span> <span class="id">{R</span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.reals.html#Real.Exports.realType">realType}</a></span> (<span id="p:310" class="id"><a name="p:310" class="">p</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#R:309">R</a></span>).<br/>
<span class="vernacular">Local</span> <span class="vernacular">Open</span> <span class="vernacular">Scope</span> <span class="id">ring_scope</span>.<br/>
<br/>
<span class="vernacular">Definition</span> <span id="bernoulli_pmf" class="id"><a name="bernoulli_pmf" class="">bernoulli_pmf</a></span> <span id="b:311" class="id"><a name="b:311" class="">b</a></span> <span class="id">:=</span> <span class="gallina-kwd">if</span> <span class="id"><a href="mathcomp.analysis.probability.html#b:311">b</a></span> <span class="gallina-kwd">then</span> <span class="id"><a href="mathcomp.analysis.probability.html#bernoulli_pmf.p">p</a></span> <span class="gallina-kwd">else</span> <span class="id">1</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#::ring_scope:x_'-'_x">-</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#bernoulli_pmf.p">p</a></span>.<br/>
<br/>
<span class="vernacular">Lemma</span> <span id="bernoulli_pmf_ge0" class="id"><a name="bernoulli_pmf_ge0" class="">bernoulli_pmf_ge0</a></span> (<span id="p01:312" class="id"><a name="p01:312" class="">p01</a></span> <span class="id">:</span> <span class="id">0</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssrnum.html#5285549f1bd0c3f181a17cc59d549bc0">&lt;=</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#bernoulli_pmf.p">p</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssrnum.html#5285549f1bd0c3f181a17cc59d549bc0">&lt;=</a></span> <span class="id">1</span>) <span id="b:313" class="id"><a name="b:313" class="">b</a></span> <span class="id">:</span> <span class="id">0</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssrnum.html#cb42ec59ad57b25928e1718b4e69e031">&lt;=</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#bernoulli_pmf">bernoulli_pmf</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#b:313">b</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof56')">Proof.</span></div>
<div class="proofscript" id="proof56">
<span class="id">rewrite</span> <span class="id">/bernoulli_pmf</span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">move:</span> <span class="id">p01</span> <span class="id">=&gt;</span> <span class="id">/andP[p0</span> <span class="id">p1];</span> <span class="id">case:</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#ifPn">ifPn</a></span> <span class="id">=&gt;</span> <span class="id">//</span> <span class="id">_;</span> <span class="id">rewrite</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssrnum.html#Num.Theory.subr_ge0">subr_ge0</a></span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="bernoulli_pmf1" class="id"><a name="bernoulli_pmf1" class="">bernoulli_pmf1</a></span> (<span id="p01:314" class="id"><a name="p01:314" class="">p01</a></span> <span class="id">:</span> <span class="id">0</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssrnum.html#5285549f1bd0c3f181a17cc59d549bc0">&lt;=</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#bernoulli_pmf.p">p</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssrnum.html#5285549f1bd0c3f181a17cc59d549bc0">&lt;=</a></span> <span class="id">1</span>) <span class="id">:</span><br/>
&nbsp;&nbsp;<span class="id"><a href="mathcomp.classical.fsbigop.html#66bb639f4673920039e1c5f4f74ee386">\sum_</a></span>(<span id="i:318" class="id"><span id="i:317" class="id"><span id="i:316" class="id"><span id="i:315" class="id"><a name="i:318" class="">i</a></span></span></span></span> <span class="id"><a href="mathcomp.classical.fsbigop.html#66bb639f4673920039e1c5f4f74ee386">\in</a></span> <span class="id"><a href="mathcomp.classical.classical_sets.html#36b9f1631384d2c3b944cb9d5855cd98">[set:</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#bool">bool]</a></span>) (<span class="id"><a href="mathcomp.analysis.probability.html#bernoulli_pmf">bernoulli_pmf</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#i:315">i</a></span>)%<span class="id">:E</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id">1</span>%<span class="id">E</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof57')">Proof.</span></div>
<div class="proofscript" id="proof57">
<span class="id">rewrite</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT_bool">setT_bool</a></span> <span class="id"><a href="mathcomp.classical.fsbigop.html#fsbigU">fsbigU//=;</a></span> <span class="id">last</span> <span class="gallina-kwd">by</span> <span class="id">move=&gt;</span> <span class="id">x</span> <span class="id">[/=</span> <span class="id">-&gt;]</span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">!fsbig_set1/=</span> <span class="id">-EFinD</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#GRing.Theory.addrCA">addrCA</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#GRing.Theory.subrr">subrr</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#GRing.Theory.addr0">addr0</a></span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">End</span> <span class="id"><a href="mathcomp.analysis.probability.html#bernoulli_pmf">bernoulli_pmf</a></span>.<br/>
<br/>
<span class="vernacular">Lemma</span> <span id="measurable_bernoulli_pmf" class="id"><a name="measurable_bernoulli_pmf" class="">measurable_bernoulli_pmf</a></span> <span class="id">{R</span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.reals.html#Real.Exports.realType">realType}</a></span> <span id="D:320" class="id"><a name="D:320" class="">D</a></span> <span id="n:321" class="id"><a name="n:321" class="">n</a></span> <span class="id">:</span><br/>
&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.measure.html#measurable_fun">measurable_fun</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#D:320">D</a></span> (@<span class="id"><a href="mathcomp.analysis.probability.html#bernoulli_pmf">bernoulli_pmf</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#R:319">R</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.ssrfun.html#3dce462f8124648b906d1e347a73bb9f">^~</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#n:321">n</a></span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof58')">Proof.</span></div>
<div class="proofscript" id="proof58">
<span class="gallina-kwd">by</span> <span class="id">apply/measurable_funTS/measurable_fun_if</span> <span class="id">=&gt;</span> <span class="id">//=;</span> <span class="id">exact:</span> <span class="id"><a href="mathcomp.analysis.lebesgue_measure.html#measurable_funB">measurable_funB</a></span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Definition</span> <span id="bernoulli" class="id"><a name="bernoulli" class="">bernoulli</a></span> <span class="id">{R</span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.reals.html#Real.Exports.realType">realType}</a></span> (<span id="p:323" class="id"><a name="p:323" class="">p</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#R:322">R</a></span>) <span class="id">:</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#set">set</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#bool">bool</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#4c9ddfb63ff52527d9adecfde4a667c3">\bar</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#R:322">R</a></span> <span class="id">:=</span> <span class="gallina-kwd">fun</span> <span id="A:324" class="id"><a name="A:324" class="">A</a></span> <span class="id">=&gt;</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">if</span> (<span class="id">0</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssrnum.html#5285549f1bd0c3f181a17cc59d549bc0">&lt;=</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#p:323">p</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssrnum.html#5285549f1bd0c3f181a17cc59d549bc0">&lt;=</a></span> <span class="id">1</span>)%<span class="id">R</span> <span class="gallina-kwd">then</span> <span class="id"><a href="mathcomp.classical.fsbigop.html#66bb639f4673920039e1c5f4f74ee386">\sum_</a></span>(<span id="b:328" class="id"><span id="b:327" class="id"><span id="b:326" class="id"><span id="b:325" class="id"><a name="b:328" class="">b</a></span></span></span></span> <span class="id"><a href="mathcomp.classical.fsbigop.html#66bb639f4673920039e1c5f4f74ee386">\in</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#A:324">A</a></span>) (<span class="id"><a href="mathcomp.analysis.probability.html#bernoulli_pmf">bernoulli_pmf</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#p:323">p</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#b:325">b</a></span>)%<span class="id">:E</span> <span class="gallina-kwd">else</span> <span class="id"><a href="mathcomp.analysis.measure.html#beb404b4c6e52afbdfec2979598a2318">\d_false</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#A:324">A</a></span>.<br/>
<br/>
<span class="vernacular">Section</span> <span id="bernoulli" class="id"><a name="bernoulli" class="">bernoulli</a></span>.<br/>
<span class="vernacular">Context</span> <span class="id">{R</span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.reals.html#Real.Exports.realType">realType}</a></span> (<span id="p:330" class="id"><a name="p:330" class="">p</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#R:329">R</a></span>).<br/>
<br/>
<span class="vernacular">Local</span> <span class="vernacular">Notation</span> <span id="bernoulli" class="id"><a name="bernoulli" class="">bernoulli</a></span> <span class="id">:=</span> (<span class="id"><a href="mathcomp.analysis.probability.html#bernoulli">bernoulli</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#bernoulli.p">p</a></span>).<br/>
<br/>
<span class="vernacular">Let</span> <span id="bernoulli.bernoulli0" class="id"><a name="bernoulli.bernoulli0" class="">bernoulli0</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#bernoulli">bernoulli</a></span> <span class="id"><a href="mathcomp.classical.classical_sets.html#set0">set0</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id">0</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof59')">Proof.</span></div>
<div class="proofscript" id="proof59">
<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">/bernoulli;</span> <span class="id">case:</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#ifPn">ifPn</a></span> <span class="id">=&gt;</span> <span class="id">//</span> <span class="id">p01;</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.classical.fsbigop.html#fsbig_set0">fsbig_set0</a></span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Let</span> <span id="bernoulli.bernoulli_ge0" class="id"><a name="bernoulli.bernoulli_ge0" class="">bernoulli_ge0</a></span> <span id="U:331" class="id"><a name="U:331" class="">U</a></span> <span class="id">:</span> (<span class="id">0</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#63b01a542aec2e4c61e028256cf5a548">&lt;=</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#bernoulli">bernoulli</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#U:331">U</a></span>)%<span class="id">E</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof60')">Proof.</span></div>
<div class="proofscript" id="proof60">
<span class="id">rewrite</span> <span class="id">/bernoulli;</span> <span class="id">case:</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#ifPn">ifPn</a></span> <span class="id">=&gt;</span> <span class="id">//</span> <span class="id">p01</span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="mathcomp.classical.fsbigop.html#fsbig_finite">fsbig_finite//=</a></span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#sumEFin">sumEFin</a></span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#lee_fin">lee_fin</a></span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">apply:</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssrnum.html#Num.Theory.sumr_ge0">sumr_ge0</a></span> <span class="id">=&gt;</span> <span class="id">/=</span> <span class="id">b</span> <span class="id">_;</span> <span class="id">exact:</span> <span class="id"><a href="mathcomp.analysis.probability.html#bernoulli_pmf_ge0">bernoulli_pmf_ge0</a></span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Let</span> <span id="bernoulli.bernoulli_sigma_additive" class="id"><a name="bernoulli.bernoulli_sigma_additive" class="">bernoulli_sigma_additive</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.measure.html#semi_sigma_additive">semi_sigma_additive</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#bernoulli">bernoulli</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof61')">Proof.</span></div>
<div class="proofscript" id="proof61">
<span class="id">move=&gt;</span> <span class="id">F</span> <span class="id">mF</span> <span class="id">tF</span> <span class="id">mUF;</span> <span class="id">rewrite</span> <span class="id">/bernoulli;</span> <span class="id">case:</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#ifPn">ifPn</a></span> <span class="id">=&gt;</span> <span class="id">p01;</span> <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;<span class="id">exact:</span> <span class="id"><a href="mathcomp.analysis.measure.html#measure_semi_sigma_additive">measure_semi_sigma_additive</a></span>.<br/>
<span class="id">apply:</span> <span class="id"><a href="mathcomp.analysis.topology.html#cvg_toP">cvg_toP</a></span>.<br/>
&nbsp;&nbsp;<span class="id">apply:</span> <span class="id"><a href="mathcomp.analysis.sequences.html#ereal_nondecreasing_is_cvgn">ereal_nondecreasing_is_cvgn</a></span> <span class="id">=&gt;</span> <span class="id">m</span> <span class="id">n</span> <span class="id">mn</span>.<br/>
&nbsp;&nbsp;<span class="id">apply:</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#lee_sum_nneg_natr">lee_sum_nneg_natr</a></span> <span class="id">=&gt;</span> <span class="id">//</span> <span class="id">k</span> <span class="id">_</span> <span class="id">_</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="mathcomp.classical.fsbigop.html#fsbig_finite">fsbig_finite//=</a></span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#sumEFin">sumEFin</a></span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#lee_fin">lee_fin</a></span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">apply:</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssrnum.html#Num.Theory.sumr_ge0">sumr_ge0</a></span> <span class="id">=&gt;</span> <span class="id">/=</span> <span class="id">b</span> <span class="id">_;</span> <span class="id">exact:</span> <span class="id"><a href="mathcomp.analysis.probability.html#bernoulli_pmf_ge0">bernoulli_pmf_ge0</a></span>.<br/>
<span class="id">transitivity</span> (<span class="id"><a href="mathcomp.analysis.sequences.html#1fb3ae4179bc3e70682d81db7993c1d4">\sum_</a></span>(<span class="id">0</span> <span class="id"><a href="mathcomp.analysis.sequences.html#1fb3ae4179bc3e70682d81db7993c1d4">&lt;=</a></span> <span id="i:338" class="id"><span id="i:337" class="id"><span id="i:336" class="id"><span id="i:334" class="id"><span id="i:333" class="id"><span id="i:332" class="id"><a name="i:338" class="">i</a></span></span></span></span></span></span> <span class="id"><a href="mathcomp.analysis.sequences.html#1fb3ae4179bc3e70682d81db7993c1d4">&lt;oo</a></span>) (<span class="id"><a href="mathcomp.analysis.esum.html#bfafafade7d3e202dbbc3dbf50606eb1">\esum_</a></span>(<span id="j:339" class="id"><span id="j:335" class="id"><a name="j:339" class="">j</a></span></span> <span class="gallina-kwd">in</span> <span class="id">F</span> <span class="id"><a href="mathcomp.analysis.probability.html#i:332">i</a></span>) (<span class="id"><a href="mathcomp.analysis.probability.html#bernoulli_pmf">bernoulli_pmf</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#bernoulli.p">p</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#j:335">j</a></span>)%<span class="id">:E</span>)%<span class="id">R</span>)%<span class="id">E</span>.<br/>
<span class="id">apply:</span> <span class="id"><a href="mathcomp.analysis.sequences.html#eq_eseriesr">eq_eseriesr</a></span> <span class="id">=&gt;</span> <span class="id">k</span> <span class="id">_;</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.esum.html#esum_fset">esum_fset//=</a></span> <span class="id">=&gt;</span> <span class="id">b</span> <span class="id">_</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#lee_fin">lee_fin</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#bernoulli_pmf_ge0">bernoulli_pmf_ge0</a></span>.<br/>
<span class="id">rewrite</span> <span class="id">-nneseries_sum_bigcup//=;</span> <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">move=&gt;</span> <span class="id">b;</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#lee_fin">lee_fin</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#bernoulli_pmf_ge0">bernoulli_pmf_ge0</a></span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.esum.html#esum_fset">esum_fset//=</a></span> <span class="id">=&gt;</span> <span class="id">b</span> <span class="id">_;</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#lee_fin">lee_fin</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#bernoulli_pmf_ge0">bernoulli_pmf_ge0</a></span>.<br/>
Qed.</div>
<br/>
<span id="probability_bernoulli__canonical__measure_Measure" class="id"><span id="HB_unnamed_mixin_23" class="id"><span id="probability_bernoulli__canonical__measure_Content" class="id"><span id="HB_unnamed_mixin_22" class="id"><span id="measure_isMeasure__to__measure_isContent__21" class="id"><span id="measure_isMeasure__to__measure_Content_isMeasure__19" class="id"><span id="HB_unnamed_factory_17" class="id"><a name="probability_bernoulli__canonical__measure_Measure" class="hierarchy-builder">HB.instance</a></span></span></span></span></span></span></span> <span class="vernacular">Definition</span> <span class="id">_</span> <span class="id">:=</span> <span class="id"><a href="mathcomp.analysis.measure.html#isMeasure.Build">isMeasure.Build</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id"><a href="mathcomp.analysis.probability.html#bernoulli">bernoulli</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#bernoulli.bernoulli0">bernoulli0</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#bernoulli.bernoulli_ge0">bernoulli_ge0</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#bernoulli.bernoulli_sigma_additive">bernoulli_sigma_additive</a></span>.<br/>
<br/>
<span class="vernacular">Let</span> <span id="bernoulli.bernoulli_setT" class="id"><a name="bernoulli.bernoulli_setT" class="">bernoulli_setT</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#bernoulli">bernoulli</a></span> <span class="id"><a href="mathcomp.classical.classical_sets.html#36b9f1631384d2c3b944cb9d5855cd98">[set:</a></span> <span class="id">_]</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id">1</span>%<span class="id">E</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof62')">Proof.</span></div>
<div class="proofscript" id="proof62">
<span class="id">rewrite</span> <span class="id">/bernoulli/=;</span> <span class="id">case:</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#ifPn">ifPn</a></span> <span class="id">=&gt;</span> <span class="id">p01;</span> <span class="id">last</span> <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.measure.html#probability_setT">probability_setT</a></span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.probability.html#bernoulli_pmf1">bernoulli_pmf1</a></span>.<br/>
Qed.</div>
<br/>
<span id="probability_bernoulli__canonical__measure_Probability" class="id"><span id="HB_unnamed_mixin_39" class="id"><span id="probability_bernoulli__canonical__measure_SubProbability" class="id"><span id="HB_unnamed_mixin_38" class="id"><span id="probability_bernoulli__canonical__measure_FiniteMeasure" class="id"><span id="probability_bernoulli__canonical__measure_FinNumFun" class="id"><span id="HB_unnamed_mixin_37" class="id"><span id="probability_bernoulli__canonical__measure_SigmaFiniteMeasure" class="id"><span id="probability_bernoulli__canonical__measure_SFiniteMeasure" class="id"><span id="HB_unnamed_mixin_36" class="id"><span id="probability_bernoulli__canonical__measure_SigmaFiniteContent" class="id"><span id="HB_unnamed_mixin_35" class="id"><span id="measure_Measure_isProbability__to__measure_isFinite__34" class="id"><span id="measure_Measure_isProbability__to__measure_isSFinite__32" class="id"><span id="measure_Measure_isProbability__to__measure_isSubProbability__30" class="id"><span id="measure_Measure_isProbability__to__measure_isSigmaFinite__28" class="id"><span id="measure_Measure_isProbability__to__measure_isProbability__26" class="id"><span id="HB_unnamed_factory_24" class="id"><a name="probability_bernoulli__canonical__measure_Probability" class="hierarchy-builder">HB.instance</a></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span> <span class="vernacular">Definition</span> <span class="id">_</span> <span class="id">:=</span><br/>
&nbsp;&nbsp;@<span class="id"><a href="mathcomp.analysis.measure.html#Measure_isProbability.Build">Measure_isProbability.Build</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id"><a href="mathcomp.analysis.probability.html#bernoulli.R">R</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#bernoulli">bernoulli</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#bernoulli.bernoulli_setT">bernoulli_setT</a></span>.<br/>
<br/>
<span class="vernacular">End</span> <span class="id"><a href="mathcomp.analysis.probability.html#bernoulli">bernoulli</a></span>.<br/>
<br/>
<span class="vernacular">Section</span> <span id="bernoulli_measure" class="id"><a name="bernoulli_measure" class="">bernoulli_measure</a></span>.<br/>
<span class="vernacular">Context</span> <span class="id">{R</span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.reals.html#Real.Exports.realType">realType}</a></span>.<br/>
<span class="vernacular">Variables</span> (<span id="bernoulli_measure.p" class="id"><a name="bernoulli_measure.p" class="">p</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#bernoulli_measure.R">R</a></span>) (<span id="bernoulli_measure.p0" class="id"><a name="bernoulli_measure.p0" class="">p0</a></span> <span class="id">:</span> (<span class="id">0</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssrnum.html#cb42ec59ad57b25928e1718b4e69e031">&lt;=</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#p:341">p</a></span>)%<span class="id">R</span>) (<span id="bernoulli_measure.p1" class="id"><a name="bernoulli_measure.p1" class="">p1</a></span> <span class="id">:</span> ((<span class="id"><a href="mathcomp.analysis.signed.html#NngNum">NngNum</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#p0:342">p0</a></span>)%<span class="id">:num</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssrnum.html#cb42ec59ad57b25928e1718b4e69e031">&lt;=</a></span> <span class="id">1</span>)%<span class="id">R</span>).<br/>
<br/>
<span class="vernacular">Lemma</span> <span id="bernoulli_dirac" class="id"><a name="bernoulli_dirac" class="">bernoulli_dirac</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#bernoulli">bernoulli</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#bernoulli_measure.p">p</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="mathcomp.analysis.measure.html#measure_add">measure_add</a></span><br/>
&nbsp;&nbsp;(<span class="id"><a href="mathcomp.analysis.measure.html#mscale">mscale</a></span> (<span class="id"><a href="mathcomp.analysis.signed.html#NngNum">NngNum</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#bernoulli_measure.p0">p0</a></span>) <span class="id"><a href="mathcomp.analysis.measure.html#beb404b4c6e52afbdfec2979598a2318">\d_true</a></span>) (<span class="id"><a href="mathcomp.analysis.measure.html#mscale">mscale</a></span> (<span class="id"><a href="mathcomp.analysis.signed.html#onem_nonneg">onem_nonneg</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#bernoulli_measure.p1">p1</a></span>) <span class="id"><a href="mathcomp.analysis.measure.html#beb404b4c6e52afbdfec2979598a2318">\d_false</a></span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof63')">Proof.</span></div>
<div class="proofscript" id="proof63">
<span class="id">apply/funext</span> <span class="id">=&gt;</span> <span class="id">U;</span> <span class="id">rewrite</span> <span class="id">/bernoulli;</span> <span class="id">case:</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#ifPn">ifPn</a></span> <span class="id">=&gt;</span> <span class="id">[p01|];</span> <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.probability.html#bernoulli_measure.p0">p0/=</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#bernoulli_measure.p1">p1</a></span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.measure.html#measure_addE">measure_addE/=</a></span> <span class="id">/mscale/=</span>.<br/>
<span class="id">have</span> <span class="id">:=</span> @<span class="id"><a href="mathcomp.classical.classical_sets.html#subsetT">subsetT</a></span> <span class="id">_</span> <span class="id">U;</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT_bool">setT_bool</a></span> <span class="id">=&gt;</span> <span class="id">UT</span>.<br/>
<span class="id">have</span> <span class="id">[-&gt;|-&gt;|-&gt;|-&gt;]</span> <span class="id">/=</span> <span class="id">:=</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#subset_set2">subset_set2</a></span> <span class="id">UT</span>.<br/>
<span class="id">-</span> <span class="id">rewrite</span> <span class="id">-esum_fset//=;</span> <span class="id">last</span> <span class="gallina-kwd">by</span> <span class="id">move=&gt;</span> <span class="id">b;</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#lee_fin">lee_fin</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#bernoulli_pmf_ge0">bernoulli_pmf_ge0</a></span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.esum.html#esum_set0">esum_set0</a></span> <span class="id">2!measure0</span> <span class="id">2!mule0</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#adde0">adde0</a></span>.<br/>
<span class="id">-</span> <span class="id">rewrite</span> <span class="id">-esum_fset//=;</span> <span class="id">last</span> <span class="gallina-kwd">by</span> <span class="id">move=&gt;</span> <span class="id">b;</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#lee_fin">lee_fin</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#bernoulli_pmf_ge0">bernoulli_pmf_ge0</a></span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.esum.html#esum_set1">esum_set1/=</a></span> <span class="id">?lee_fin//</span> <span class="id">2!diracE</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#mem_set">mem_set//=</a></span> <span class="id"><a href="mathcomp.classical.classical_sets.html#memNset">memNset//=</a></span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#mule0">mule0</a></span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#adde0">adde0</a></span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#mule1">mule1</a></span>.<br/>
<span class="id">-</span> <span class="id">rewrite</span> <span class="id">-esum_fset//=;</span> <span class="id">last</span> <span class="gallina-kwd">by</span> <span class="id">move=&gt;</span> <span class="id">b;</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#lee_fin">lee_fin</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#bernoulli_pmf_ge0">bernoulli_pmf_ge0</a></span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.esum.html#esum_set1">esum_set1/=</a></span> <span class="id">?lee_fin</span> <span class="id">?subr_ge0//</span> <span class="id">2!diracE</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#memNset">memNset//=</a></span> <span class="id"><a href="mathcomp.classical.classical_sets.html#mem_set">mem_set//=</a></span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#mule0">mule0</a></span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#add0e">add0e</a></span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#mule1">mule1</a></span>.<br/>
<span class="id">-</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.classical.fsbigop.html#fsbigU">fsbigU//=;</a></span> <span class="id">last</span> <span class="gallina-kwd">by</span> <span class="id">move=&gt;</span> <span class="id">x</span> <span class="id">[-&gt;]</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">2!fsbig_set1/=</span> <span class="id">-setT_bool</span> <span class="id">2!diracT</span> <span class="id">!mule1</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">End</span> <span class="id"><a href="mathcomp.analysis.probability.html#bernoulli_measure">bernoulli_measure</a></span>.<br/>
<span class="vernacular">Arguments</span> <span class="id"><a href="mathcomp.analysis.probability.html#bernoulli">bernoulli</a></span> <span class="id">{R}</span>.<br/>
<br/>
<span class="vernacular">Section</span> <span id="integral_bernoulli" class="id"><a name="integral_bernoulli" class="">integral_bernoulli</a></span>.<br/>
<span class="vernacular">Context</span> <span class="id">{R</span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.reals.html#Real.Exports.realType">realType}</a></span>.<br/>
<span class="vernacular">Variables</span> (<span id="integral_bernoulli.p" class="id"><a name="integral_bernoulli.p" class="">p</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#integral_bernoulli.R">R</a></span>) (<span id="integral_bernoulli.p01" class="id"><a name="integral_bernoulli.p01" class="">p01</a></span> <span class="id">:</span> (<span class="id">0</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssrnum.html#5285549f1bd0c3f181a17cc59d549bc0">&lt;=</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#p:345">p</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssrnum.html#5285549f1bd0c3f181a17cc59d549bc0">&lt;=</a></span> <span class="id">1</span>)%<span class="id">R</span>).<br/>
<span class="vernacular">Local</span> <span class="vernacular">Open</span> <span class="vernacular">Scope</span> <span class="id">ereal_scope</span>.<br/>
<br/>
<span class="vernacular">Lemma</span> <span id="bernoulliE" class="id"><a name="bernoulliE" class="">bernoulliE</a></span> <span id="A:347" class="id"><a name="A:347" class="">A</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#bernoulli">bernoulli</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#integral_bernoulli.p">p</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#A:347">A</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#integral_bernoulli.p">p</a></span>%<span class="id">:E</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#f1c2ddfea282f8f8d7539f61e14c08e4">*</a></span> <span class="id"><a href="mathcomp.analysis.measure.html#beb404b4c6e52afbdfec2979598a2318">\d_true</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#A:347">A</a></span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#d4965da372b2485934ec33867ee5fbe7">+</a></span> (<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#ba5b9f829c901964a3abe669e095e940">`1-p</a></span>)%<span class="id">:E</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#f1c2ddfea282f8f8d7539f61e14c08e4">*</a></span> <span class="id"><a href="mathcomp.analysis.measure.html#beb404b4c6e52afbdfec2979598a2318">\d_false</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#A:347">A</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof64')">Proof.</span></div>
<div class="proofscript" id="proof64">
 <span class="gallina-kwd">by</span> <span class="id">case/andP</span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#integral_bernoulli.p01">p01</a></span> <span class="id">=&gt;</span> <span class="id">p0</span> <span class="id">p1;</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.probability.html#bernoulli_dirac">bernoulli_dirac//</a></span> <span class="id"><a href="mathcomp.analysis.measure.html#measure_addE">measure_addE</a></span>. Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="integral_bernoulli" class="id"><a name="integral_bernoulli" class="">integral_bernoulli</a></span> (<span id="f:348" class="id"><a name="f:348" class="">f</a></span> <span class="id">:</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#bool">bool</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#4c9ddfb63ff52527d9adecfde4a667c3">\bar</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#integral_bernoulli.R">R</a></span>) <span class="id">:</span> (<span class="gallina-kwd">forall</span> <span id="x:349" class="id"><a name="x:349" class="">x,</a></span> <span class="id">0</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#63b01a542aec2e4c61e028256cf5a548">&lt;=</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#f:348">f</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#x:349">x</a></span>) <span class="id">-&gt;</span><br/>
&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#3e4826d90e3d691004f544dc3de2d121">\int[bernoulli</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#integral_bernoulli.p">p]_y</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#f:348">f</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#y:350">y</a></span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#integral_bernoulli.p">p</a></span>%<span class="id">:E</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#f1c2ddfea282f8f8d7539f61e14c08e4">*</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#f:348">f</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#true">true</a></span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#d4965da372b2485934ec33867ee5fbe7">+</a></span> (<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#ba5b9f829c901964a3abe669e095e940">`1-p</a></span>)%<span class="id">:E</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#f1c2ddfea282f8f8d7539f61e14c08e4">*</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#f:348">f</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#false">false</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof65')">Proof.</span></div>
<div class="proofscript" id="proof65">
<span class="id">move=&gt;</span> <span class="id">f0;</span> <span class="id">case/andP</span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#integral_bernoulli.p01">p01</a></span> <span class="id">=&gt;</span> <span class="id">p0</span> <span class="id">p1;</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.probability.html#bernoulli_dirac">bernoulli_dirac/=</a></span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#ge0_integral_measure_sum">ge0_integral_measure_sum//</a></span> <span class="id">2!big_ord_recl/=</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.bigop.html#big_ord0">big_ord0</a></span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#adde0">adde0/=</a></span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">!ge0_integral_mscale//=</span> <span class="id">!integral_dirac//=</span> <span class="id">!diracT</span> <span class="id">!mul1e</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">End</span> <span class="id"><a href="mathcomp.analysis.probability.html#integral_bernoulli">integral_bernoulli</a></span>.<br/>
<br/>
<span class="vernacular">Section</span> <span id="measurable_bernoulli" class="id"><a name="measurable_bernoulli" class="">measurable_bernoulli</a></span>.<br/>
<span class="vernacular">Local</span> <span class="vernacular">Open</span> <span class="vernacular">Scope</span> <span class="id">ring_scope</span>.<br/>
<span class="vernacular">Variable</span> <span id="measurable_bernoulli.R" class="id"><a name="measurable_bernoulli.R" class="">R</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.reals.html#Real.Exports.realType">realType</a></span>.<br/>
<span class="vernacular">Implicit</span> <span class="gallina-kwd">Type</span> <span class="id">p</span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#measurable_bernoulli.R">R</a></span>.<br/>
<br/>
<span class="vernacular">Lemma</span> <span id="measurable_bernoulli" class="id"><a name="measurable_bernoulli" class="">measurable_bernoulli</a></span> <span class="id">:</span><br/>
&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.measure.html#measurable_fun">measurable_fun</a></span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#bernoulli">bernoulli</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#measurable_bernoulli.R">R</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.measure.html#pprobability">pprobability</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#bool">bool</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#measurable_bernoulli.R">R</a></span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof66')">Proof.</span></div>
<div class="proofscript" id="proof66">
<span class="id">apply:</span> (@<span class="id"><a href="mathcomp.analysis.measure.html#measurability">measurability</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span><br/>
&nbsp;&nbsp;(@<span class="id"><a href="mathcomp.analysis.measure.html#pset">pset</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">:</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#set">set</a></span> (<span class="id"><a href="mathcomp.classical.classical_sets.html#set">set</a></span> (<span class="id"><a href="mathcomp.analysis.measure.html#pprobability">pprobability</a></span> <span class="id">_</span> <span class="id"><a href="mathcomp.analysis.probability.html#measurable_bernoulli.R">R</a></span>)))) <span class="id">=&gt;</span> <span class="id">//</span>.<br/>
<span class="id">move=&gt;</span> <span class="id">_</span> <span class="id">-[_</span> <span class="id">[r</span> <span class="id">r01]</span> <span class="id">[Ys</span> <span class="id">mYs</span> <span class="id">&lt;-]]</span> <span class="id">&lt;-;</span> <span class="id">apply:</span> <span class="id"><a href="mathcomp.analysis.lebesgue_measure.html#emeasurable_fun_infty_o">emeasurable_fun_infty_o</a></span> <span class="id">=&gt;</span> <span class="id">//=</span>.<br/>
<span class="id">apply:</span> <span class="id"><a href="mathcomp.analysis.measure.html#measurable_fun_if">measurable_fun_if</a></span> <span class="id">=&gt;</span> <span class="id">//=</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">apply:</span> <span class="id"><a href="mathcomp.analysis.measure.html#measurable_and">measurable_and</a></span> <span class="id">=&gt;</span> <span class="id">//;</span> <span class="id">exact:</span> <span class="id"><a href="mathcomp.analysis.lebesgue_measure.html#measurable_fun_ler">measurable_fun_ler</a></span>.<br/>
<span class="id">apply:</span> (<span class="id"><a href="mathcomp.analysis.measure.html#eq_measurable_fun">eq_measurable_fun</a></span> (<span class="gallina-kwd">fun</span> <span id="t:356" class="id"><span id="t:352" class="id"><a name="t:356" class="">t</a></span></span> <span class="id">=&gt;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#706f4f0208bba5d79e26d335c76ea034">\sum_</a></span>(<span id="b:359" class="id"><span id="b:358" class="id"><span id="b:357" class="id"><span id="b:355" class="id"><span id="b:354" class="id"><span id="b:353" class="id"><a name="b:359" class="">b</a></span></span></span></span></span></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#706f4f0208bba5d79e26d335c76ea034">&lt;-</a></span> <span class="id"><a href="mathcomp.classical.cardinality.html#fset_set">fset_set</a></span> <span class="id">Ys</span>) (<span class="id"><a href="mathcomp.analysis.probability.html#bernoulli_pmf">bernoulli_pmf</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#t:352">t</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#b:353">b</a></span>)%<span class="id">:E</span>)).<br/>
&nbsp;&nbsp;<span class="id">move=&gt;</span> <span class="id">x</span> <span class="id">/set_mem[_/=</span> <span class="id">x01]</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.classical.fsbigop.html#fsbig_finite">fsbig_finite//=</a></span>.<br/>
<span class="id">apply:</span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#emeasurable_fun_sum">emeasurable_fun_sum</a></span> <span class="id">=&gt;</span> <span class="id">n</span>.<br/>
<span class="id">move=&gt;</span> <span class="id">k</span> <span class="id">Ysk;</span> <span class="id">apply/measurableT_comp</span> <span class="id">=&gt;</span> <span class="id">//</span>.<br/>
<span class="id">exact:</span> <span class="id"><a href="mathcomp.analysis.probability.html#measurable_bernoulli_pmf">measurable_bernoulli_pmf</a></span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="measurable_bernoulli2" class="id"><a name="measurable_bernoulli2" class="">measurable_bernoulli2</a></span> <span id="U:360" class="id"><a name="U:360" class="">U</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.measure.html#measurable">measurable</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#U:360">U</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.measure.html#measurable_fun">measurable_fun</a></span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#bernoulli">bernoulli</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.ssrfun.html#3dce462f8124648b906d1e347a73bb9f">^~</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#U:360">U</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#measurable_bernoulli.R">R</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#4c9ddfb63ff52527d9adecfde4a667c3">\bar</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#measurable_bernoulli.R">R</a></span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof67')">Proof.</span></div>
<div class="proofscript" id="proof67">
<span class="gallina-kwd">by</span> <span class="id">move=&gt;</span> <span class="id">?;</span> <span class="id">exact:</span> (<span class="id"><a href="mathcomp.analysis.kernel.html#measurable_kernel">measurable_kernel</a></span> (<span class="id"><a href="mathcomp.analysis.kernel.html#kprobability">kprobability</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#measurable_bernoulli">measurable_bernoulli</a></span>)).<br/>
Qed.</div>
<br/>
<span class="vernacular">End</span> <span class="id"><a href="mathcomp.analysis.probability.html#measurable_bernoulli">measurable_bernoulli</a></span>.<br/>
<span class="vernacular">Arguments</span> <span class="id"><a href="mathcomp.analysis.probability.html#measurable_bernoulli">measurable_bernoulli</a></span> <span class="id">{R}</span>.<br/>
<br/>
<span class="vernacular">Section</span> <span id="binomial_pmf" class="id"><a name="binomial_pmf" class="">binomial_pmf</a></span>.<br/>
<span class="vernacular">Local</span> <span class="vernacular">Open</span> <span class="vernacular">Scope</span> <span class="id">ring_scope</span>.<br/>
<span class="vernacular">Context</span> <span class="id">{R</span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.reals.html#Real.Exports.realType">realType}</a></span> (<span id="n:362" class="id"><a name="n:362" class="">n</a></span> <span class="id">:</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span id="p:363" class="id"><a name="p:363" class="">p</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#R:361">R</a></span>).<br/>
<br/>
<span class="vernacular">Definition</span> <span id="binomial_pmf" class="id"><a name="binomial_pmf" class="">binomial_pmf</a></span> <span id="k:364" class="id"><a name="k:364" class="">k</a></span> <span class="id">:=</span> <span class="id"><a href="mathcomp.analysis.probability.html#binomial_pmf.p">p</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#663140372ac3b275aae871b74b140513">^+</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#k:364">k</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#2d0cfb150261028f4ebd2ba355623dcc">*</a></span> (<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#ba5b9f829c901964a3abe669e095e940">`1-p</a></span>) <span class="id">^+</span> (<span class="id"><a href="mathcomp.analysis.probability.html#binomial_pmf.n">n</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.ssrnat.html#::nat_scope:x_'-'_x">-</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#k:364">k</a></span>) <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#e9001f602764f7896bb1eb34bf606a23">*+</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.binomial.html#95129fba25b300adee91ca933fa2fcdc">'C</a></span>(<span class="id"><a href="mathcomp.analysis.probability.html#binomial_pmf.n">n,</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#k:364">k</a></span>).<br/>
<br/>
<span class="vernacular">Lemma</span> <span id="binomial_pmf_ge0" class="id"><a name="binomial_pmf_ge0" class="">binomial_pmf_ge0</a></span> <span id="k:365" class="id"><a name="k:365" class="">k</a></span> (<span id="p01:366" class="id"><a name="p01:366" class="">p01</a></span> <span class="id">:</span> (<span class="id">0</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssrnum.html#5285549f1bd0c3f181a17cc59d549bc0">&lt;=</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#binomial_pmf.p">p</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssrnum.html#5285549f1bd0c3f181a17cc59d549bc0">&lt;=</a></span> <span class="id">1</span>)%<span class="id">R</span>) <span class="id">:</span> <span class="id">0</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssrnum.html#cb42ec59ad57b25928e1718b4e69e031">&lt;=</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#binomial_pmf">binomial_pmf</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#k:365">k</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof68')">Proof.</span></div>
<div class="proofscript" id="proof68">
<span class="id">move:</span> <span class="id">p01</span> <span class="id">=&gt;</span> <span class="id">/andP[p0</span> <span class="id">p1];</span> <span class="id">rewrite</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssrnum.html#Num.Theory.mulrn_wge0">mulrn_wge0//</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssrnum.html#Num.Theory.mulr_ge0">mulr_ge0//</a></span> <span class="id">?exprn_ge0//</span>.<br/>
<span class="id">exact:</span> <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#onem_ge0">onem_ge0</a></span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">End</span> <span class="id"><a href="mathcomp.analysis.probability.html#binomial_pmf">binomial_pmf</a></span>.<br/>
<br/>
<span class="vernacular">Lemma</span> <span id="measurable_binomial_pmf" class="id"><a name="measurable_binomial_pmf" class="">measurable_binomial_pmf</a></span> <span class="id">{R</span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.reals.html#Real.Exports.realType">realType}</a></span> <span id="D:368" class="id"><a name="D:368" class="">D</a></span> <span id="n:369" class="id"><a name="n:369" class="">n</a></span> <span id="k:370" class="id"><a name="k:370" class="">k</a></span> <span class="id">:</span><br/>
&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.measure.html#measurable_fun">measurable_fun</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#D:368">D</a></span> (@<span class="id"><a href="mathcomp.analysis.probability.html#binomial_pmf">binomial_pmf</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#R:367">R</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#n:369">n</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.ssrfun.html#3dce462f8124648b906d1e347a73bb9f">^~</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#k:370">k</a></span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof69')">Proof.</span></div>
<div class="proofscript" id="proof69">
<span class="id">apply:</span> (@<span class="id"><a href="mathcomp.analysis.measure.html#measurableT_comp">measurableT_comp</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> (<span class="gallina-kwd">fun</span> <span id="x:372" class="id"><span id="x:371" class="id"><a name="x:372" class="">x</a></span></span> <span class="id">:</span> <span class="id">R</span> <span class="id">=&gt;</span> <span class="id"><a href="mathcomp.analysis.probability.html#x:371">x</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#e9001f602764f7896bb1eb34bf606a23">*+</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.binomial.html#95129fba25b300adee91ca933fa2fcdc">'C</a></span>(<span class="id">n,</span> <span class="id">k</span>))%<span class="id">R</span>) <span class="id">=&gt;</span> <span class="id">/=</span>.<br/>
&nbsp;&nbsp;<span class="id">exact:</span> <span class="id"><a href="mathcomp.analysis.lebesgue_measure.html#measurable_natmul">measurable_natmul</a></span>.<br/>
<span class="id">apply:</span> <span class="id"><a href="mathcomp.analysis.lebesgue_measure.html#measurable_funM">measurable_funM</a></span> <span class="id">=&gt;</span> <span class="id">//=;</span> <span class="id">apply:</span> <span class="id"><a href="mathcomp.analysis.lebesgue_measure.html#measurable_fun_pow">measurable_fun_pow</a></span>.<br/>
<span class="id">exact:</span> <span class="id"><a href="mathcomp.analysis.lebesgue_measure.html#measurable_funB">measurable_funB</a></span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Definition</span> <span id="binomial_prob" class="id"><a name="binomial_prob" class="">binomial_prob</a></span> <span class="id">{R</span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.reals.html#Real.Exports.realType">realType}</a></span> (<span id="n:374" class="id"><a name="n:374" class="">n</a></span> <span class="id">:</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span id="p:375" class="id"><a name="p:375" class="">p</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#R:373">R</a></span>) <span class="id">:</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#set">set</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#nat">nat</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#4c9ddfb63ff52527d9adecfde4a667c3">\bar</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#R:373">R</a></span> <span class="id">:=</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">fun</span> <span id="U:376" class="id"><a name="U:376" class="">U</a></span> <span class="id">=&gt;</span> <span class="gallina-kwd">if</span> (<span class="id">0</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssrnum.html#5285549f1bd0c3f181a17cc59d549bc0">&lt;=</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#p:375">p</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssrnum.html#5285549f1bd0c3f181a17cc59d549bc0">&lt;=</a></span> <span class="id">1</span>)%<span class="id">R</span> <span class="gallina-kwd">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.esum.html#bfafafade7d3e202dbbc3dbf50606eb1">\esum_</a></span>(<span id="k:377" class="id"><a name="k:377" class="">k</a></span> <span class="gallina-kwd">in</span> <span class="id"><a href="mathcomp.analysis.probability.html#U:376">U</a></span>) (<span class="id"><a href="mathcomp.analysis.probability.html#binomial_pmf">binomial_pmf</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#n:374">n</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#p:375">p</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#k:377">k</a></span>)%<span class="id">:E</span> <span class="gallina-kwd">else</span> <span class="id"><a href="mathcomp.analysis.measure.html#beb404b4c6e52afbdfec2979598a2318">\d_0</a></span>%<span class="id">N</span> <span class="id"><a href="mathcomp.analysis.probability.html#U:376">U</a></span>.<br/>
<br/>
<span class="vernacular">Section</span> <span id="binomial" class="id"><a name="binomial" class="">binomial</a></span>.<br/>
<span class="vernacular">Context</span> <span class="id">{R</span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.reals.html#Real.Exports.realType">realType}</a></span> (<span id="n:379" class="id"><a name="n:379" class="">n</a></span> <span class="id">:</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span id="p:380" class="id"><a name="p:380" class="">p</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#R:378">R</a></span>).<br/>
<span class="vernacular">Local</span> <span class="vernacular">Open</span> <span class="vernacular">Scope</span> <span class="id">ereal_scope</span>.<br/>
<br/>
<span class="vernacular">Local</span> <span class="vernacular">Notation</span> <span id="binomial" class="id"><a name="binomial" class="">binomial</a></span> <span class="id">:=</span> (<span class="id"><a href="mathcomp.analysis.probability.html#binomial_prob">binomial_prob</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#binomial.n">n</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#binomial.p">p</a></span>).<br/>
<br/>
<span class="vernacular">Let</span> <span id="binomial.binomial0" class="id"><a name="binomial.binomial0" class="">binomial0</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#binomial">binomial</a></span> <span class="id"><a href="mathcomp.classical.classical_sets.html#set0">set0</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id">0</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof70')">Proof.</span></div>
<div class="proofscript" id="proof70">
 <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">/binomial</span> <span class="id"><a href="mathcomp.analysis.measure.html#measure0">measure0;</a></span> <span class="id">case:</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#ifPn">ifPn</a></span> <span class="id">=&gt;</span> <span class="id">//;</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.esum.html#esum_set0">esum_set0</a></span>. Qed.</div>
<br/>
<span class="vernacular">Let</span> <span id="binomial.binomial_ge0" class="id"><a name="binomial.binomial_ge0" class="">binomial_ge0</a></span> <span id="U:381" class="id"><a name="U:381" class="">U</a></span> <span class="id">:</span> <span class="id">0</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#63b01a542aec2e4c61e028256cf5a548">&lt;=</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#binomial">binomial</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#U:381">U</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof71')">Proof.</span></div>
<div class="proofscript" id="proof71">
<span class="id">rewrite</span> <span class="id">/binomial;</span> <span class="id">case:</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#ifPn">ifPn</a></span> <span class="id">=&gt;</span> <span class="id">//</span> <span class="id">p01;</span> <span class="id">apply:</span> <span class="id"><a href="mathcomp.analysis.esum.html#esum_ge0">esum_ge0</a></span> <span class="id">=&gt;</span> <span class="id">/=</span> <span class="id">k</span> <span class="id">Uk</span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#lee_fin">lee_fin</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#binomial_pmf_ge0">binomial_pmf_ge0</a></span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Let</span> <span id="binomial.binomial_sigma_additive" class="id"><a name="binomial.binomial_sigma_additive" class="">binomial_sigma_additive</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.measure.html#semi_sigma_additive">semi_sigma_additive</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#binomial">binomial</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof72')">Proof.</span></div>
<div class="proofscript" id="proof72">
<span class="id">move=&gt;</span> <span class="id">F</span> <span class="id">mF</span> <span class="id">tF</span> <span class="id">mUF;</span> <span class="id">rewrite</span> <span class="id">/binomial;</span> <span class="id">case:</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#ifPn">ifPn</a></span> <span class="id">=&gt;</span> <span class="id">p01;</span> <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;<span class="id">exact:</span> <span class="id"><a href="mathcomp.analysis.measure.html#measure_semi_sigma_additive">measure_semi_sigma_additive</a></span>.<br/>
<span class="id">apply:</span> <span class="id"><a href="mathcomp.analysis.topology.html#cvg_toP">cvg_toP</a></span>.<br/>
&nbsp;&nbsp;<span class="id">apply:</span> <span class="id"><a href="mathcomp.analysis.sequences.html#ereal_nondecreasing_is_cvgn">ereal_nondecreasing_is_cvgn</a></span> <span class="id">=&gt;</span> <span class="id">a</span> <span class="id">b</span> <span class="id">ab</span>.<br/>
&nbsp;&nbsp;<span class="id">apply:</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#lee_sum_nneg_natr">lee_sum_nneg_natr</a></span> <span class="id">=&gt;</span> <span class="id">//</span> <span class="id">k</span> <span class="id">_</span> <span class="id">_</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">apply:</span> <span class="id"><a href="mathcomp.analysis.esum.html#esum_ge0">esum_ge0</a></span> <span class="id">=&gt;</span> <span class="id">/=</span> <span class="id">?</span> <span class="id">_;</span> <span class="id">exact:</span> <span class="id"><a href="mathcomp.analysis.probability.html#binomial_pmf_ge0">binomial_pmf_ge0</a></span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.esum.html#nneseries_sum_bigcup">nneseries_sum_bigcup//</a></span> <span class="id">=&gt;</span> <span class="id">i;</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#lee_fin">lee_fin</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#binomial_pmf_ge0">binomial_pmf_ge0</a></span>.<br/>
Qed.</div>
<br/>
<span id="probability_binomial_prob__canonical__measure_Measure" class="id"><span id="HB_unnamed_mixin_46" class="id"><span id="probability_binomial_prob__canonical__measure_Content" class="id"><span id="HB_unnamed_mixin_45" class="id"><span id="measure_isMeasure__to__measure_isContent__44" class="id"><span id="measure_isMeasure__to__measure_Content_isMeasure__42" class="id"><span id="HB_unnamed_factory_40" class="id"><a name="probability_binomial_prob__canonical__measure_Measure" class="hierarchy-builder">HB.instance</a></span></span></span></span></span></span></span> <span class="vernacular">Definition</span> <span class="id">_</span> <span class="id">:=</span> <span class="id"><a href="mathcomp.analysis.measure.html#isMeasure.Build">isMeasure.Build</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id"><a href="mathcomp.analysis.probability.html#binomial">binomial</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#binomial.binomial0">binomial0</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#binomial.binomial_ge0">binomial_ge0</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#binomial.binomial_sigma_additive">binomial_sigma_additive</a></span>.<br/>
<br/>
<span class="vernacular">Let</span> <span id="binomial.binomial_setT" class="id"><a name="binomial.binomial_setT" class="">binomial_setT</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#binomial">binomial</a></span> <span class="id"><a href="mathcomp.classical.classical_sets.html#36b9f1631384d2c3b944cb9d5855cd98">[set:</a></span> <span class="id">_]</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id">1</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof73')">Proof.</span></div>
<div class="proofscript" id="proof73">
<span class="id">rewrite</span> <span class="id">/binomial;</span> <span class="id">case:</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#ifPn">ifPn;</a></span> <span class="id">last</span> <span class="gallina-kwd">by</span> <span class="id">move=&gt;</span> <span class="id">_;</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.measure.html#probability_setT">probability_setT</a></span>.<br/>
<span class="id">move=&gt;</span> <span class="id">p01;</span> <span class="id">rewrite</span> <span class="id">/binomial_pmf</span>.<br/>
<span class="id">have</span> <span class="id">pkn</span> <span class="id">k</span> <span class="id">:</span> <span class="id">0</span>%<span class="id">R</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#63b01a542aec2e4c61e028256cf5a548">&lt;=</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#binomial.p">p</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#663140372ac3b275aae871b74b140513">^+</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#k:382">k</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#2d0cfb150261028f4ebd2ba355623dcc">*</a></span> <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#ba5b9f829c901964a3abe669e095e940">`1-p</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#663140372ac3b275aae871b74b140513">^+</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#binomial.n">n</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.ssrnat.html#::nat_scope:x_'-'_x">-</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#k:382">k</a></span>) <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#e9001f602764f7896bb1eb34bf606a23">*+</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.binomial.html#95129fba25b300adee91ca933fa2fcdc">'C</a></span>(<span class="id"><a href="mathcomp.analysis.probability.html#binomial.n">n,</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#k:382">k</a></span>))%<span class="id">:E</span>.<br/>
&nbsp;&nbsp;<span class="id">case/andP</span> <span class="id">:</span> <span class="id">p01</span> <span class="id">=&gt;</span> <span class="id">p0</span> <span class="id">p1</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#lee_fin">lee_fin</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssrnum.html#Num.Theory.mulrn_wge0">mulrn_wge0//</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssrnum.html#Num.Theory.mulr_ge0">mulr_ge0</a></span> <span class="id">?exprn_ge0</span> <span class="id">?subr_ge0</span>.<br/>
<span class="id">rewrite</span> (<span class="id"><a href="mathcomp.analysis.esum.html#esumID">esumID</a></span> <span class="id"><a href="mathcomp.classical.classical_sets.html#ab8d1100462fb578182d90787a3ffaeb">`I_n</a></span>.<span class="id">+1</span>)<span class="id">//</span> <span class="id">[X</span> <span class="gallina-kwd">in</span> <span class="id">_</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#d4965da372b2485934ec33867ee5fbe7">+</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:383">X]esum1</a></span> <span class="id">?adde0;</span> <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">move=&gt;</span> <span class="id">/=</span> <span class="id">k</span> <span class="id">[_</span> <span class="id">/negP];</span> <span class="id">rewrite</span> <span class="id">-leqNgt</span> <span class="id">=&gt;</span> <span class="id">nk;</span> <span class="id">rewrite</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.binomial.html#bin_small">bin_small</a></span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setTI">setTI</a></span> <span class="id"><a href="mathcomp.analysis.esum.html#esum_fset">esum_fset//</a></span> <span class="id">-fsbig_ord//=</span>.<br/>
<span class="id">under</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.bigop.html#eq_bigr">eq_bigr</a></span> <span class="id">do</span> <span class="id">rewrite</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#GRing.Theory.mulrC">mulrC</a></span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#sumEFin">sumEFin</a></span> <span class="id">-exprDn_comm;</span> <span class="id">last</span> <span class="id">exact:</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#GRing.Theory.mulrC">mulrC</a></span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#GRing.Theory.addrC">addrC</a></span> <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#add_onemK">add_onemK</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#GRing.Theory.expr1n">expr1n</a></span>.<br/>
Qed.</div>
<br/>
<span id="probability_binomial_prob__canonical__measure_Probability" class="id"><span id="HB_unnamed_mixin_62" class="id"><span id="probability_binomial_prob__canonical__measure_SubProbability" class="id"><span id="HB_unnamed_mixin_61" class="id"><span id="probability_binomial_prob__canonical__measure_FiniteMeasure" class="id"><span id="probability_binomial_prob__canonical__measure_FinNumFun" class="id"><span id="HB_unnamed_mixin_60" class="id"><span id="probability_binomial_prob__canonical__measure_SigmaFiniteMeasure" class="id"><span id="probability_binomial_prob__canonical__measure_SFiniteMeasure" class="id"><span id="HB_unnamed_mixin_59" class="id"><span id="probability_binomial_prob__canonical__measure_SigmaFiniteContent" class="id"><span id="HB_unnamed_mixin_58" class="id"><span id="measure_Measure_isProbability__to__measure_isFinite__57" class="id"><span id="measure_Measure_isProbability__to__measure_isSFinite__55" class="id"><span id="measure_Measure_isProbability__to__measure_isSubProbability__53" class="id"><span id="measure_Measure_isProbability__to__measure_isSigmaFinite__51" class="id"><span id="measure_Measure_isProbability__to__measure_isProbability__49" class="id"><span id="HB_unnamed_factory_47" class="id"><a name="probability_binomial_prob__canonical__measure_Probability" class="hierarchy-builder">HB.instance</a></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span> <span class="vernacular">Definition</span> <span class="id">_</span> <span class="id">:=</span><br/>
&nbsp;&nbsp;@<span class="id"><a href="mathcomp.analysis.measure.html#Measure_isProbability.Build">Measure_isProbability.Build</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id"><a href="mathcomp.analysis.probability.html#binomial.R">R</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#binomial">binomial</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#binomial.binomial_setT">binomial_setT</a></span>.<br/>
<br/>
<span class="vernacular">End</span> <span class="id"><a href="mathcomp.analysis.probability.html#binomial">binomial</a></span>.<br/>
<br/>
<span class="vernacular">Section</span> <span id="binomial_probability" class="id"><a name="binomial_probability" class="">binomial_probability</a></span>.<br/>
<span class="vernacular">Local</span> <span class="vernacular">Open</span> <span class="vernacular">Scope</span> <span class="id">ring_scope</span>.<br/>
<span class="vernacular">Context</span> <span class="id">{R</span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.reals.html#Real.Exports.realType">realType}</a></span> (<span id="n:385" class="id"><a name="n:385" class="">n</a></span> <span class="id">:</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span id="p:386" class="id"><a name="p:386" class="">p</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#R:384">R</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span id="p0:387" class="id"><a name="p0:387" class="">p0</a></span> <span class="id">:</span> (<span class="id">0</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssrnum.html#cb42ec59ad57b25928e1718b4e69e031">&lt;=</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#p:386">p</a></span>)%<span class="id">R</span>) (<span id="p1:388" class="id"><a name="p1:388" class="">p1</a></span> <span class="id">:</span> ((<span class="id"><a href="mathcomp.analysis.signed.html#NngNum">NngNum</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#p0:387">p0</a></span>)%<span class="id">:num</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssrnum.html#cb42ec59ad57b25928e1718b4e69e031">&lt;=</a></span> <span class="id">1</span>)%<span class="id">R</span>).<br/>
<br/>
<span class="vernacular">Definition</span> <span id="bin_prob" class="id"><a name="bin_prob" class="">bin_prob</a></span> (<span id="k:389" class="id"><a name="k:389" class="">k</a></span> <span class="id">:</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#nat">nat</a></span>) <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.signed.html#3c7df47245b1421bbe9c31d0c8ed78f3">{nonneg</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#binomial_probability.R">R}</a></span> <span class="id">:=</span><br/>
&nbsp;&nbsp;((<span class="id"><a href="mathcomp.analysis.signed.html#NngNum">NngNum</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#binomial_probability.p0">p0</a></span>)%<span class="id">:num</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#663140372ac3b275aae871b74b140513">^+</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#k:389">k</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#2d0cfb150261028f4ebd2ba355623dcc">*</a></span> (<span class="id"><a href="mathcomp.analysis.signed.html#NngNum">NngNum</a></span> (<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#onem_ge0">onem_ge0</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#binomial_probability.p1">p1</a></span>))%<span class="id">:num</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#663140372ac3b275aae871b74b140513">^+</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#binomial_probability.n">n</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.ssrnat.html#::nat_scope:x_'-'_x">-</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#k:389">k</a></span>)%<span class="id">N</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#e9001f602764f7896bb1eb34bf606a23">*+</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.binomial.html#95129fba25b300adee91ca933fa2fcdc">'C</a></span>(<span class="id"><a href="mathcomp.analysis.probability.html#binomial_probability.n">n,</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#k:389">k</a></span>))%<span class="id">:nng</span>.<br/>
<br/>
<span class="vernacular">Lemma</span> <span id="bin_prob0" class="id"><a name="bin_prob0" class="">bin_prob0</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#bin_prob">bin_prob</a></span> <span class="id">0</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> ((<span class="id"><a href="mathcomp.analysis.signed.html#NngNum">NngNum</a></span> (<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#onem_ge0">onem_ge0</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#binomial_probability.p1">p1</a></span>))%<span class="id">:num^+n</span>)%<span class="id">:nng</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof74')">Proof.</span></div>
<div class="proofscript" id="proof74">
<span class="id">rewrite</span> <span class="id">/bin_prob</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.binomial.html#bin0">bin0</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.ssrnat.html#subn0">subn0/=;</a></span> <span class="id">apply/val_inj</span> <span class="id">=&gt;</span> <span class="id">/=</span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#GRing.Theory.expr0">expr0</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#GRing.Theory.mul1r">mul1r</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#GRing.Theory.mulr1n">mulr1n</a></span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="bin_prob1" class="id"><a name="bin_prob1" class="">bin_prob1</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#bin_prob">bin_prob</a></span> <span class="id">1</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span><br/>
&nbsp;&nbsp;((<span class="id"><a href="mathcomp.analysis.signed.html#NngNum">NngNum</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#binomial_probability.p0">p0</a></span>)%<span class="id">:num</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#2d0cfb150261028f4ebd2ba355623dcc">*</a></span> (<span class="id"><a href="mathcomp.analysis.signed.html#NngNum">NngNum</a></span> (<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#onem_ge0">onem_ge0</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#binomial_probability.p1">p1</a></span>))%<span class="id">:num</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#663140372ac3b275aae871b74b140513">^+</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#binomial_probability.n">n</a></span>.<span class="id">-1</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#e9001f602764f7896bb1eb34bf606a23">*+</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#binomial_probability.n">n</a></span>)%<span class="id">:nng</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof75')">Proof.</span></div>
<div class="proofscript" id="proof75">
<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">/bin_prob</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.binomial.html#bin1">bin1/=;</a></span> <span class="id">apply/val_inj</span> <span class="id">=&gt;</span> <span class="id">/=;</span> <span class="id">rewrite</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#GRing.Theory.expr1">expr1</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.ssrnat.html#subn1">subn1</a></span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="binomial_msum" class="id"><a name="binomial_msum" class="">binomial_msum</a></span> <span class="id">:</span><br/>
&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#binomial_prob">binomial_prob</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#binomial_probability.n">n</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#binomial_probability.p">p</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="mathcomp.analysis.measure.html#msum">msum</a></span> (<span class="gallina-kwd">fun</span> <span id="k:390" class="id"><a name="k:390" class="">k</a></span> <span class="id">=&gt;</span> <span class="id"><a href="mathcomp.analysis.measure.html#mscale">mscale</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#bin_prob">bin_prob</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#k:390">k</a></span>) <span class="id"><a href="mathcomp.analysis.measure.html#beb404b4c6e52afbdfec2979598a2318">\d_k</a></span>) <span class="id"><a href="mathcomp.analysis.probability.html#binomial_probability.n">n</a></span>.<span class="id">+1</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof76')">Proof.</span></div>
<div class="proofscript" id="proof76">
<span class="id">apply/funext</span> <span class="id">=&gt;</span> <span class="id">U</span>.<br/>
<span class="id">rewrite</span> <span class="id">/binomial_prob;</span> <span class="id">case:</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#ifPn">ifPn</a></span> <span class="id">=&gt;</span> <span class="id">[_|];</span> <span class="id">last</span> <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.probability.html#binomial_probability.p1">p1</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#binomial_probability.p0">p0</a></span>.<br/>
<span class="id">rewrite</span> <span class="id">/msum/=</span> <span class="id">/mscale/=</span> <span class="id">/binomial_pmf</span>.<br/>
<span class="id">have</span> <span class="id">pkn</span> <span class="id">k</span> <span class="id">:</span> (<span class="id">0</span>%<span class="id">R</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#63b01a542aec2e4c61e028256cf5a548">&lt;=</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#binomial_probability.p">p</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#663140372ac3b275aae871b74b140513">^+</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#k:391">k</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#2d0cfb150261028f4ebd2ba355623dcc">*</a></span> <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#ba5b9f829c901964a3abe669e095e940">`1-p</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#663140372ac3b275aae871b74b140513">^+</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#binomial_probability.n">n</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.ssrnat.html#::nat_scope:x_'-'_x">-</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#k:391">k</a></span>) <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#e9001f602764f7896bb1eb34bf606a23">*+</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.binomial.html#95129fba25b300adee91ca933fa2fcdc">'C</a></span>(<span class="id"><a href="mathcomp.analysis.probability.html#binomial_probability.n">n,</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#k:391">k</a></span>))%<span class="id">:E</span>)%<span class="id">E</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#lee_fin">lee_fin</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssrnum.html#Num.Theory.mulrn_wge0">mulrn_wge0//</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssrnum.html#Num.Theory.mulr_ge0">mulr_ge0</a></span> <span class="id">?exprn_ge0</span> <span class="id">?subr_ge0</span>.<br/>
<span class="id">rewrite</span> (<span class="id"><a href="mathcomp.analysis.esum.html#esumID">esumID</a></span> <span class="id"><a href="mathcomp.classical.classical_sets.html#ab8d1100462fb578182d90787a3ffaeb">`I_n</a></span>.<span class="id">+1</span>)<span class="id">//=</span> <span class="id">[X</span> <span class="gallina-kwd">in</span> <span class="id">_</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#c7f78cf1f6a5e4f664654f7d671ca752">+</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:392">X]esum1</a></span> <span class="id">?adde0;</span> <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">move=&gt;</span> <span class="id">/=</span> <span class="id">k</span> <span class="id">[_</span> <span class="id">/negP];</span> <span class="id">rewrite</span> <span class="id">-leqNgt</span> <span class="id">=&gt;</span> <span class="id">nk;</span> <span class="id">rewrite</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.binomial.html#bin_small">bin_small</a></span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.esum.html#esum_mkcondl">esum_mkcondl</a></span> <span class="id"><a href="mathcomp.analysis.esum.html#esum_fset">esum_fset//;</a></span> <span class="id">last</span> <span class="gallina-kwd">by</span> <span class="id">move=&gt;</span> <span class="id">i</span> <span class="id">/=</span> <span class="id">_;</span> <span class="id">case:</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#ifPn">ifPn</a></span>.<br/>
<span class="id">rewrite</span> <span class="id">-fsbig_ord//=;</span> <span class="id">apply:</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.bigop.html#eq_bigr">eq_bigr</a></span> <span class="id">=&gt;</span> <span class="id">i</span> <span class="id">_</span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.measure.html#diracE">diracE;</a></span> <span class="id">case:</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#ifPn">ifPn</a></span> <span class="id">=&gt;</span> <span class="id">/=</span> <span class="id">iU;</span> <span class="id">[rewrite</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#mule1">mule1|rewrite</a></span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#mule0">mule0]</a></span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="binomial_probE" class="id"><a name="binomial_probE" class="">binomial_probE</a></span> <span id="U:393" class="id"><a name="U:393" class="">U</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#binomial_prob">binomial_prob</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#binomial_probability.n">n</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#binomial_probability.p">p</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#U:393">U</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span><br/>
&nbsp;&nbsp;(<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#70c6c347670b7d7a821347ad84e9446b">\sum_</a></span>(<span id="k:396" class="id"><span id="k:395" class="id"><span id="k:394" class="id"><a name="k:396" class="">k</a></span></span></span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#70c6c347670b7d7a821347ad84e9446b">&lt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#binomial_probability.n">n</a></span>.<span class="id">+1</span>) (<span class="id"><a href="mathcomp.analysis.probability.html#bin_prob">bin_prob</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#k:394">k</a></span>)%<span class="id">:num</span>%<span class="id">:E</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#f1c2ddfea282f8f8d7539f61e14c08e4">*</a></span> (<span class="id"><a href="mathcomp.analysis.measure.html#beb404b4c6e52afbdfec2979598a2318">\d_</a></span>(<span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.fintype.html#nat_of_ord">nat_of_ord</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#k:394">k</a></span>) <span class="id"><a href="mathcomp.analysis.probability.html#U:393">U</a></span>))%<span class="id">E</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof77')">Proof.</span></div>
<div class="proofscript" id="proof77">
 <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.probability.html#binomial_msum">binomial_msum</a></span>. Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="integral_binomial" class="id"><a name="integral_binomial" class="">integral_binomial</a></span> (<span id="f:397" class="id"><a name="f:397" class="">f</a></span> <span class="id">:</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#nat">nat</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#4c9ddfb63ff52527d9adecfde4a667c3">\bar</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#binomial_probability.R">R</a></span>) <span class="id">:</span> (<span class="gallina-kwd">forall</span> <span id="x:398" class="id"><a name="x:398" class="">x,</a></span> <span class="id">0</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#63b01a542aec2e4c61e028256cf5a548">&lt;=</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#f:397">f</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#x:398">x</a></span>)%<span class="id">E</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;(<span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#3e4826d90e3d691004f544dc3de2d121">\int[binomial_prob</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#binomial_probability.n">n</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#binomial_probability.p">p]_y</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#f:397">f</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#y:399">y</a></span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span><br/>
&nbsp;&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#70c6c347670b7d7a821347ad84e9446b">\sum_</a></span>(<span id="k:402" class="id"><span id="k:401" class="id"><span id="k:400" class="id"><a name="k:402" class="">k</a></span></span></span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#70c6c347670b7d7a821347ad84e9446b">&lt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#binomial_probability.n">n</a></span>.<span class="id">+1</span>) (<span class="id"><a href="mathcomp.analysis.probability.html#bin_prob">bin_prob</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#k:400">k</a></span>)%<span class="id">:num</span>%<span class="id">:E</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#f1c2ddfea282f8f8d7539f61e14c08e4">*</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#f:397">f</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#k:400">k</a></span>)%<span class="id">E</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof78')">Proof.</span></div>
<div class="proofscript" id="proof78">
<span class="id">move=&gt;</span> <span class="id">f0;</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.probability.html#binomial_msum">binomial_msum</a></span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#ge0_integral_measure_sum">ge0_integral_measure_sum//=</a></span>.<br/>
<span class="id">apply:</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.bigop.html#eq_bigr">eq_bigr</a></span> <span class="id">=&gt;</span> <span class="id">i</span> <span class="id">_</span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#ge0_integral_mscale">ge0_integral_mscale//=</a></span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#integral_dirac">integral_dirac//=</a></span> <span class="id"><a href="mathcomp.analysis.measure.html#diracT">diracT</a></span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#mul1e">mul1e</a></span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">End</span> <span class="id"><a href="mathcomp.analysis.probability.html#binomial_probability">binomial_probability</a></span>.<br/>
<br/>
<span class="vernacular">Lemma</span> <span id="integral_binomial_prob" class="id"><a name="integral_binomial_prob" class="">integral_binomial_prob</a></span> (<span id="R:403" class="id"><a name="R:403" class="">R</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.reals.html#Real.Exports.realType">realType</a></span>) <span id="n:404" class="id"><a name="n:404" class="">n</a></span> <span id="p:405" class="id"><a name="p:405" class="">p</a></span> <span id="U:406" class="id"><a name="U:406" class="">U</a></span> <span class="id">:</span> (<span class="id">0</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssrnum.html#5285549f1bd0c3f181a17cc59d549bc0">&lt;=</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#p:405">p</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssrnum.html#5285549f1bd0c3f181a17cc59d549bc0">&lt;=</a></span> <span class="id">1</span>)%<span class="id">R</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;(<span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#3e4826d90e3d691004f544dc3de2d121">\int[binomial_prob</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#n:404">n</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#p:405">p]_y</a></span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#3e4826d90e3d691004f544dc3de2d121">\d_</a></span>(<span class="id">0</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.ssrnat.html#::nat_scope:x_'&lt;'_x">&lt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#y:407">y</a></span>)%<span class="id">N</span> <span class="id"><a href="mathcomp.analysis.probability.html#U:406">U</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#b8b2ebc8e1a8b9aa935c0702efb5dccf">=</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#bernoulli">bernoulli</a></span> (<span class="id">1</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#::ring_scope:x_'-'_x">-</a></span> <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#ba5b9f829c901964a3abe669e095e940">`1-p</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#663140372ac3b275aae871b74b140513">^+</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#n:404">n</a></span>) <span class="id"><a href="mathcomp.analysis.probability.html#U:406">U</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#b8b2ebc8e1a8b9aa935c0702efb5dccf">:&gt;</a></span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#4c9ddfb63ff52527d9adecfde4a667c3">\bar</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#R:403">R</a></span>)%<span class="id">E</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof79')">Proof.</span></div>
<div class="proofscript" id="proof79">
<span class="id">move=&gt;</span> <span class="id">/andP[p0</span> <span class="id">p1];</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.probability.html#bernoulliE">bernoulliE//=;</a></span> <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssrnum.html#Num.Theory.subr_ge0">subr_ge0</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssrnum.html#Num.Theory.exprn_ile1">exprn_ile1//=;</a></span> <span class="id">[|exact/onem_ge0|exact/onem_le1]</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssrnum.html#Num.Theory.lerBlDr">lerBlDr</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#GRing.Theory.addrC">addrC</a></span> <span class="id">-lerBlDr</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#GRing.Theory.subrr">subrr;</a></span> <span class="id">exact/exprn_ge0/onem_ge0</span>.<br/>
<span class="id">rewrite</span> (@<span class="id"><a href="mathcomp.analysis.probability.html#integral_binomial">integral_binomial</a></span> <span class="id">_</span> <span class="id">n</span> <span class="id">p</span> <span class="id">_</span> <span class="id">_</span> (<span class="gallina-kwd">fun</span> <span id="y:410" class="id"><span id="y:409" class="id"><span id="y:408" class="id"><a name="y:410" class="">y</a></span></span></span> <span class="id">=&gt;</span> <span class="id"><a href="mathcomp.analysis.measure.html#beb404b4c6e52afbdfec2979598a2318">\d_</a></span>(<span class="id">1</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.ssrnat.html#cb53cf0ee22c036a03b4a9281c68b5a3">&lt;=</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#y:408">y</a></span>)%<span class="id">N</span> <span class="id">U</span>))<span class="id">//</span>.<br/>
<span class="id">rewrite</span> <span class="id">!big_ord_recl/=</span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#GRing.Theory.expr0">expr0</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#GRing.Theory.mul1r">mul1r</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.ssrnat.html#subn0">subn0</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.binomial.html#bin0">bin0</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.ssrnat.html#ltnn">ltnn</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#GRing.Theory.mulr1n">mulr1n</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#GRing.Theory.addrC">addrC</a></span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#onemD">onemD</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#GRing.Theory.opprK">opprK</a></span> <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#onem1">onem1</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#GRing.Theory.add0r">add0r;</a></span> <span class="id">congr</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#08a2d651b18eb62ef52cb69005b28285">+</a></span>%<span class="id">E</span>.<br/>
<span class="id">rewrite</span> <span class="id">/bump;</span> <span class="id">under</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.bigop.html#eq_bigr">eq_bigr</a></span> <span class="id">do</span> <span class="id">rewrite</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.ssrnat.html#leq0n">leq0n</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.ssrnat.html#add1n">add1n</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.ssrnat.html#ltnS">ltnS</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.ssrnat.html#leq0n">leq0n</a></span>.<br/>
<span class="id">rewrite</span> <span class="id">-ge0_sume_distrl;</span> <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;<span class="id">move=&gt;</span> <span class="id">i</span> <span class="id">_</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">apply/mulrn_wge0/mulr_ge0;</span> <span class="id">apply/exprn_ge0</span> <span class="id">=&gt;</span> <span class="id">//;</span> <span class="id">exact/onem_ge0</span>.<br/>
<span class="id">congr</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#76b5f4c325a4d0716da4bce1239a53f4">*</a></span>%<span class="id">E</span>.<br/>
<span class="id">transitivity</span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#70c6c347670b7d7a821347ad84e9446b">\sum_</a></span>(<span id="i:416" class="id"><span id="i:415" class="id"><span id="i:414" class="id"><span id="i:413" class="id"><span id="i:412" class="id"><span id="i:411" class="id"><a name="i:416" class="">i</a></span></span></span></span></span></span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#70c6c347670b7d7a821347ad84e9446b">&lt;</a></span> <span class="id">n</span>.<span class="id">+1</span>) (<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#ba5b9f829c901964a3abe669e095e940">`1-p</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#663140372ac3b275aae871b74b140513">^+</a></span> (<span class="id">n</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.ssrnat.html#::nat_scope:x_'-'_x">-</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#i:411">i</a></span>) <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#2d0cfb150261028f4ebd2ba355623dcc">*</a></span> <span class="id">p</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#663140372ac3b275aae871b74b140513">^+</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#i:411">i</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#e9001f602764f7896bb1eb34bf606a23">*+</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.binomial.html#95129fba25b300adee91ca933fa2fcdc">'C</a></span>(<span class="id">n,</span> <span class="id"><a href="mathcomp.analysis.probability.html#i:411">i</a></span>))%<span class="id">:E</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#::ereal_scope:x_'-'_x">-</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#ba5b9f829c901964a3abe669e095e940">`1-p</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#663140372ac3b275aae871b74b140513">^+</a></span> <span class="id">n</span>)%<span class="id">:E</span>)%<span class="id">E</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.bigop.html#big_ord_recl">big_ord_recl/=</a></span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#GRing.Theory.expr0">expr0</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#GRing.Theory.mulr1">mulr1</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.ssrnat.html#subn0">subn0</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.binomial.html#bin0">bin0</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#GRing.Theory.mulr1n">mulr1n</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#GRing.Theory.addrAC">addrAC</a></span> <span class="id">-EFinD</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#GRing.Theory.subrr">subrr</a></span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#add0e">add0e</a></span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">/bump;</span> <span class="id">under</span> <span class="id">[RHS]eq_bigr</span> <span class="id">do</span> <span class="id">rewrite</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.ssrnat.html#leq0n">leq0n</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.ssrnat.html#add1n">add1n</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#GRing.Theory.mulrC">mulrC</a></span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#sumEFin">sumEFin</a></span> <span class="id">-</span>(@<span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#GRing.Theory.exprDn_comm">exprDn_comm</a></span> <span class="id">_</span> <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#ba5b9f829c901964a3abe669e095e940">`1-p</a></span> <span class="id">p</span> <span class="id">n</span>)<span class="id">//</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#GRing.Theory.subrK">subrK</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#GRing.Theory.expr1n">expr1n</a></span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">/GRing</span>.<span class="id">comm/onem</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#GRing.Theory.mulrC">mulrC</a></span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="measurable_binomial_prob" class="id"><a name="measurable_binomial_prob" class="">measurable_binomial_prob</a></span> (<span id="R:417" class="id"><a name="R:417" class="">R</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.reals.html#Real.Exports.realType">realType</a></span>) (<span id="n:418" class="id"><a name="n:418" class="">n</a></span> <span class="id">:</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#nat">nat</a></span>) <span class="id">:</span><br/>
&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.measure.html#measurable_fun">measurable_fun</a></span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#binomial_prob">binomial_prob</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#n:418">n</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#R:417">R</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.measure.html#pprobability">pprobability</a></span> <span class="id">_</span> <span class="id">_</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof80')">Proof.</span></div>
<div class="proofscript" id="proof80">
<span class="id">apply:</span> (@<span class="id"><a href="mathcomp.analysis.measure.html#measurability">measurability</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span><br/>
&nbsp;&nbsp;(@<span class="id"><a href="mathcomp.analysis.measure.html#pset">pset</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">:</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#set">set</a></span> (<span class="id"><a href="mathcomp.classical.classical_sets.html#set">set</a></span> (<span class="id"><a href="mathcomp.analysis.measure.html#pprobability">pprobability</a></span> <span class="id">_</span> <span class="id">R</span>)))) <span class="id">=&gt;</span> <span class="id">//</span>.<br/>
<span class="id">move=&gt;</span> <span class="id">_</span> <span class="id">-[_</span> <span class="id">[r</span> <span class="id">r01]</span> <span class="id">[Ys</span> <span class="id">mYs</span> <span class="id">&lt;-]]</span> <span class="id">&lt;-;</span> <span class="id">apply:</span> <span class="id"><a href="mathcomp.analysis.lebesgue_measure.html#emeasurable_fun_infty_o">emeasurable_fun_infty_o</a></span> <span class="id">=&gt;</span> <span class="id">//=</span>.<br/>
<span class="id">rewrite</span> <span class="id">/binomial_prob/=</span>.<br/>
<span class="id">set</span> <span class="id">f</span> <span class="id">:=</span> (<span class="id">X</span> <span class="gallina-kwd">in</span> <span class="id"><a href="mathcomp.analysis.measure.html#measurable_fun">measurable_fun</a></span> <span class="id">_</span> <span class="id"><a href="mathcomp.analysis.probability.html#X:419">X</a></span>).<br/>
<span class="id">apply:</span> <span class="id"><a href="mathcomp.analysis.measure.html#measurable_fun_if">measurable_fun_if</a></span> <span class="id">=&gt;</span> <span class="id">//=</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">apply:</span> <span class="id"><a href="mathcomp.analysis.measure.html#measurable_and">measurable_and</a></span> <span class="id">=&gt;</span> <span class="id">//;</span> <span class="id">exact:</span> <span class="id"><a href="mathcomp.analysis.lebesgue_measure.html#measurable_fun_ler">measurable_fun_ler</a></span>.<br/>
<span class="id">apply:</span> (<span class="id"><a href="mathcomp.analysis.measure.html#eq_measurable_fun">eq_measurable_fun</a></span> (<span class="gallina-kwd">fun</span> <span id="t:424" class="id"><span id="t:420" class="id"><a name="t:424" class="">t</a></span></span> <span class="id">=&gt;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.sequences.html#ffadba069702e9e7be8bc2674b4cdf45">\sum_</a></span>(<span id="k:427" class="id"><span id="k:426" class="id"><span id="k:425" class="id"><span id="k:423" class="id"><span id="k:422" class="id"><span id="k:421" class="id"><a name="k:427" class="">k</a></span></span></span></span></span></span> <span class="id"><a href="mathcomp.analysis.sequences.html#ffadba069702e9e7be8bc2674b4cdf45">&lt;oo</a></span> <span class="id">|</span> <span class="id"><a href="mathcomp.analysis.probability.html#k:421">k</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7">\in</a></span> <span class="id">Ys</span>) (<span class="id"><a href="mathcomp.analysis.probability.html#binomial_pmf">binomial_pmf</a></span> <span class="id">n</span> <span class="id"><a href="mathcomp.analysis.probability.html#t:420">t</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#k:421">k</a></span>)%<span class="id">:E</span>))%<span class="id">E</span>.<br/>
&nbsp;&nbsp;<span class="id">move=&gt;</span> <span class="id">x</span> <span class="id">/set_mem[_/=</span> <span class="id">x01]</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.esum.html#nneseries_esum">nneseries_esum//</a></span> <span class="id">-1?[in</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssrmatching.ssrmatching.html#SsrMatchingSyntax.RHS">RHS]</a></span>(<span class="id"><a href="mathcomp.classical.classical_sets.html#set_mem_set">set_mem_set</a></span> <span class="id">Ys</span>)<span class="id">//</span> <span class="id">=&gt;</span> <span class="id">k</span> <span class="id">kYs</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#lee_fin">lee_fin</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#binomial_pmf_ge0">binomial_pmf_ge0</a></span>.<br/>
<span class="id">apply:</span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#ge0_emeasurable_fun_sum">ge0_emeasurable_fun_sum</a></span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">move=&gt;</span> <span class="id">k</span> <span class="id">x/=</span> <span class="id">[_</span> <span class="id">x01]</span> <span class="id">_;</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#lee_fin">lee_fin</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#binomial_pmf_ge0">binomial_pmf_ge0</a></span>.<br/>
<span class="id">move=&gt;</span> <span class="id">k</span> <span class="id">Ysk;</span> <span class="id">apply/measurableT_comp</span> <span class="id">=&gt;</span> <span class="id">//</span>.<br/>
<span class="id">exact:</span> <span class="id"><a href="mathcomp.analysis.probability.html#measurable_binomial_pmf">measurable_binomial_pmf</a></span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Section</span> <span id="uniform_probability" class="id"><a name="uniform_probability" class="">uniform_probability</a></span>.<br/>
<span class="vernacular">Local</span> <span class="vernacular">Open</span> <span class="vernacular">Scope</span> <span class="id">ring_scope</span>.<br/>
<span class="vernacular">Context</span> (<span id="R:428" class="id"><a name="R:428" class="">R</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.reals.html#Real.Exports.realType">realType</a></span>) (<span id="a:429" class="id"><a name="a:429" class="">a</a></span> <span id="b:430" class="id"><a name="b:430" class="">b</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#R:428">R</a></span>).<br/>
<br/>
<span class="vernacular">Definition</span> <span id="uniform_pdf" class="id"><a name="uniform_pdf" class="">uniform_pdf</a></span> <span id="x:431" class="id"><a name="x:431" class="">x</a></span> <span class="id">:=</span> <span class="gallina-kwd">if</span> <span class="id"><a href="mathcomp.analysis.probability.html#uniform_probability.a">a</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssrnum.html#5285549f1bd0c3f181a17cc59d549bc0">&lt;=</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#x:431">x</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssrnum.html#5285549f1bd0c3f181a17cc59d549bc0">&lt;=</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#uniform_probability.b">b</a></span> <span class="gallina-kwd">then</span> (<span class="id"><a href="mathcomp.analysis.probability.html#uniform_probability.b">b</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#::ring_scope:x_'-'_x">-</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#uniform_probability.a">a</a></span>)<span class="id">^-1</span> <span class="gallina-kwd">else</span> <span class="id">0</span>.<br/>
<br/>
<span class="vernacular">Lemma</span> <span id="uniform_pdf_ge0" class="id"><a name="uniform_pdf_ge0" class="">uniform_pdf_ge0</a></span> <span id="x:432" class="id"><a name="x:432" class="">x</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#uniform_probability.a">a</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssrnum.html#Num.Syntax.::ring_scope:x_'&lt;'_x">&lt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#uniform_probability.b">b</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id">0</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssrnum.html#cb42ec59ad57b25928e1718b4e69e031">&lt;=</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#uniform_pdf">uniform_pdf</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#x:432">x</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof81')">Proof.</span></div>
<div class="proofscript" id="proof81">
<span class="id">move=&gt;</span> <span class="id">ab;</span> <span class="id">rewrite</span> <span class="id">/uniform_pdf;</span> <span class="id">case:</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#ifPn">ifPn</a></span> <span class="id">=&gt;</span> <span class="id">//</span> <span class="id">axb</span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssrnum.html#Num.Theory.invr_ge0">invr_ge0//</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.order.html#Order.POrderTheory.ltW">ltW//</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssrnum.html#Num.Theory.subr_gt0">subr_gt0</a></span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="measurable_uniform_pdf" class="id"><a name="measurable_uniform_pdf" class="">measurable_uniform_pdf</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.measure.html#measurable_fun">measurable_fun</a></span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#uniform_pdf">uniform_pdf</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof82')">Proof.</span></div>
<div class="proofscript" id="proof82">
<span class="id">rewrite</span> <span class="id">/uniform_pdf</span> <span class="id">/=;</span> <span class="id">apply:</span> <span class="id"><a href="mathcomp.analysis.measure.html#measurable_fun_if">measurable_fun_if</a></span> <span class="id">=&gt;</span> <span class="id">//=</span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">apply:</span> <span class="id"><a href="mathcomp.analysis.measure.html#measurable_and">measurable_and</a></span> <span class="id">=&gt;</span> <span class="id">//;</span> <span class="id">exact:</span> <span class="id"><a href="mathcomp.analysis.lebesgue_measure.html#measurable_fun_ler">measurable_fun_ler</a></span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Local</span> <span class="vernacular">Notation</span> <span id="mu" class="id"><a name="mu" class="">mu</a></span> <span class="id">:=</span> <span class="id"><a href="mathcomp.analysis.lebesgue_measure.html#lebesgue_measure">lebesgue_measure</a></span>.<br/>
<br/>
<span class="vernacular">Lemma</span> <span id="integral_uniform_pdf" class="id"><a name="integral_uniform_pdf" class="">integral_uniform_pdf</a></span> <span id="U:433" class="id"><a name="U:433" class="">U</a></span> <span class="id">:</span><br/>
&nbsp;&nbsp;(<span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#871f2882c0e95b3d1e1d20f0a4fbdef3">\int[mu]_</a></span>(<span id="x:434" class="id"><a name="x:434" class="">x</a></span> <span class="gallina-kwd">in</span> <span class="id"><a href="mathcomp.analysis.probability.html#U:433">U</a></span>) (<span class="id"><a href="mathcomp.analysis.probability.html#uniform_pdf">uniform_pdf</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#x:434">x</a></span>)%<span class="id">:E</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span><br/>
&nbsp;&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#871f2882c0e95b3d1e1d20f0a4fbdef3">\int[mu]_</a></span>(<span id="x:435" class="id"><a name="x:435" class="">x</a></span> <span class="gallina-kwd">in</span> <span class="id"><a href="mathcomp.analysis.probability.html#U:433">U</a></span> <span class="id"><a href="mathcomp.classical.classical_sets.html#c7636f45aa1745dbf533da3d408cece1">`</a></span>&amp;<span class="id">`</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#0d46aeacdf83c1ab2ebf3404fa8daa4b">`[a,</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#uniform_probability.b">b]</a></span>) (<span class="id"><a href="mathcomp.analysis.probability.html#uniform_pdf">uniform_pdf</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#x:435">x</a></span>)%<span class="id">:E</span>)%<span class="id">E</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof83')">Proof.</span></div>
<div class="proofscript" id="proof83">
<span class="id">rewrite</span> <span class="id">[RHS]integral_mkcondr/=;</span> <span class="id">apply:</span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#eq_integral">eq_integral</a></span> <span class="id">=&gt;</span> <span class="id">x</span> <span class="id">xU</span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="mathcomp.classical.functions.html#patchE">patchE;</a></span> <span class="id">case:</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#ifPn">ifPn</a></span> <span class="id">=&gt;</span> <span class="id">//</span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#notin_setE">notin_setE/=</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.interval.html#in_itv">in_itv/=</a></span> <span class="id">=&gt;</span> <span class="id">/negP/negbTE</span> <span class="id">xab</span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">/uniform_pdf</span> <span class="id">xab</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="integral_uniform_pdf1" class="id"><a name="integral_uniform_pdf1" class="">integral_uniform_pdf1</a></span> <span id="A:436" class="id"><a name="A:436" class="">A</a></span> (<span id="ab:437" class="id"><a name="ab:437" class="">ab</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#uniform_probability.a">a</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssrnum.html#Num.Syntax.::ring_scope:x_'&lt;'_x">&lt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#uniform_probability.b">b</a></span>) <span class="id">:</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#0d46aeacdf83c1ab2ebf3404fa8daa4b">`[a,</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#uniform_probability.b">b]</a></span> <span class="id"><a href="mathcomp.classical.classical_sets.html#e19db46c1d4073266228fb7781521a56">`&lt;=`</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#A:436">A</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;(<span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#871f2882c0e95b3d1e1d20f0a4fbdef3">\int[mu]_</a></span>(<span id="x:438" class="id"><a name="x:438" class="">x</a></span> <span class="gallina-kwd">in</span> <span class="id"><a href="mathcomp.analysis.probability.html#A:436">A</a></span>) (<span class="id"><a href="mathcomp.analysis.probability.html#uniform_pdf">uniform_pdf</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#x:438">x</a></span>)%<span class="id">:E</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id">1</span>)%<span class="id">E</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof84')">Proof.</span></div>
<div class="proofscript" id="proof84">
<span class="id">move=&gt;</span> <span class="id">abA;</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.probability.html#integral_uniform_pdf">integral_uniform_pdf</a></span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setIidr">setIidr//</a></span>.<br/>
<span class="id">rewrite</span> (<span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#eq_integral">eq_integral</a></span> (<span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.ssrfun.html#36dd16448713ee91dfa0961a8ba48e73">fun=&gt;</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#uniform_probability.b">b</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#::ring_scope:x_'-'_x">-</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#uniform_probability.a">a</a></span>)<span class="id">^-1</span>%<span class="id">:E</span>))<span class="id">;</span> <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">move=&gt;</span> <span class="id">x;</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#inE">inE/=</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.interval.html#in_itv">in_itv/=</a></span> <span class="id">/uniform_pdf</span> <span class="id">=&gt;</span> <span class="id">-&gt;</span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#integral_cst">integral_cst//=</a></span> <span class="id"><a href="mathcomp.analysis.lebesgue_measure.html#lebesgue_measure_itv">lebesgue_measure_itv/=</a></span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#lte_fin">lte_fin</a></span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">ab</span> <span class="id">-EFinD</span> <span class="id">-EFinM</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#GRing.Theory.mulVf">mulVf//</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.order.html#Order.POrderTheory.gt_eqF">gt_eqF//</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssrnum.html#Num.Theory.subr_gt0">subr_gt0</a></span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Definition</span> <span id="uniform_prob" class="id"><a name="uniform_prob" class="">uniform_prob</a></span> (<span id="ab:439" class="id"><a name="ab:439" class="">ab</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#uniform_probability.a">a</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssrnum.html#Num.Syntax.::ring_scope:x_'&lt;'_x">&lt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#uniform_probability.b">b</a></span>) <span class="id">:</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#set">set</a></span> <span class="id">_</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#4c9ddfb63ff52527d9adecfde4a667c3">\bar</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#uniform_probability.R">R</a></span> <span class="id">:=</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">fun</span> <span id="U:440" class="id"><a name="U:440" class="">U</a></span> <span class="id">=&gt;</span> (<span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#871f2882c0e95b3d1e1d20f0a4fbdef3">\int[mu]_</a></span>(<span id="x:441" class="id"><a name="x:441" class="">x</a></span> <span class="gallina-kwd">in</span> <span class="id"><a href="mathcomp.analysis.probability.html#U:440">U</a></span>) (<span class="id"><a href="mathcomp.analysis.probability.html#uniform_pdf">uniform_pdf</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#x:441">x</a></span>)%<span class="id">:E</span>)%<span class="id">E</span>.<br/>
<br/>
<span class="vernacular">Hypothesis</span> <span id="uniform_probability.ab" class="id"><a name="uniform_probability.ab" class="">ab</a></span> <span class="id">:</span> (<span class="id"><a href="mathcomp.analysis.probability.html#uniform_probability.a">a</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssrnum.html#Num.Syntax.::ring_scope:x_'&lt;'_x">&lt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#uniform_probability.b">b</a></span>)%<span class="id">R</span>.<br/>
<br/>
<span class="vernacular">Let</span> <span id="uniform_probability.uniform0" class="id"><a name="uniform_probability.uniform0" class="">uniform0</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#uniform_prob">uniform_prob</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#uniform_probability.ab">ab</a></span> <span class="id"><a href="mathcomp.classical.classical_sets.html#set0">set0</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id">0</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof85')">Proof.</span></div>
<div class="proofscript" id="proof85">
 <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">/uniform_prob</span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#integral_set0">integral_set0</a></span>. Qed.</div>
<br/>
<span class="vernacular">Let</span> <span id="uniform_probability.uniform_ge0" class="id"><a name="uniform_probability.uniform_ge0" class="">uniform_ge0</a></span> <span id="U:443" class="id"><a name="U:443" class="">U</a></span> <span class="id">:</span> (<span class="id">0</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#63b01a542aec2e4c61e028256cf5a548">&lt;=</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#uniform_prob">uniform_prob</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#uniform_probability.ab">ab</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#U:443">U</a></span>)%<span class="id">E</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof86')">Proof.</span></div>
<div class="proofscript" id="proof86">
<span class="gallina-kwd">by</span> <span class="id">apply:</span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#integral_ge0">integral_ge0</a></span> <span class="id">=&gt;</span> <span class="id">/=</span> <span class="id">x</span> <span class="id">Ux;</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#lee_fin">lee_fin</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#uniform_pdf_ge0">uniform_pdf_ge0</a></span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="integrable_uniform_pdf" class="id"><a name="integrable_uniform_pdf" class="">integrable_uniform_pdf</a></span> <span class="id">:</span><br/>
&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#mu">mu</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="gallina-kwd">fun</span> <span id="x:444" class="id"><a name="x:444" class="">x</a></span> <span class="id">=&gt;</span> (<span class="id"><a href="mathcomp.analysis.probability.html#uniform_pdf">uniform_pdf</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#x:444">x</a></span>)%<span class="id">:E</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof87')">Proof.</span></div>
<div class="proofscript" id="proof87">
<span class="id">apply/integrableP;</span> <span class="id">split</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">apply:</span> <span class="id"><a href="mathcomp.analysis.measure.html#measurableT_comp">measurableT_comp</a></span> <span class="id">=&gt;</span> <span class="id">//;</span> <span class="id">exact:</span> <span class="id"><a href="mathcomp.analysis.probability.html#measurable_uniform_pdf">measurable_uniform_pdf</a></span>.<br/>
<span class="id">under</span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#eq_integral">eq_integral</a></span>.<br/>
&nbsp;&nbsp;<span class="id">move=&gt;</span> <span class="id">x</span> <span class="id">_;</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#gee0_abs">gee0_abs//;</a></span> <span class="id">last</span> <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#lee_fin">lee_fin</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#uniform_pdf_ge0">uniform_pdf_ge0</a></span>.<br/>
&nbsp;&nbsp;<span class="id">over</span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">/=</span> <span class="id"><a href="mathcomp.analysis.probability.html#integral_uniform_pdf1">integral_uniform_pdf1</a></span> <span class="id">?ltry//</span> <span class="id">-subr_gt0</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Let</span> <span id="uniform_probability.uniform_sigma_additive" class="id"><a name="uniform_probability.uniform_sigma_additive" class="">uniform_sigma_additive</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.measure.html#semi_sigma_additive">semi_sigma_additive</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#uniform_prob">uniform_prob</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#uniform_probability.ab">ab</a></span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof88')">Proof.</span></div>
<div class="proofscript" id="proof88">
<span class="id">move=&gt;</span> <span class="id">/=</span> <span class="id">F</span> <span class="id">mF</span> <span class="id">tF</span> <span class="id">mUF;</span> <span class="id">rewrite</span> <span class="id">/uniform_prob;</span> <span class="id">apply:</span> <span class="id"><a href="mathcomp.analysis.topology.html#cvg_toP">cvg_toP</a></span>.<br/>
&nbsp;&nbsp;<span class="id">apply:</span> <span class="id"><a href="mathcomp.analysis.sequences.html#ereal_nondecreasing_is_cvgn">ereal_nondecreasing_is_cvgn</a></span> <span class="id">=&gt;</span> <span class="id">m</span> <span class="id">n</span> <span class="id">mn</span>.<br/>
&nbsp;&nbsp;<span class="id">apply:</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#lee_sum_nneg_natr">lee_sum_nneg_natr</a></span> <span class="id">=&gt;</span> <span class="id">//</span> <span class="id">k</span> <span class="id">_</span> <span class="id">_</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">apply:</span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#integral_ge0">integral_ge0</a></span> <span class="id">=&gt;</span> <span class="id">/=</span> <span class="id">x</span> <span class="id">Fkx;</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#lee_fin">lee_fin</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#uniform_pdf_ge0">uniform_pdf_ge0</a></span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#ge0_integral_bigcup">ge0_integral_bigcup//=</a></span>.<br/>
<span class="id">-</span> <span class="id">apply:</span> <span class="id"><a href="mathcomp.analysis.measure.html#measurable_funTS">measurable_funTS;</a></span> <span class="id">apply:</span> <span class="id"><a href="mathcomp.analysis.measure.html#measurableT_comp">measurableT_comp</a></span> <span class="id">=&gt;</span> <span class="id">//</span>.<br/>
&nbsp;&nbsp;<span class="id">exact:</span> <span class="id"><a href="mathcomp.analysis.probability.html#measurable_uniform_pdf">measurable_uniform_pdf</a></span>.<br/>
<span class="id">-</span> <span class="gallina-kwd">by</span> <span class="id">move=&gt;</span> <span class="id">x</span> <span class="id">_;</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#lee_fin">lee_fin</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#uniform_pdf_ge0">uniform_pdf_ge0</a></span>.<br/>
Qed.</div>
<br/>
<span id="probability_uniform_prob__canonical__measure_Measure" class="id"><span id="HB_unnamed_mixin_69" class="id"><span id="probability_uniform_prob__canonical__measure_Content" class="id"><span id="HB_unnamed_mixin_68" class="id"><span id="measure_isMeasure__to__measure_isContent__67" class="id"><span id="measure_isMeasure__to__measure_Content_isMeasure__65" class="id"><span id="HB_unnamed_factory_63" class="id"><a name="probability_uniform_prob__canonical__measure_Measure" class="hierarchy-builder">HB.instance</a></span></span></span></span></span></span></span> <span class="vernacular">Definition</span> <span class="id">_</span> <span class="id">:=</span> <span class="id"><a href="mathcomp.analysis.measure.html#isMeasure.Build">isMeasure.Build</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> (<span class="id"><a href="mathcomp.analysis.probability.html#uniform_prob">uniform_prob</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#uniform_probability.ab">ab</a></span>)<br/>
&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#uniform_probability.uniform0">uniform0</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#uniform_probability.uniform_ge0">uniform_ge0</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#uniform_probability.uniform_sigma_additive">uniform_sigma_additive</a></span>.<br/>
<br/>
<span class="vernacular">Let</span> <span id="uniform_probability.uniform_setT" class="id"><a name="uniform_probability.uniform_setT" class="">uniform_setT</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#uniform_prob">uniform_prob</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#uniform_probability.ab">ab</a></span> <span class="id"><a href="mathcomp.classical.classical_sets.html#36b9f1631384d2c3b944cb9d5855cd98">[set:</a></span> <span class="id">_]</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id">1</span>%<span class="id">:E</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof89')">Proof.</span></div>
<div class="proofscript" id="proof89">
 <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">/uniform_prob</span> <span class="id">/mscale/=</span> <span class="id"><a href="mathcomp.analysis.probability.html#integral_uniform_pdf1">integral_uniform_pdf1</a></span>. Qed.</div>
<br/>
<span id="probability_uniform_prob__canonical__measure_Probability" class="id"><span id="HB_unnamed_mixin_85" class="id"><span id="probability_uniform_prob__canonical__measure_SubProbability" class="id"><span id="HB_unnamed_mixin_84" class="id"><span id="probability_uniform_prob__canonical__measure_FiniteMeasure" class="id"><span id="probability_uniform_prob__canonical__measure_FinNumFun" class="id"><span id="HB_unnamed_mixin_83" class="id"><span id="probability_uniform_prob__canonical__measure_SigmaFiniteMeasure" class="id"><span id="probability_uniform_prob__canonical__measure_SFiniteMeasure" class="id"><span id="HB_unnamed_mixin_82" class="id"><span id="probability_uniform_prob__canonical__measure_SigmaFiniteContent" class="id"><span id="HB_unnamed_mixin_81" class="id"><span id="measure_Measure_isProbability__to__measure_isFinite__80" class="id"><span id="measure_Measure_isProbability__to__measure_isSFinite__78" class="id"><span id="measure_Measure_isProbability__to__measure_isSubProbability__76" class="id"><span id="measure_Measure_isProbability__to__measure_isSigmaFinite__74" class="id"><span id="measure_Measure_isProbability__to__measure_isProbability__72" class="id"><span id="HB_unnamed_factory_70" class="id"><a name="probability_uniform_prob__canonical__measure_Probability" class="hierarchy-builder">HB.instance</a></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span> <span class="vernacular">Definition</span> <span class="id">_</span> <span class="id">:=</span> @<span class="id"><a href="mathcomp.analysis.measure.html#Measure_isProbability.Build">Measure_isProbability.Build</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id"><a href="mathcomp.analysis.probability.html#uniform_probability.R">R</a></span><br/>
&nbsp;&nbsp;(<span class="id"><a href="mathcomp.analysis.probability.html#uniform_prob">uniform_prob</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#uniform_probability.ab">ab</a></span>) <span class="id"><a href="mathcomp.analysis.probability.html#uniform_probability.uniform_setT">uniform_setT</a></span>.<br/>
<br/>
<span class="vernacular">Lemma</span> <span id="dominates_uniform_prob" class="id"><a name="dominates_uniform_prob" class="">dominates_uniform_prob</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#uniform_prob">uniform_prob</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#uniform_probability.ab">ab</a></span> <span class="id"><a href="mathcomp.analysis.measure.html#2d7ffffaaa230b2304e22e4907064098">`&lt;&lt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#mu">mu</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof90')">Proof.</span></div>
<div class="proofscript" id="proof90">
<span class="id">move=&gt;</span> <span class="id">A</span> <span class="id">mA</span> <span class="id">muA0;</span> <span class="id">rewrite</span> <span class="id">/uniform_prob</span> <span class="id"><a href="mathcomp.analysis.probability.html#integral_uniform_pdf">integral_uniform_pdf</a></span>.<br/>
<span class="id">apply/eqP;</span> <span class="id">rewrite</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.order.html#Order.POrderTheory.eq_le">eq_le;</a></span> <span class="id">apply/andP;</span> <span class="id">split;</span> <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;<span class="id">apply:</span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#integral_ge0">integral_ge0</a></span> <span class="id">=&gt;</span> <span class="id">x</span> <span class="id">[Ax</span> <span class="id">/=];</span> <span class="id">rewrite</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.interval.html#in_itv">in_itv</a></span> <span class="id">/=</span> <span class="id">=&gt;</span> <span class="id">xab</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#lee_fin">lee_fin</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#uniform_pdf_ge0">uniform_pdf_ge0</a></span>.<br/>
<span class="id">apply:</span> (@<span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.order.html#Order.POrderTheory.le_trans">le_trans</a></span> <span class="id">_</span> <span class="id">_</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#871f2882c0e95b3d1e1d20f0a4fbdef3">\int[mu]_</a></span>(<span id="x:446" class="id"><span id="x:445" class="id"><a name="x:446" class="">x</a></span></span> <span class="gallina-kwd">in</span> <span class="id">A</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#c7636f45aa1745dbf533da3d408cece1">`</a></span>&amp;<span class="id">`</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#0d46aeacdf83c1ab2ebf3404fa8daa4b">`[a,</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#uniform_probability.b">b]</a></span>%<span class="id">classic</span>) (<span class="id"><a href="mathcomp.analysis.probability.html#uniform_probability.b">b</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#::ring_scope:x_'-'_x">-</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#uniform_probability.a">a</a></span>)<span class="id">^-1</span>%<span class="id">:E</span>))%<span class="id">E;</span> <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#integral_cst">integral_cst//=</a></span> <span class="id">?mul1e//</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#pmule_rle0">pmule_rle0</a></span> <span class="id">?lte_fin</span> <span class="id">?invr_gt0//</span> <span class="id">?subr_gt0//</span> <span class="id">-muA0</span> <span class="id"><a href="mathcomp.analysis.measure.html#measureIl">measureIl</a></span>.<br/>
&nbsp;&nbsp;<span class="id">exact:</span> <span class="id"><a href="mathcomp.analysis.measure.html#measurableI">measurableI</a></span>.<br/>
<span class="id">apply:</span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#ge0_le_integral">ge0_le_integral</a></span> <span class="id">=&gt;</span> <span class="id">//=</span>.<br/>
<span class="id">-</span> <span class="id">exact:</span> <span class="id"><a href="mathcomp.analysis.measure.html#measurableI">measurableI</a></span>.<br/>
<span class="id">-</span> <span class="gallina-kwd">by</span> <span class="id">move=&gt;</span> <span class="id">x</span> <span class="id">[Ax];</span> <span class="id">rewrite</span> <span class="id">/=</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.interval.html#in_itv">in_itv/=</a></span> <span class="id">=&gt;</span> <span class="id">axb;</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#lee_fin">lee_fin</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#uniform_pdf_ge0">uniform_pdf_ge0</a></span>.<br/>
<span class="id">-</span> <span class="gallina-kwd">by</span> <span class="id">apply/EFin_measurable_fun/measurable_funTS;</span> <span class="id">exact:</span> <span class="id"><a href="mathcomp.analysis.probability.html#measurable_uniform_pdf">measurable_uniform_pdf</a></span>.<br/>
<span class="id">-</span> <span class="gallina-kwd">by</span> <span class="id">move=&gt;</span> <span class="id">x</span> <span class="id">[Ax</span> <span class="id">_];</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#lee_fin">lee_fin</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssrnum.html#Num.Theory.invr_ge0">invr_ge0//</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.order.html#Order.POrderTheory.ltW">ltW//</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssrnum.html#Num.Theory.subr_gt0">subr_gt0</a></span>.<br/>
<span class="id">-</span> <span class="gallina-kwd">by</span> <span class="id">move=&gt;</span> <span class="id">x</span> <span class="id">[Ax];</span> <span class="id">rewrite</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.interval.html#in_itv">in_itv/=</a></span> <span class="id">/uniform_pdf</span> <span class="id">=&gt;</span> <span class="id">-&gt;</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Let</span> <span id="uniform_probability.integral_uniform_indic" class="id"><a name="uniform_probability.integral_uniform_indic" class="">integral_uniform_indic</a></span> <span id="E:447" class="id"><a name="E:447" class="">E</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.measure.html#measurable">measurable</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#E:447">E</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;(<span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#3e4826d90e3d691004f544dc3de2d121">\int[uniform_prob</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#uniform_probability.ab">ab]_x</a></span> (<span class="id"><a href="mathcomp.analysis.numfun.html#e353122e03268a6eab33cb5af81dd3c6">\1_E</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#x:448">x</a></span>)%<span class="id">:E</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span><br/>
&nbsp;&nbsp;&nbsp;(<span class="id"><a href="mathcomp.analysis.probability.html#uniform_probability.b">b</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#::ring_scope:x_'-'_x">-</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#uniform_probability.a">a</a></span>)<span class="id">^-1</span>%<span class="id">:E</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#f1c2ddfea282f8f8d7539f61e14c08e4">*</a></span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#871f2882c0e95b3d1e1d20f0a4fbdef3">\int[mu]_</a></span>(<span id="x:449" class="id"><a name="x:449" class="">x</a></span> <span class="gallina-kwd">in</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#0d46aeacdf83c1ab2ebf3404fa8daa4b">`[a,</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#uniform_probability.b">b]</a></span>) (<span class="id"><a href="mathcomp.analysis.numfun.html#e353122e03268a6eab33cb5af81dd3c6">\1_E</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#x:449">x</a></span>)%<span class="id">:E</span>)%<span class="id">E</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof91')">Proof.</span></div>
<div class="proofscript" id="proof91">
<span class="id">move=&gt;</span> <span class="id">mE;</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#integral_indic">integral_indic//=</a></span> <span class="id">/uniform_prob</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setIT">setIT</a></span> <span class="id">-ge0_integralZl//=</span>.<br/>
<span class="id">-</span> <span class="id">rewrite</span> <span class="id">[LHS]integral_mkcond/=</span> <span class="id">[RHS]integral_mkcond/=</span>.<br/>
&nbsp;&nbsp;<span class="id">apply:</span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#eq_integral">eq_integral</a></span> <span class="id">=&gt;</span> <span class="id">x</span> <span class="id">_;</span> <span class="id">rewrite</span> <span class="id">!patchE;</span> <span class="id">case:</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#ifPn">ifPn</a></span> <span class="id">=&gt;</span> <span class="id">xE</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case:</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#ifPn">ifPn</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#inE">inE/=</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.interval.html#in_itv">in_itv/=</a></span> <span class="id">=&gt;</span> <span class="id">xab</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">/uniform_pdf</span> <span class="id">xab</span> <span class="id"><a href="mathcomp.analysis.numfun.html#indicE">indicE</a></span> <span class="id">xE</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#mule1">mule1</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#notin_setE">notin_setE/=</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.interval.html#in_itv">in_itv/=</a></span> <span class="id">=&gt;</span> <span class="id">/negP/negbTE;</span> <span class="id">rewrite</span> <span class="id">/uniform_pdf</span> <span class="id">=&gt;</span> <span class="id">-&gt;</span>.<br/>
&nbsp;&nbsp;<span class="id">case:</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#ifPn">ifPn</a></span> <span class="id">=&gt;</span> <span class="id">//</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#inE">inE/=</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.interval.html#in_itv">in_itv/=</a></span> <span class="id">=&gt;</span> <span class="id">axb;</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.numfun.html#indicE">indicE</a></span> (<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#negbTE">negbTE</a></span> <span class="id">xE</span>) <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#mule0">mule0</a></span>.<br/>
<span class="id">-</span> <span class="id">exact/EFin_measurable_fun/measurable_indic</span>.<br/>
<span class="id">-</span> <span class="gallina-kwd">by</span> <span class="id">move=&gt;</span> <span class="id">x</span> <span class="id">_;</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#lee_fin">lee_fin</a></span>.<br/>
<span class="id">-</span> <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#lee_fin">lee_fin</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssrnum.html#Num.Theory.invr_ge0">invr_ge0//</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.order.html#Order.POrderTheory.ltW">ltW//</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssrnum.html#Num.Theory.subr_gt0">subr_gt0</a></span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Let</span> <span id="uniform_probability.integral_uniform_nnsfun" class="id"><a name="uniform_probability.integral_uniform_nnsfun" class="">integral_uniform_nnsfun</a></span> (<span id="f:450" class="id"><a name="f:450" class="">f</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#62b1f9be67dbf6239bec964ff9de3502">{nnsfun</a></span> <span class="id">_</span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#62b1f9be67dbf6239bec964ff9de3502">&gt;-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#uniform_probability.R">R}</a></span>) <span class="id">:</span><br/>
&nbsp;&nbsp;(<span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#3e4826d90e3d691004f544dc3de2d121">\int[uniform_prob</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#uniform_probability.ab">ab]_x</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#f:450">f</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#x:451">x</a></span>)%<span class="id">:E</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span><br/>
&nbsp;&nbsp;&nbsp;(<span class="id"><a href="mathcomp.analysis.probability.html#uniform_probability.b">b</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#::ring_scope:x_'-'_x">-</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#uniform_probability.a">a</a></span>)<span class="id">^-1</span>%<span class="id">:E</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#f1c2ddfea282f8f8d7539f61e14c08e4">*</a></span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#871f2882c0e95b3d1e1d20f0a4fbdef3">\int[mu]_</a></span>(<span id="x:452" class="id"><a name="x:452" class="">x</a></span> <span class="gallina-kwd">in</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#0d46aeacdf83c1ab2ebf3404fa8daa4b">`[a,</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#uniform_probability.b">b]</a></span>) (<span class="id"><a href="mathcomp.analysis.probability.html#f:450">f</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#x:452">x</a></span>)%<span class="id">:E</span>)%<span class="id">E</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof92')">Proof.</span></div>
<div class="proofscript" id="proof92">
<span class="id">under</span> <span class="id">[LHS]eq_integral</span> <span class="id">do</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#fimfunE">fimfunE</a></span> <span class="id">-fsumEFin//</span>.<br/>
<span class="id">rewrite</span> <span class="id">[LHS]ge0_integral_fsum//;</span> <span class="id">last</span> <span class="id">2</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;<span class="id">-</span> <span class="gallina-kwd">by</span> <span class="id">move=&gt;</span> <span class="id">r;</span> <span class="id">exact/EFin_measurable_fun/measurableT_comp</span>.<br/>
&nbsp;&nbsp;<span class="id">-</span> <span class="gallina-kwd">by</span> <span class="id">move=&gt;</span> <span class="id">n</span> <span class="id">x</span> <span class="id">_;</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFinM">EFinM</a></span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#nnfun_muleindic_ge0">nnfun_muleindic_ge0</a></span>.<br/>
<span class="id">rewrite</span> <span class="id">-[RHS]ge0_integralZl//;</span> <span class="id">last</span> <span class="id">3</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;<span class="id">-</span> <span class="id">exact/EFin_measurable_fun/measurable_funTS</span>.<br/>
&nbsp;&nbsp;<span class="id">-</span> <span class="gallina-kwd">by</span> <span class="id">move=&gt;</span> <span class="id">x</span> <span class="id">_;</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#lee_fin">lee_fin</a></span>.<br/>
&nbsp;&nbsp;<span class="id">-</span> <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#lee_fin">lee_fin</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssrnum.html#Num.Theory.invr_ge0">invr_ge0//</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.order.html#Order.POrderTheory.ltW">ltW//</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssrnum.html#Num.Theory.subr_gt0">subr_gt0</a></span>.<br/>
<span class="id">under</span> <span class="id">[RHS]eq_integral</span>.<br/>
&nbsp;&nbsp;<span class="id">move=&gt;</span> <span class="id">x</span> <span class="id">xD;</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#fimfunE">fimfunE</a></span> <span class="id">-fsumEFin//</span> <span class="id"><a href="mathcomp.analysis.ereal.html#ge0_mule_fsumr">ge0_mule_fsumr;</a></span> <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">move=&gt;</span> <span class="id">r;</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFinM">EFinM</a></span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#nnfun_muleindic_ge0">nnfun_muleindic_ge0</a></span>.<br/>
&nbsp;&nbsp;<span class="id">over</span>.<br/>
<span class="id">rewrite</span> <span class="id">[RHS]ge0_integral_fsum//;</span> <span class="id">last</span> <span class="id">2</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;<span class="id">-</span> <span class="gallina-kwd">by</span> <span class="id">move=&gt;</span> <span class="id">r;</span> <span class="id">apply/EFin_measurable_fun;</span> <span class="id">do</span> <span class="id">2</span> <span class="id">apply/measurableT_comp</span> <span class="id">=&gt;</span> <span class="id">//</span>.<br/>
&nbsp;&nbsp;<span class="id">-</span> <span class="id">move=&gt;</span> <span class="id">n</span> <span class="id">x</span> <span class="id">_;</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFinM">EFinM</a></span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#mule_ge0">mule_ge0//;</a></span> <span class="id">last</span> <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#nnfun_muleindic_ge0">nnfun_muleindic_ge0</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#lee_fin">lee_fin</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssrnum.html#Num.Theory.invr_ge0">invr_ge0//</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.order.html#Order.POrderTheory.ltW">ltW//</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssrnum.html#Num.Theory.subr_gt0">subr_gt0</a></span>.<br/>
<span class="id">apply:</span> <span class="id"><a href="mathcomp.classical.fsbigop.html#eq_fsbigr">eq_fsbigr</a></span> <span class="id">=&gt;</span> <span class="id">r</span> <span class="id">_;</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#ge0_integralZl">ge0_integralZl//</a></span>.<br/>
<span class="id">-</span> <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">!integralZl_indic_nnsfun//=</span> <span class="id"><a href="mathcomp.analysis.probability.html#uniform_probability.integral_uniform_indic">integral_uniform_indic//</a></span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#muleCA">muleCA</a></span>.<br/>
<span class="id">-</span> <span class="id">exact/EFin_measurable_fun/measurableT_comp</span>.<br/>
<span class="id">-</span> <span class="gallina-kwd">by</span> <span class="id">move=&gt;</span> <span class="id">t</span> <span class="id">_;</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#nnfun_muleindic_ge0">nnfun_muleindic_ge0</a></span>.<br/>
<span class="id">-</span> <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#lee_fin">lee_fin</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssrnum.html#Num.Theory.invr_ge0">invr_ge0//</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.order.html#Order.POrderTheory.ltW">ltW//</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssrnum.html#Num.Theory.subr_gt0">subr_gt0</a></span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="integral_uniform" class="id"><a name="integral_uniform" class="">integral_uniform</a></span> (<span id="f:453" class="id"><a name="f:453" class="">f</a></span> <span class="id">:</span> <span class="id">_</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#4c9ddfb63ff52527d9adecfde4a667c3">\bar</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#uniform_probability.R">R</a></span>) <span class="id">:</span><br/>
&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.measure.html#measurable_fun">measurable_fun</a></span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#f:453">f</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> (<span class="gallina-kwd">forall</span> <span id="x:454" class="id"><a name="x:454" class="">x,</a></span> <span class="id">0</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#63b01a542aec2e4c61e028256cf5a548">&lt;=</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#f:453">f</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#x:454">x</a></span>)%<span class="id">E</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;(<span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#3e4826d90e3d691004f544dc3de2d121">\int[uniform_prob</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#uniform_probability.ab">ab]_x</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#f:453">f</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#x:455">x</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#uniform_probability.b">b</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#::ring_scope:x_'-'_x">-</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#uniform_probability.a">a</a></span>)<span class="id">^-1</span>%<span class="id">:E</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#f1c2ddfea282f8f8d7539f61e14c08e4">*</a></span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#871f2882c0e95b3d1e1d20f0a4fbdef3">\int[mu]_</a></span>(<span id="x:456" class="id"><a name="x:456" class="">x</a></span> <span class="gallina-kwd">in</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#0d46aeacdf83c1ab2ebf3404fa8daa4b">`[a,</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#uniform_probability.b">b]</a></span>) <span class="id"><a href="mathcomp.analysis.probability.html#f:453">f</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#x:456">x</a></span>)%<span class="id">E</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof93')">Proof.</span></div>
<div class="proofscript" id="proof93">
<span class="id">move=&gt;</span> <span class="id">mf</span> <span class="id">f0</span>.<br/>
<span class="id">have</span> <span class="id">[f_</span> <span class="id">[ndf_</span> <span class="id">f_f]]</span> <span class="id">:=</span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#approximation">approximation</a></span> <span class="id"><a href="mathcomp.analysis.measure.html#measurableT">measurableT</a></span> <span class="id">mf</span> (<span class="gallina-kwd">fun</span> <span id="y:457" class="id"><a name="y:457" class="">y</a></span> <span class="id">_</span> <span class="id">=&gt;</span> <span class="id">f0</span> <span class="id"><a href="mathcomp.analysis.probability.html#y:457">y</a></span>).<br/>
<span class="id">transitivity</span> (<span class="id"><a href="mathcomp.analysis.topology.html#lim">lim</a></span> (<span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#3e4826d90e3d691004f544dc3de2d121">\int[uniform_prob</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#uniform_probability.ab">ab]_x</a></span> (<span class="id">f_</span> <span class="id"><a href="mathcomp.analysis.probability.html#n:458">n</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#x:459">x</a></span>)%<span class="id">:E</span> @<span class="id">[n</span> <span class="id"><a href="mathcomp.analysis.topology.html#9ae20bc67dba0e37ea0806b2f353bb2f">--&gt;</a></span> <span class="id"><a href="mathcomp.analysis.topology.html#228a5fbd8d7ef28f21231bccff88d0b0">\oo]</a></span>)%<span class="id">E</span>).<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">-monotone_convergence//=</span>.<br/>
&nbsp;&nbsp;<span class="id">-</span> <span class="id">apply:</span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#eq_integral">eq_integral</a></span> <span class="id">=&gt;</span> <span class="id">?</span> <span class="id">/[!inE]</span> <span class="id">xD;</span> <span class="id">apply/esym/cvg_lim</span> <span class="id">=&gt;</span> <span class="id">//=</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exact:</span> <span class="id">f_f</span>.<br/>
&nbsp;&nbsp;<span class="id">-</span> <span class="gallina-kwd">by</span> <span class="id">move=&gt;</span> <span class="id">n;</span> <span class="id">exact/EFin_measurable_fun/measurable_funTS</span>.<br/>
&nbsp;&nbsp;<span class="id">-</span> <span class="gallina-kwd">by</span> <span class="id">move=&gt;</span> <span class="id">n</span> <span class="id">?</span> <span class="id">_;</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#lee_fin">lee_fin</a></span>.<br/>
&nbsp;&nbsp;<span class="id">-</span> <span class="gallina-kwd">by</span> <span class="id">move=&gt;</span> <span class="id">?</span> <span class="id">_</span> <span class="id">?</span> <span class="id">?</span> <span class="id">mn;</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#lee_fin">lee_fin;</a></span> <span class="id">exact/lefP/ndf_</span>.<br/>
<span class="id">rewrite</span> <span class="id">[X</span> <span class="gallina-kwd">in</span> <span class="id">_</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> (<span class="id">_</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#f1c2ddfea282f8f8d7539f61e14c08e4">*</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:466">X</a></span>)%<span class="id">E]</span>(<span class="id">_</span> <span class="id">:</span> <span class="id">_</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="mathcomp.analysis.topology.html#lim">lim</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#871f2882c0e95b3d1e1d20f0a4fbdef3">\int[mu]_</a></span>(<span id="x:468" class="id"><span id="x:465" class="id"><span id="x:463" class="id"><a name="x:468" class="">x</a></span></span></span> <span class="gallina-kwd">in</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#0d46aeacdf83c1ab2ebf3404fa8daa4b">`[a,</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#uniform_probability.b">b]</a></span>) (<span class="id">f_</span> <span class="id"><a href="mathcomp.analysis.probability.html#n:462">n</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#x:463">x</a></span>)%<span class="id">:E</span> @<span class="id">[n</span> <span class="id"><a href="mathcomp.analysis.topology.html#9ae20bc67dba0e37ea0806b2f353bb2f">--&gt;</a></span> <span class="id"><a href="mathcomp.analysis.topology.html#228a5fbd8d7ef28f21231bccff88d0b0">\oo]</a></span>)%<span class="id">E</span>)<span class="id">;</span> <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">-monotone_convergence//=</span>.<br/>
&nbsp;&nbsp;<span class="id">-</span> <span class="gallina-kwd">by</span> <span class="id">apply:</span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#eq_integral">eq_integral</a></span> <span class="id">=&gt;</span> <span class="id">?</span> <span class="id">/[!inE]</span> <span class="id">xD;</span> <span class="id">apply/esym/cvg_lim</span> <span class="id">=&gt;</span> <span class="id">//;</span> <span class="id">exact:</span> <span class="id">f_f</span>.<br/>
&nbsp;&nbsp;<span class="id">-</span> <span class="gallina-kwd">by</span> <span class="id">move=&gt;</span> <span class="id">n;</span> <span class="id">exact/EFin_measurable_fun/measurable_funTS</span>.<br/>
&nbsp;&nbsp;<span class="id">-</span> <span class="gallina-kwd">by</span> <span class="id">move=&gt;</span> <span class="id">n</span> <span class="id">?</span> <span class="id">_;</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#lee_fin">lee_fin</a></span>.<br/>
&nbsp;&nbsp;<span class="id">-</span> <span class="gallina-kwd">by</span> <span class="id">move=&gt;</span> <span class="id">?</span> <span class="id">_</span> <span class="id">?</span> <span class="id">?</span> <span class="id">/ndf_</span> <span class="id">/lefP;</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#lee_fin">lee_fin</a></span>.<br/>
<span class="id">rewrite</span> <span class="id">-limeMl//</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">apply:</span> <span class="id"><a href="mathcomp.analysis.sequences.html#congr_lim">congr_lim;</a></span> <span class="id">apply/funext</span> <span class="id">=&gt;</span> <span class="id">n</span> <span class="id">/=;</span> <span class="id">exact:</span> <span class="id"><a href="mathcomp.analysis.probability.html#uniform_probability.integral_uniform_nnsfun">integral_uniform_nnsfun</a></span>.<br/>
<span class="id">apply/ereal_nondecreasing_is_cvgn</span> <span class="id">=&gt;</span> <span class="id">x</span> <span class="id">y</span> <span class="id">xy;</span> <span class="id">apply:</span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#ge0_le_integral">ge0_le_integral</a></span> <span class="id">=&gt;</span> <span class="id">//=</span>.<br/>
<span class="id">-</span> <span class="gallina-kwd">by</span> <span class="id">move=&gt;</span> <span class="id">?</span> <span class="id">_;</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#lee_fin">lee_fin</a></span>.<br/>
<span class="id">-</span> <span class="id">exact/EFin_measurable_fun/measurable_funTS</span>.<br/>
<span class="id">-</span> <span class="gallina-kwd">by</span> <span class="id">move=&gt;</span> <span class="id">?</span> <span class="id">_;</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#lee_fin">lee_fin</a></span>.<br/>
<span class="id">-</span> <span class="id">exact/EFin_measurable_fun/measurable_funTS</span>.<br/>
<span class="id">-</span> <span class="gallina-kwd">by</span> <span class="id">move=&gt;</span> <span class="id">?</span> <span class="id">_;</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#lee_fin">lee_fin;</a></span> <span class="id">move/ndf_</span> <span class="id">:</span> <span class="id">xy</span> <span class="id">=&gt;</span> <span class="id">/lefP</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">End</span> <span class="id"><a href="mathcomp.analysis.probability.html#uniform_probability">uniform_probability</a></span>.<br/>

      <div class="footer"><hr/>Generated by <a href="https://github.com/yoshihiro503/coq2html/">a fork of coq2html</a></div>
    </div>
  </div>
    </main>
</body>
</html>
